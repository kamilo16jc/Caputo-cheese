<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Caputo | Quality Control</title>
<link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#ffffff; --surface:#f5f5f7; --surface2:#ebebef;
  --border:#dcdce4; --accent:#c8102e; --text:#111118;
  --muted:#6b6b85; --dim:#b0b0c0;
  --pass:#16a34a; --fail:#dc2626; --warn:#d97706;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Raleway',sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
.screen{display:none;min-height:100vh;padding:24px 20px;flex-direction:column}
.screen.active{display:flex}
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}
input[type=number]{-moz-appearance:textfield}

/* HEADER */
.app-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:28px}
.logo-sub{font-size:11px;color:var(--muted);letter-spacing:0.35em;text-transform:uppercase;font-weight:700;margin-top:3px}
.header-badge{font-size:11px;color:var(--muted);background:var(--surface);border:1px solid var(--border);padding:6px 12px;border-radius:20px}

/* HOME */
.home-title{font-size:36px;font-weight:800;line-height:1.1;margin-bottom:6px}
.home-title span{color:var(--accent)}
.home-sub{font-size:12px;color:var(--muted);letter-spacing:0.25em;font-weight:700;text-transform:uppercase;margin-bottom:36px}
.sec-label{font-size:10px;color:var(--accent);letter-spacing:0.25em;text-transform:uppercase;font-weight:700;margin-bottom:10px}

/* BUTTONS GRID */
.lines-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;margin-bottom:24px}
.shift-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:28px}
.sel-btn{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:16px 8px;text-align:center;cursor:pointer;transition:all 0.2s;font-family:'Raleway',sans-serif}
.sel-btn:active{transform:scale(0.96)}
.sel-btn .top{font-size:18px;font-weight:800;color:var(--text);display:block;margin-bottom:3px}
.sel-btn .sub{font-size:9px;color:var(--muted);letter-spacing:0.2em;font-weight:700}
.sel-btn.selected{border-color:var(--accent);background:rgba(200,16,46,0.06)}
.sel-btn.selected .top{color:var(--accent)}
.shift-btn{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:18px;text-align:center;cursor:pointer;transition:all 0.2s;font-family:'Raleway',sans-serif}
.shift-btn:active{transform:scale(0.96)}
.shift-btn .snum{font-size:26px;font-weight:800}
.shift-btn .slbl{font-size:10px;color:var(--muted);letter-spacing:0.2em;font-weight:700}
.shift-btn.selected{border-color:var(--accent);background:rgba(200,16,46,0.06)}
.shift-btn.selected .snum{color:var(--accent)}

/* MENU CARDS */
.menu-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px}
.menu-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:20px 16px;cursor:pointer;transition:all 0.2s;display:flex;flex-direction:column;gap:10px}
.menu-card:active{transform:scale(0.97)}
.menu-card.accent{border-color:var(--accent);background:rgba(200,16,46,0.04)}
.menu-card .cicon{font-size:26px}
.menu-card .ctitle{font-size:15px;font-weight:700}
.menu-card .cdesc{font-size:10px;color:var(--muted);line-height:1.5}
.menu-card.wide{grid-column:span 2}

/* MAIN BTN */
.main-btn{width:100%;padding:18px;background:var(--accent);color:white;border:none;border-radius:14px;font-family:'Raleway',sans-serif;font-size:15px;font-weight:700;cursor:pointer;transition:all 0.2s;margin-top:auto}
.main-btn:active{transform:scale(0.97);background:#a50e27}
.main-btn:disabled{background:var(--surface2);color:var(--dim);cursor:not-allowed}
.sec-btn{width:100%;padding:14px;background:var(--surface2);color:var(--text);border:1px solid var(--border);border-radius:12px;font-family:'Raleway',sans-serif;font-size:13px;font-weight:600;cursor:pointer;margin-bottom:10px}
.danger-btn{width:100%;padding:14px;background:rgba(220,38,38,0.08);color:var(--fail);border:1px solid rgba(220,38,38,0.3);border-radius:12px;font-family:'Raleway',sans-serif;font-size:13px;font-weight:600;cursor:pointer;margin-bottom:10px}

/* FORM */
.back-btn{display:flex;align-items:center;gap:8px;background:none;border:none;color:var(--muted);font-family:'Raleway',sans-serif;font-size:12px;letter-spacing:0.1em;cursor:pointer;margin-bottom:20px;padding:0;font-weight:700}
.form-title{font-size:26px;font-weight:800;margin-bottom:3px}
.form-meta{font-size:11px;color:var(--muted);margin-bottom:24px}
.form-meta span{color:var(--accent);font-weight:700}
.field{width:100%;background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:14px 16px;font-family:'Raleway',sans-serif;font-size:14px;color:var(--text);outline:none;margin-bottom:10px;transition:border-color 0.2s}
.field:focus{border-color:var(--accent)}
.field::placeholder{color:var(--dim)}
textarea.field{resize:none;line-height:1.5}

/* PACKAGES */
.pkg-scroll{display:flex;gap:8px;overflow-x:auto;padding-bottom:8px;margin-bottom:20px;scrollbar-width:none}
.pkg-scroll::-webkit-scrollbar{display:none}
.pkg-chip{flex-shrink:0;background:var(--surface);border:1px solid var(--border);border-radius:50px;padding:9px 16px;font-family:'Raleway',sans-serif;font-size:12px;font-weight:600;color:var(--muted);cursor:pointer;white-space:nowrap}
.pkg-chip.selected{border-color:var(--accent);color:var(--accent);background:rgba(200,16,46,0.06)}

/* TARGET */
.target-box{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center}
.target-lbl{font-size:9px;color:var(--muted);letter-spacing:0.2em;font-weight:700;text-transform:uppercase}
.target-val{font-size:14px;font-weight:700;color:var(--accent)}

/* TIME ROW */
.time-row{display:flex;gap:8px;margin-bottom:14px;align-items:flex-end}
.time-input{flex:1;background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:12px 14px;font-family:'Raleway',sans-serif;font-size:13px;color:var(--text);outline:none}
.time-input:focus{border-color:var(--accent)}
.now-btn{padding:12px 14px;background:var(--surface2);border:1px solid var(--border);border-radius:10px;font-family:'Raleway',sans-serif;font-size:12px;font-weight:700;cursor:pointer;white-space:nowrap}

/* SAMPLES */
.samples-wrap{display:flex;flex-direction:column;gap:8px;margin-bottom:20px}
.sample-row{display:flex;align-items:center;gap:12px;background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 14px;transition:border-color 0.2s}
.sample-row.pass{border-color:var(--pass)}
.sample-row.fail{border-color:var(--fail)}
.snum{font-size:11px;color:var(--muted);font-weight:700;letter-spacing:0.1em;min-width:64px}
.sinput{flex:1;background:none;border:none;outline:none;font-family:'Raleway',sans-serif;font-size:20px;font-weight:600;color:var(--text);text-align:right}
.sicon{font-size:16px;min-width:20px;text-align:center}

/* STATS */
.stats-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px}
.stat-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:14px}
.stat-card .slabel{font-size:9px;color:var(--muted);letter-spacing:0.2em;font-weight:700;margin-bottom:4px}
.stat-card .svalue{font-size:22px;font-weight:700}

/* CHECKLIST */
.check-item{display:flex;align-items:center;justify-content:space-between;background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:14px 16px;margin-bottom:8px;transition:all 0.2s}
.check-item.pass{border-color:var(--pass);background:rgba(22,163,74,0.04)}
.check-item.fail{border-color:var(--fail);background:rgba(220,38,38,0.04)}
.check-label{font-size:14px;font-weight:600}
.toggle-wrap{display:flex;gap:6px}
.tog{padding:6px 12px;border-radius:20px;border:1px solid var(--border);background:none;color:var(--muted);font-family:'Raleway',sans-serif;font-size:11px;font-weight:700;cursor:pointer}
.tog.pass-active{background:var(--pass);color:white;border-color:var(--pass)}
.tog.fail-active{background:var(--fail);color:white;border-color:var(--fail)}

/* DASHBOARD */
.big-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px}
.big-stat{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:18px 14px}
.big-stat .blbl{font-size:9px;color:var(--muted);letter-spacing:0.2em;font-weight:700;margin-bottom:8px}
.big-stat .bval{font-size:34px;font-weight:800;line-height:1}
.big-stat .bsub{font-size:10px;color:var(--muted);margin-top:3px}
.big-stat.green{border-color:rgba(22,163,74,0.4)}.big-stat.green .bval{color:var(--pass)}
.big-stat.red{border-color:rgba(220,38,38,0.4)}.big-stat.red .bval{color:var(--fail)}
.big-stat.yellow{border-color:rgba(217,119,6,0.4)}.big-stat.yellow .bval{color:var(--warn)}
.chart-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:18px;margin-bottom:14px}
.chart-card .ctitle2{font-size:13px;font-weight:700;margin-bottom:2px}
.chart-card .csub{font-size:10px;color:var(--muted);margin-bottom:14px}
canvas{width:100%!important}
.rec-item{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 14px;display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.rec-line{font-size:13px;font-weight:700}
.rec-meta{font-size:10px;color:var(--muted);margin-top:2px}
.rec-comp{font-size:16px;font-weight:700}
.rec-comp.hi{color:var(--pass)}.rec-comp.lo{color:var(--fail)}.rec-comp.mi{color:var(--warn)}
.empty{text-align:center;padding:40px 20px;color:var(--muted);font-size:12px;letter-spacing:0.1em;font-weight:600}

/* GMP */
.gmp-section{background:var(--surface);border:1px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:18px}
.gmp-section-hdr{background:var(--accent);color:white;padding:10px 14px;font-weight:700;font-size:12px;letter-spacing:0.1em;text-align:center}
.gmp-row{display:grid;grid-template-columns:1fr auto;align-items:center;border-bottom:1px solid var(--border);min-height:46px}
.gmp-row:last-child{border-bottom:none}
.gmp-item-lbl{padding:10px 14px;font-size:13px;font-weight:500}
.gmp-btns{padding:6px 10px;display:flex;gap:6px;justify-content:flex-end;min-width:130px}
.gmp-tog{padding:6px 12px;border-radius:20px;border:1px solid var(--border);background:none;color:var(--muted);font-family:'Raleway',sans-serif;font-size:11px;font-weight:700;cursor:pointer;transition:all 0.15s}
.gmp-tog.yes-on{background:var(--pass);color:white;border-color:var(--pass)}
.gmp-tog.no-on{background:var(--fail);color:white;border-color:var(--fail)}
.temp-grid{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:6px;padding:10px}
.temp-lbl{font-size:10px;font-weight:700;color:var(--text);display:flex;align-items:center}
.temp-hdr{font-size:10px;font-weight:700;color:var(--muted);text-align:center;letter-spacing:0.1em}
.temp-input{background:white;border:1px solid var(--border);border-radius:8px;padding:8px 6px;font-family:'Raleway',sans-serif;font-size:13px;font-weight:600;text-align:center;outline:none;width:100%}
.temp-input:focus{border-color:var(--accent)}
.rpt-filter-btn{padding:8px 14px;border-radius:20px;border:1px solid var(--border);background:var(--surface);color:var(--muted);font-family:'Raleway',sans-serif;font-size:12px;font-weight:700;cursor:pointer;transition:all 0.15s}
.rpt-filter-btn.active{background:var(--accent);color:white;border-color:var(--accent)}
.rpt-record-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 14px;margin-bottom:8px}
.rpt-record-card .rc-title{font-size:13px;font-weight:700;margin-bottom:4px}
.rpt-record-card .rc-meta{font-size:10px;color:var(--muted);margin-bottom:6px}
.rpt-record-card .rc-samples{font-size:11px;color:var(--text)}
.rpt-record-card .rc-comp{font-size:12px;font-weight:700;float:right}
.rpt-record-card .rc-comp.hi{color:var(--pass)}.rpt-record-card .rc-comp.lo{color:var(--fail)}.rpt-record-card .rc-comp.mi{color:var(--warn)}

/* TOAST */
.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--accent);color:white;padding:12px 26px;border-radius:50px;font-family:'Raleway',sans-serif;font-size:13px;font-weight:700;transition:transform 0.3s;z-index:999;white-space:nowrap}
.toast.show{transform:translateX(-50%) translateY(0)}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="screen active" id="screen-login">
  <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:32px 24px">
    <img id="login-logo" style="height:70px;object-fit:contain;margin-bottom:8px">
    <div style="font-size:11px;color:var(--muted);letter-spacing:0.35em;font-weight:700;text-transform:uppercase;margin-bottom:36px">Quality Control</div>
    <div style="font-size:28px;font-weight:800;margin-bottom:6px;text-align:center">Welcome back</div>
    <div style="font-size:13px;color:var(--muted);margin-bottom:32px;text-align:center">Sign in to continue</div>

    <div style="width:100%;max-width:360px">
      <div class="sec-label">Select Operator</div>
      <div id="operator-list" style="margin-bottom:20px"></div>

      <div id="pin-section" style="display:none">
        <div class="sec-label" id="pin-label">Enter PIN for <span id="pin-operator-name" style="color:var(--accent)"></span></div>
        <div style="display:flex;gap:10px;justify-content:center;margin-bottom:16px" id="pin-dots"></div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px" id="pin-pad"></div>
        <button class="sec-btn" style="margin:0" onclick="cancelPin()">‚Üê Back</button>
      </div>

      <div id="no-operators" style="display:none;text-align:center;padding:20px;color:var(--muted);font-size:13px">
        No operators registered yet.<br>Contact your administrator.
      </div>
    </div>
  </div>
</div>

<!-- ADMIN -->
<div class="screen" id="screen-admin">
  <button class="back-btn" onclick="goTo('screen-home')">‚Üê BACK</button>
  <div class="form-title">Admin Panel</div>
  <div class="form-meta">Manage operators</div>

  <div class="sec-label">Add New Operator</div>
  <input type="text" class="field" id="admin-name" placeholder="Full name" style="margin-bottom:8px">
  <div class="sec-label">PIN (4 digits)</div>
  <input type="password" class="field" id="admin-pin" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="4" inputmode="numeric" style="margin-bottom:8px;letter-spacing:8px;font-size:20px">
  <div class="sec-label">Role</div>
  <div style="display:flex;gap:8px;margin-bottom:16px">
    <button class="rpt-filter-btn active" id="role-operator" data-role="operator" onclick="setRole(this)">Operator</button>
    <button class="rpt-filter-btn" id="role-supervisor" data-role="supervisor" onclick="setRole(this)">Supervisor</button>
    <button class="rpt-filter-btn" id="role-admin" data-role="admin" onclick="setRole(this)">Admin</button>
  </div>
  <button class="main-btn" style="margin-bottom:24px" onclick="addOperator()">Add Operator ‚úì</button>

  <div class="sec-label">Current Operators</div>
  <div id="operators-list"></div>
</div>

<!-- HOME -->
<div class="screen" id="screen-home">
  <div class="app-header">
    <div>
      <img src="data:image/png;base64,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" style="height:60px;object-fit:contain" alt="Caputo">
      <div class="logo-sub">Quality Control</div>
    </div>
    <div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px">
    <div class="header-badge" id="home-date"></div>
    <div id="sync-status" style="font-size:9px;color:var(--muted);font-weight:700;letter-spacing:0.1em;display:none"></div>
    <div style="display:flex;align-items:center;gap:6px;cursor:pointer" onclick="logoutUser()">
      <div id="user-badge" style="font-size:10px;color:var(--accent);font-weight:700;letter-spacing:0.05em"></div>
      <div style="font-size:9px;color:var(--muted)">logout</div>
    </div>
  </div>
  </div>
  <div class="home-title">Weight<br><span>Monitor</span></div>
  <div class="home-sub">Select your line and shift to begin</div>
  <div class="sec-label">Production Line</div>
  <div class="lines-grid">
    <button class="sel-btn" onclick="selectLine(1)"><span class="top">L1</span><span class="sub">LINE 1</span></button>
    <button class="sel-btn" onclick="selectLine(2)"><span class="top">L2</span><span class="sub">LINE 2</span></button>
    <button class="sel-btn" onclick="selectLine(3)"><span class="top">L3</span><span class="sub">LINE 3</span></button>
    <button class="sel-btn" onclick="selectLine(4)"><span class="top">L4</span><span class="sub">LINE 4</span></button>
    <button class="sel-btn" onclick="selectLine(5)"><span class="top">L5</span><span class="sub">LINE 5</span></button>
  </div>
  <div class="sec-label">Shift</div>
  <div class="shift-grid">
    <button class="shift-btn" onclick="selectShift(1)"><div class="snum">1st</div><div class="slbl">SHIFT</div></button>
    <button class="shift-btn" onclick="selectShift(2)"><div class="snum">2nd</div><div class="slbl">SHIFT</div></button>
  </div>
  <div class="sec-label">Quick Access</div>
  <div class="menu-grid">
    <div class="menu-card accent" onclick="goTo('screen-weight')">
      <div class="cicon">‚öñÔ∏è</div>
      <div class="ctitle">Weight Log</div>
      <div class="cdesc">Record package weights &amp; samples</div>
    </div>
    <div class="menu-card" onclick="goTo('screen-seal')">
      <div class="cicon">üîç</div>
      <div class="ctitle">Bag Seal</div>
      <div class="cdesc">Visual, Dunk Tank &amp; Printing</div>
    </div>
    <div class="menu-card" onclick="goTo('screen-dashboard')">
      <div class="cicon">üìä</div>
      <div class="ctitle">Dashboard</div>
      <div class="cdesc">Stats, trends &amp; compliance</div>
    </div>

    <div class="menu-card" onclick="goTo('screen-gmp')">
      <div class="cicon">üè≠</div>
      <div class="ctitle">GMP Audit</div>
      <div class="cdesc">SQF # 2.5.D.A Daily GMP Facility Audit</div>
    </div>
    <div class="menu-card" id="admin-card" style="display:none" onclick="goTo('screen-admin')">
      <div class="cicon">‚öôÔ∏è</div>
      <div class="ctitle">Admin</div>
      <div class="cdesc">Manage operators &amp; settings</div>
    </div>
    <div class="menu-card accent" onclick="goTo('screen-reports')">
      <div class="cicon">üìã</div>
      <div class="ctitle">Reports</div>
      <div class="cdesc">Export weights &amp; GMP records to PDF</div>
    </div>
    <div class="menu-card wide" style="border-color:#b45309;background:rgba(180,83,9,0.06)" onclick="goTo('screen-hold')">
      <div class="cicon">üîí</div>
      <div class="ctitle">Products on Hold</div>
      <div class="cdesc">Track, manage and release held products</div>
    </div>
  </div>
  <button class="main-btn" id="start-btn" onclick="goTo('screen-weight')" disabled>Start Weight Entry ‚Üí</button>
</div>

<!-- WEIGHT -->
<div class="screen" id="screen-weight">
  <button class="back-btn" onclick="goTo('screen-home')">‚Üê BACK</button>
  <div class="form-title">Weight Log</div>
  <div class="form-meta">Line <span id="wm-line">‚Äî</span> ¬∑ <span id="wm-shift">‚Äî</span> Shift</div>
  <div class="sec-label">Package Size</div>
  <div class="pkg-scroll" id="pkg-scroll"></div>
  <div class="target-box">
    <div>
      <div class="target-lbl">Target Range</div>
      <div class="target-val" id="target-val">Select package size</div>
    </div>
    <div style="text-align:right">
      <div class="target-lbl">Time</div>
      <div class="target-val" id="time-val">‚Äî</div>
    </div>
  </div>
  <div class="sec-label">Time of Check</div>
  <div class="time-row">
    <input type="time" class="time-input" id="check-time">
    <button class="now-btn" onclick="setNow()">Now</button>
  </div>
  <div class="sec-label">Samples (LBS)</div>
  <div class="samples-wrap" id="samples-wrap"></div>
  <div class="stats-row">
    <div class="stat-card">
      <div class="slabel">Average</div>
      <div class="svalue" id="avg-val" style="color:var(--muted)">‚Äî</div>
    </div>
    <div class="stat-card">
      <div class="slabel">Compliance</div>
      <div class="svalue" id="comp-val" style="color:var(--muted)">‚Äî</div>
    </div>
  </div>
  <div class="sec-label">LOT Number</div>
  <input type="text" class="field" id="w-lot" placeholder="Enter LOT number">
  <div class="sec-label">Product Number</div>
  <input type="text" class="field" id="w-product" placeholder="Enter product number">
  <div class="sec-label">Comments</div>
  <textarea class="field" id="w-comments" placeholder="Comments or corrective actions..." rows="3"></textarea>
  <div class="sec-label">Operator Initials</div>
  <input type="text" class="field" id="w-initials" placeholder="Initials">
  <button class="main-btn" onclick="saveWeight()">Save Record ‚úì</button>
</div>

<!-- BAG SEAL -->
<div class="screen" id="screen-seal">
  <button class="back-btn" onclick="goTo('screen-home')">‚Üê BACK</button>
  <div class="form-title">Bag Seal</div>
  <div class="form-meta">Line <span id="sm-line">‚Äî</span> ¬∑ <span id="sm-shift">‚Äî</span> Shift</div>
  <div class="sec-label">Time of Check</div>
  <div class="time-row">
    <input type="time" class="time-input" id="seal-time">
    <button class="now-btn" onclick="setSealNow()">Now</button>
  </div>
  <div class="sec-label">Monitoring Checks</div>
  <div id="seal-list"></div>
  <div class="sec-label">LOT Number</div>
  <input type="text" class="field" id="s-lot" placeholder="Enter LOT number">
  <div class="sec-label">Product Number</div>
  <input type="text" class="field" id="s-product" placeholder="Enter product number">
  <div class="sec-label">Comments</div>
  <textarea class="field" id="s-comments" placeholder="Comments or corrective actions..." rows="3"></textarea>
  <div class="sec-label">Operator Initials</div>
  <input type="text" class="field" id="s-initials" placeholder="Initials">
  <button class="main-btn" onclick="saveSeal()">Save Record ‚úì</button>
</div>

<!-- DASHBOARD -->
<div class="screen" id="screen-dashboard">
  <button class="back-btn" onclick="goTo('screen-home')">‚Üê BACK</button>
  <div class="form-title">Dashboard</div>
  <div class="form-meta">Real-time statistics &amp; analytics</div>

  <!-- PERIOD FILTER -->
  <div style="display:flex;gap:8px;margin-bottom:20px;overflow-x:auto;padding-bottom:4px">
    <button class="pkg-chip selected" id="dash-f-7" onclick="setDashFilter(7,this)">7 Days</button>
    <button class="pkg-chip" id="dash-f-30" onclick="setDashFilter(30,this)">30 Days</button>
    <button class="pkg-chip" id="dash-f-90" onclick="setDashFilter(90,this)">90 Days</button>
    <button class="pkg-chip" id="dash-f-0" onclick="setDashFilter(0,this)">All Time</button>
  </div>

  <!-- WEIGHT STATS HEADER -->
  <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px">
    <div style="width:4px;height:18px;background:var(--accent);border-radius:2px"></div>
    <div style="font-size:14px;font-weight:800;color:var(--text)">‚öñÔ∏è Weight Monitoring</div>
  </div>

  <!-- MAIN STATS GRID -->
  <div class="big-grid" id="dash-stats" style="margin-bottom:12px"></div>

  <!-- SECONDARY STATS -->
  <div id="dash-secondary" style="margin-bottom:16px"></div>

  <!-- LINE BREAKDOWN -->
  <div class="chart-card" style="margin-bottom:12px">
    <div class="ctitle2">Compliance by Line</div>
    <div class="csub">Which line performs best</div>
    <div id="dash-by-line"></div>
  </div>

  <!-- PACKAGE BREAKDOWN -->
  <div class="chart-card" style="margin-bottom:12px">
    <div class="ctitle2">Failures by Package</div>
    <div class="csub">Which package size fails most</div>
    <div id="dash-by-pkg"></div>
  </div>

  <!-- SHIFT COMPARISON -->
  <div class="chart-card" style="margin-bottom:12px">
    <div class="ctitle2">Shift Comparison</div>
    <div class="csub">1st Shift vs 2nd Shift compliance</div>
    <div id="dash-by-shift"></div>
  </div>

  <!-- CHARTS -->
  <div class="chart-card" style="margin-bottom:12px">
    <div class="ctitle2">Compliance Trend</div>
    <div class="csub">Daily compliance % over selected period</div>
    <canvas id="chart-trend" height="180"></canvas>
  </div>

  <div class="chart-card" style="margin-bottom:16px">
    <div class="ctitle2">In Target vs Out of Target</div>
    <div class="csub">Overall bag distribution</div>
    <canvas id="chart-donut" height="200"></canvas>
  </div>

  <!-- GMP STATS HEADER -->
  <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px">
    <div style="width:4px;height:18px;background:#1a5276;border-radius:2px"></div>
    <div style="font-size:14px;font-weight:800;color:var(--text)">üè≠ GMP Audit</div>
  </div>

  <div id="dash-gmp-stats" style="margin-bottom:12px"></div>

  <div class="chart-card" style="margin-bottom:12px">
    <div class="ctitle2">Top GMP Failures</div>
    <div class="csub">Most frequently marked as NO</div>
    <div id="dash-gmp-failures"></div>
  </div>

  <div class="chart-card" style="margin-bottom:16px">
    <div class="ctitle2">Temperature Average</div>
    <div class="csub">Beginning ¬∑ Middle ¬∑ End of shift</div>
    <div id="dash-temp-avg"></div>
  </div>

  <!-- RECENT RECORDS -->
  <div class="sec-label">Recent Weight Records</div>
  <div id="records-list" style="margin-bottom:12px"></div>

  <!-- EXPORT & CLEAR -->
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px">
    <button class="main-btn" style="margin:0;background:#1a5276" onclick="exportDashPDF()">üìÑ Export PDF</button>
    <button class="main-btn" style="margin:0;background:#1d6f42" onclick="exportDashExcel()">üìä Export Excel</button>
  </div>
  <button class="danger-btn" onclick="clearData()">Clear All Data</button>
</div>

<!-- GMP -->
<div class="screen" id="screen-gmp">
  <button class="back-btn" onclick="goTo('screen-home')">‚Üê BACK</button>
  <div class="form-title">GMP Audit</div>
  <div class="form-meta">SQF # 2.5.D.A ¬∑ Daily GMP Facility Audit</div>
  <div class="sec-label">Location</div>
  <input type="text" class="field" id="gmp-loc" placeholder="Enter location">
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px">
    <div>
      <div class="sec-label">Date</div>
      <input type="date" class="time-input" id="gmp-date" style="width:100%">
    </div>
    <div>
      <div class="sec-label">Shift</div>
      <div style="display:flex;gap:8px">
        <button class="gmp-tog" id="gmp-s1" onclick="setGmpShift(1)" style="flex:1;padding:12px 8px">1st</button>
        <button class="gmp-tog" id="gmp-s2" onclick="setGmpShift(2)" style="flex:1;padding:12px 8px">2nd</button>
      </div>
    </div>
  </div>
  <div class="gmp-section">
    <div class="gmp-section-hdr">GOOD MANUFACTURING PRACTICES ‚Äî EVERYWHERE FOOD IS EXPOSED</div>
    <div style="display:grid;grid-template-columns:1fr auto;border-bottom:1px solid var(--border)">
      <div style="padding:8px 14px;font-size:10px;font-weight:700;color:var(--muted);letter-spacing:0.1em">CHECK / INSPECT</div>
      <div style="padding:8px 14px;font-size:10px;font-weight:700;color:var(--muted);letter-spacing:0.1em;min-width:130px;text-align:center">ACCEPTABLE</div>
    </div>
    <div id="gmp-list"></div>
  </div>
  <div class="gmp-section">
    <div class="gmp-section-hdr" style="background:#1a5276">1945 TEMPERATURE &amp; % RELATIVE HUMIDITY MONITORING<br><span style="font-size:9px;font-weight:400">FREQUENCY: BEGINNING ¬∑ MIDDLE ¬∑ END OF SHIFT</span></div>
    <div class="temp-grid">
      <div class="temp-lbl"></div>
      <div class="temp-hdr">BEGINNING</div>
      <div class="temp-hdr">MIDDLE</div>
      <div class="temp-hdr">END</div>
      <div class="temp-lbl">TIME</div>
      <input type="time" class="temp-input" id="t-begin-time">
      <input type="time" class="temp-input" id="t-mid-time">
      <input type="time" class="temp-input" id="t-end-time">
      <div class="temp-lbl">TEMPERATURE</div>
      <input type="text" class="temp-input" id="t-begin-temp" placeholder="¬∞F" inputmode="decimal">
      <input type="text" class="temp-input" id="t-mid-temp" placeholder="¬∞F" inputmode="decimal">
      <input type="text" class="temp-input" id="t-end-temp" placeholder="¬∞F" inputmode="decimal">
      <div class="temp-lbl">CHOPPING AREA HUM.</div>
      <input type="text" class="temp-input" id="t-begin-chop" placeholder="%" inputmode="decimal">
      <input type="text" class="temp-input" id="t-mid-chop" placeholder="%" inputmode="decimal">
      <input type="text" class="temp-input" id="t-end-chop" placeholder="%" inputmode="decimal">
      <div class="temp-lbl">UNDER PLATFORM HUM.</div>
      <input type="text" class="temp-input" id="t-begin-plat" placeholder="%" inputmode="decimal">
      <input type="text" class="temp-input" id="t-mid-plat" placeholder="%" inputmode="decimal">
      <input type="text" class="temp-input" id="t-end-plat" placeholder="%" inputmode="decimal">
      <div class="temp-lbl">LINE 6 &amp; GRILLING HUM.</div>
      <input type="text" class="temp-input" id="t-begin-line6" placeholder="%" inputmode="decimal">
      <input type="text" class="temp-input" id="t-mid-line6" placeholder="%" inputmode="decimal">
      <input type="text" class="temp-input" id="t-end-line6" placeholder="%" inputmode="decimal">
      <div class="temp-lbl">INITIALS</div>
      <input type="text" class="temp-input" id="t-begin-init" style="text-transform:uppercase">
      <input type="text" class="temp-input" id="t-mid-init" style="text-transform:uppercase">
      <input type="text" class="temp-input" id="t-end-init" style="text-transform:uppercase">
    </div>
  </div>
  <div class="sec-label">Additional Comments / Corrective Actions</div>
  <textarea class="field" id="gmp-comments" placeholder="Add comments, notes or corrective actions..." rows="3"></textarea>
  <div class="sec-label">Completed By (Print Name)</div>
  <input type="text" class="field" id="gmp-completed">
  <div class="sec-label">Verified By (Signature)</div>
  <input type="text" class="field" id="gmp-verified" style="margin-bottom:16px">
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px">
    <button class="sec-btn" style="margin:0" onclick="exportGmpPDF()">Export PDF üìÑ</button>
    <button class="main-btn" style="margin:0" onclick="saveGmp()">Save Record ‚úì</button>
  </div>
</div>


<!-- REPORTS -->
<div class="screen" id="screen-reports">
  <button class="back-btn" onclick="goTo('screen-home')">‚Üê BACK</button>
  <div class="form-title">Reports</div>
  <div class="form-meta">Filter and export records to PDF</div>

  <!-- FILTERS -->
  <div class="gmp-section" style="margin-bottom:18px">
    <div class="gmp-section-hdr">FILTER RECORDS</div>
    <div style="padding:14px;display:flex;flex-direction:column;gap:12px">

      <div>
        <div class="sec-label">Date</div>
        <input type="date" class="time-input" id="rpt-date" style="width:100%">
      </div>

      <div>
        <div class="sec-label">Line (optional)</div>
        <div style="display:flex;gap:8px">
          <button class="rpt-filter-btn" data-group="line" data-val="all" onclick="setRptFilter(this)">All</button>
          <button class="rpt-filter-btn" data-group="line" data-val="1" onclick="setRptFilter(this)">L1</button>
          <button class="rpt-filter-btn" data-group="line" data-val="2" onclick="setRptFilter(this)">L2</button>
          <button class="rpt-filter-btn" data-group="line" data-val="3" onclick="setRptFilter(this)">L3</button>
          <button class="rpt-filter-btn" data-group="line" data-val="4" onclick="setRptFilter(this)">L4</button>
          <button class="rpt-filter-btn" data-group="line" data-val="5" onclick="setRptFilter(this)">L5</button>
        </div>
      </div>

      <div>
        <div class="sec-label">Shift (optional)</div>
        <div style="display:flex;gap:8px">
          <button class="rpt-filter-btn" data-group="shift" data-val="all" onclick="setRptFilter(this)">All</button>
          <button class="rpt-filter-btn" data-group="shift" data-val="1" onclick="setRptFilter(this)">1st</button>
          <button class="rpt-filter-btn" data-group="shift" data-val="2" onclick="setRptFilter(this)">2nd</button>
        </div>
      </div>

      <div>
        <div class="sec-label">Product Number (optional)</div>
        <input type="text" class="time-input" id="rpt-product" placeholder="Filter by product number" style="width:100%">
      </div>
      <button class="main-btn" style="margin:0" onclick="applyRptFilters()">Apply Filters üîç</button>
    </div>
  </div>

  <!-- WEIGHT & SEAL RECORDS -->
  <div class="sec-label">Weight Records</div>
  <div id="rpt-weight-list" style="margin-bottom:16px"></div>

  <div class="sec-label">Bag Seal Records</div>
  <div id="rpt-seal-list" style="margin-bottom:16px"></div>

  <button class="main-btn" style="margin-bottom:18px;background:#1a5276" onclick="exportRptWeightPDF()">üìÑ Export Weight & Seal Report</button>

  <!-- GMP RECORDS -->
  <div class="sec-label">GMP Records</div>
  <div id="rpt-gmp-list" style="margin-bottom:6px"></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:18px">
    <button class="main-btn" style="margin:0;background:#1a5276" onclick="exportRptGmpPDF()">üìÑ Export PDF</button>
    <button class="main-btn" style="margin:0;background:#1d6f42" onclick="exportGmpExcel()">üìä Export Excel</button>
  </div>
</div>


<!-- HOLD MANAGEMENT -->
<div class="screen" id="screen-hold">
  <button class="back-btn" onclick="goTo('screen-home')">‚Üê BACK</button>
  <div class="form-title">Products on Hold</div>
  <div class="form-meta">Track and manage held products</div>

  <!-- TABS -->
  <div style="display:flex;gap:8px;margin-bottom:20px;overflow-x:auto;padding-bottom:4px">
    <button class="pkg-chip selected" id="hold-tab-active" onclick="switchHoldTab('active',this)">üîí Active</button>
    <button class="pkg-chip" id="hold-tab-closed" onclick="switchHoldTab('closed',this)">‚úÖ Closed</button>
    <button class="pkg-chip" id="hold-tab-new" onclick="switchHoldTab('new',this)">‚ûï New</button>
    <button class="pkg-chip" id="hold-tab-all" onclick="switchHoldTab('all',this)">üìÅ All</button>
  </div>

  <!-- ACTIVE CASES (hold + review) -->
  <div id="hold-view-active">
    <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
      <button class="rpt-filter-btn active" data-group="hactive" data-val="all" onclick="setHoldActiveFilter(this)">All Active</button>
      <button class="rpt-filter-btn" data-group="hactive" data-val="hold" onclick="setHoldActiveFilter(this)">üîí Hold</button>
      <button class="rpt-filter-btn" data-group="hactive" data-val="review" onclick="setHoldActiveFilter(this)">üîç Under Review</button>
    </div>
    <div id="hold-active-list"></div>
  </div>

  <!-- CLOSED CASES (released + destroyed) -->
  <div id="hold-view-closed" style="display:none">
    <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
      <button class="rpt-filter-btn active" data-group="hclosed" data-val="all" onclick="setHoldClosedFilter(this)">All Closed</button>
      <button class="rpt-filter-btn" data-group="hclosed" data-val="released" onclick="setHoldClosedFilter(this)">‚úÖ Released</button>
      <button class="rpt-filter-btn" data-group="hclosed" data-val="destroyed" onclick="setHoldClosedFilter(this)">üóëÔ∏è Destroyed</button>
    </div>
    <div id="hold-closed-list"></div>
  </div>

  <!-- NEW CASE FORM -->
  <div id="hold-view-new" style="display:none">
    <div class="sec-label">Product Name</div>
    <input type="text" class="field" id="hold-product" placeholder="Product name">
    <div class="sec-label">LOT Number</div>
    <input type="text" class="field" id="hold-lot" placeholder="LOT number">
    <div class="sec-label">Quantity on Hold</div>
    <input type="text" class="field" id="hold-qty" placeholder="e.g. 50 cases / 200 lbs">
    <div class="sec-label">Line</div>
    <div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap">
      <button class="rpt-filter-btn" data-group="hline" data-val="1" onclick="selectHoldLine(this)">L1</button>
      <button class="rpt-filter-btn" data-group="hline" data-val="2" onclick="selectHoldLine(this)">L2</button>
      <button class="rpt-filter-btn" data-group="hline" data-val="3" onclick="selectHoldLine(this)">L3</button>
      <button class="rpt-filter-btn" data-group="hline" data-val="4" onclick="selectHoldLine(this)">L4</button>
      <button class="rpt-filter-btn" data-group="hline" data-val="5" onclick="selectHoldLine(this)">L5</button>
    </div>
    <div class="sec-label">Reason for Hold</div>
    <textarea class="field" id="hold-reason" placeholder="Describe the reason for placing on hold..." rows="3" style="resize:none;font-family:Raleway,sans-serif"></textarea>
    <div class="sec-label">Initiated By</div>
    <input type="text" class="field" id="hold-initby" placeholder="Name">
    <button class="main-btn" onclick="saveHoldCase()">üîí Place on Hold</button>
  </div>

  <!-- ALL CASES VIEW -->
  <div id="hold-view-all" style="display:none">
    <div style="display:flex;gap:8px;margin-bottom:16px">
      <button class="main-btn" style="margin:0;background:#1d6f42;flex:1" onclick="exportHoldExcel()">üìä Export Excel</button>
      <button class="main-btn" style="margin:0;background:#1a5276;flex:1" onclick="exportHoldPDF()">üìÑ Export PDF</button>
    </div>
    <div id="hold-all-list"></div>
  </div>
</div>

<!-- HOLD DETAIL MODAL -->
<div id="hold-modal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:1000;overflow-y:auto;padding:20px">
  <div style="background:var(--bg);border-radius:20px;max-width:500px;margin:0 auto;padding:24px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
      <div id="modal-case-number" style="font-size:18px;font-weight:800"></div>
      <button onclick="closeHoldModal()" style="background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:6px 12px;font-family:Raleway,sans-serif;font-size:13px;cursor:pointer">‚úï Close</button>
    </div>
    <div id="modal-case-detail"></div>

    <!-- STATUS CHANGE -->
    <div id="modal-status-change" style="margin-top:16px;border-top:1px solid var(--border);padding-top:16px">
      <div class="sec-label">Change Status</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px">
        <button class="rpt-filter-btn" data-newstatus="hold" onclick="setNewStatus(this)">üîí Hold</button>
        <button class="rpt-filter-btn" data-newstatus="review" onclick="setNewStatus(this)">üîç Under Review</button>
        <button class="rpt-filter-btn" data-newstatus="released" onclick="setNewStatus(this)">‚úÖ Released</button>
        <button class="rpt-filter-btn" data-newstatus="destroyed" onclick="setNewStatus(this)">üóëÔ∏è Destroyed</button>
      </div>
      <div class="sec-label">Comment (required)</div>
      <textarea class="field" id="modal-comment" placeholder="Add a comment about this status change..." rows="2" style="resize:none;font-family:Raleway,sans-serif;margin-bottom:12px"></textarea>
      <button class="main-btn" style="margin:0" onclick="updateHoldStatus()">Update Status ‚úì</button>
    </div>

    <!-- HISTORY -->
    <div style="margin-top:16px;border-top:1px solid var(--border);padding-top:16px">
      <div class="sec-label">History</div>
      <div id="modal-history"></div>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast">Saved!</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, getDoc, setDoc, query, orderBy, onSnapshot, deleteField, writeBatch, doc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD2QOrY7TyeYCcHE14hXoQ3nCsC4nozL-8",
    authDomain: "caputo-cheese.firebaseapp.com",
    projectId: "caputo-cheese",
    storageBucket: "caputo-cheese.firebasestorage.app",
    messagingSenderId: "20561008857",
    appId: "1:20561008857:web:cc24df6e99c5d893af86c8"
  };

  const app = initializeApp(firebaseConfig);
  const db  = getFirestore(app);

  // ---- SYNC: load all data from Firestore into localStorage on start ----
  async function syncFromFirebase() {
    try {
      showSyncStatus('Syncing...');
      var localDb = getDB();

      // Weights
      var wSnap = await getDocs(query(collection(db,'weights'), orderBy('date','asc')));
      localDb.weights = wSnap.docs.map(function(d){ var data=d.data(); data._fbId=d.id; return data; });

      // Seals
      var sSnap = await getDocs(query(collection(db,'seals'), orderBy('date','asc')));
      localDb.seals = sSnap.docs.map(function(d){ var data=d.data(); data._fbId=d.id; return data; });

      // GMPs
      var gSnap = await getDocs(query(collection(db,'gmps'), orderBy('date','asc')));
      localDb.gmps = gSnap.docs.map(function(d){ var data=d.data(); data._fbId=d.id; return data; });

      // Holds
      try {
        var hSnap = await getDocs(collection(db,'holds'));
        if(!hSnap.empty) localDb.holds = hSnap.docs.map(function(d){ var data=d.data(); data._fbId=d.id; return data; });
      } catch(e) {}

      // Operators ‚Äî stored as single document for easy sync
      try {
        var opDoc = await getDoc(doc(db,'config','operators'));
        if(opDoc.exists()) {
          var remoteOps = opDoc.data().list || [];
          if(remoteOps.length > 0) localDb.operators = remoteOps;
        }
      } catch(e) {}

      saveDB(localDb);
      showSyncStatus('‚úì Synced');
      setTimeout(function(){ hideSyncStatus(); }, 2000);
    } catch(e) {
      showSyncStatus('‚ö† Offline');
      setTimeout(function(){ hideSyncStatus(); }, 3000);
      console.error('Sync error:', e);
    }
  }

  // ---- SAVE to Firestore ----
  window.saveToFirebase = async function(colName, record) {
    try {
      var docRef = await addDoc(collection(db, colName), record);
      var localDb = getDB();
      var arr = localDb[colName] || [];
      var last = arr[arr.length - 1];
      if(last) last._fbId = docRef.id;
      saveDB(localDb);
    } catch(e) {
      console.error('Firebase save error:', e);
    }
  };

  // ---- SAVE ALL HOLDS to Firestore (overwrite entire collection) ----
  window.saveHoldsToFirebase = async function(holds) {
    try {
      // Delete all existing hold docs then rewrite
      var snap = await getDocs(collection(db,'holds'));
      var batch = writeBatch(db);
      snap.docs.forEach(function(d){ batch.delete(d.ref); });
      holds.forEach(function(h){
        var ref = doc(collection(db,'holds'));
        batch.set(ref, h);
      });
      await batch.commit();
    } catch(e) {
      console.error('Save holds error:', e);
    }
  };

  // ---- SAVE OPERATORS to Firestore ----
  window.saveOperatorsToFirebase = async function(ops) {
    try {
      await setDoc(doc(db,'config','operators'), {list: ops, updatedAt: new Date().toISOString()});
    } catch(e) {
      console.error('Save operators error:', e);
    }
  };

  // ---- CLEAR Firestore ----
  window.clearFirebase = async function() {
    try {
      var batch = writeBatch(db);
      for(var col of ['weights','seals','gmps']) {
        var snap = await getDocs(collection(db, col));
        snap.docs.forEach(function(d){ batch.delete(d.ref); });
      }
      await batch.commit();
    } catch(e) {
      console.error('Firebase clear error:', e);
    }
  };

  // Run sync on load
  syncFromFirebase();
  // Re-sync every 60 seconds
  setInterval(syncFromFirebase, 60000);
</script>
<script>
// ===== DATA =====
var PKGS = [
  {label:'1 lb',    min:0.95,  max:1.04},
  {label:'2 lbs',   min:1.93,  max:2.07},
  {label:'2.5 lbs', min:2.41,  max:2.60},
  {label:'3 lbs',   min:2.95,  max:3.10},
  {label:'4.40 lbs',min:4.28,  max:4.52},
  {label:'5 lbs',   min:4.86,  max:5.14},
  {label:'7 lbs',   min:6.83,  max:7.17},
  {label:'10 lbs',  min:9.78,  max:10.22},
  {label:'4 oz',    min:0.234, max:0.266},
  {label:'8 oz',    min:0.466, max:0.527}
];
var SEAL_CHECKS = ['Visual','Dunk Tank','Printing'];
var GMP_ITEMS = [
  'Gloves','Smocks','Handwashing','Unsecured Jewelry/Loose Objects','Fingernails',
  'Hairnets/Beardnets','Personal Hygiene and Cologne/Perfume','Color Code Adherence',
  'Eating/Drinking/Smoking/Chewing/Spitting','Eyelashes',
  'No Visible Signs of Infectious Disease, Major Uncovered Cuts or Lesions',
  'Minor Cuts Covered with Metal Detectable Bandage',
  'Pedestrian and Forklift/Pallet Jack Traffic',
  'Open Product, Ingredients/Materials, Packaging Covered and Off Floor',
  'Doors Closed and Not Kept Open for Extended Periods of Time',
  'No Glass, Brittle Plastic, or Ceramic',
  'Air Hoses & Wash Down Water Hoses Stored on Racks off Floor',
  'Hairnets, Gloves, and Disposable Aprons Disposed of Prior to Leaving Facility',
  'Temporary Repairs on Food Contact & Non-Food Contact Equipment',
  'Visible signs of wearing on all food contact utensils',
  'Floors in good condition'
];
var LOGO = 'data:image/png;base64,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';

// ===== STATE =====
var st = {line:null, shift:null, pkg:null, samples:['','','','',''], sealChecks:{}};
var gmpAnswers = {};
var gmpShift = null;
var donutChart = null, trendChart = null;

// ===== DB =====
function getDB(){
  var db=JSON.parse(localStorage.getItem('caputo_db')||'{}');
  if(!db.weights) db.weights=[];
  if(!db.seals)   db.seals=[];
  if(!db.gmps)    db.gmps=[];
  if(!db.holds)   db.holds=[];
  return db;
}
function saveDB(db){localStorage.setItem('caputo_db',JSON.stringify(db))}

// ===== NAV =====
function goTo(id){
  // Redirect to login if not authenticated
  if(id !== 'screen-login' && !currentUser) { id = 'screen-login'; }
  document.querySelectorAll('.screen').forEach(function(s){s.classList.remove('active')});
  document.getElementById(id).classList.add('active');
  if(id==='screen-weight') initWeight();
  if(id==='screen-seal') initSeal();
  if(id==='screen-dashboard') initDash();
  if(id==='screen-gmp') initGmp();
  if(id==='screen-admin') initAdmin();
  if(id==='screen-reports') initReports();
  if(id==='screen-hold') initHold();
}

function toast(msg){
  var t=document.getElementById('toast');
  t.textContent=msg; t.classList.add('show');
  setTimeout(function(){t.classList.remove('show')},2500);
}

// ===== HOME =====
function updateDate(){
  document.getElementById('home-date').textContent=new Date().toLocaleDateString('en-US',{month:'short',day:'numeric'});
}
function selectLine(n){
  st.line=n;
  document.querySelectorAll('.lines-grid .sel-btn').forEach(function(b,i){b.classList.toggle('selected',i===n-1)});
  checkReady();
}
function selectShift(n){
  st.shift=n;
  document.querySelectorAll('.shift-btn').forEach(function(b,i){b.classList.toggle('selected',i===n-1)});
  checkReady();
}
function checkReady(){
  document.getElementById('start-btn').disabled=!(st.line&&st.shift);
}

// ===== WEIGHT =====
function initWeight(){
  document.getElementById('wm-line').textContent=st.line||'‚Äî';
  document.getElementById('wm-shift').textContent=st.shift?(st.shift===1?'1st':'2nd'):'‚Äî';
  setNow();
  renderPkgChips();
  buildSamples();
  if(currentUser) document.getElementById('w-initials').value = getInitials();
}
function renderPkgChips(){
  document.getElementById('pkg-scroll').innerHTML=PKGS.map(function(p,i){
    return '<div class="pkg-chip'+(st.pkg===i?' selected':'')+'" onclick="selectPkg('+i+')">'+p.label+'</div>';
  }).join('');
}
function selectPkg(i){
  st.pkg=i;
  renderPkgChips();
  var p=PKGS[i];
  document.getElementById('target-val').textContent=p.min+' ‚Äì '+p.max+' lbs';
  st.samples=['','','','',''];
  buildSamples();
  updateStats();
}
function buildSamples(){
  var wrap=document.getElementById('samples-wrap');
  if(wrap.children.length===0){
    wrap.innerHTML=st.samples.map(function(v,i){
      return '<div class="sample-row" id="sr-'+i+'">' +
        '<span class="snum">SAMPLE '+(i+1)+'</span>' +
        '<input class="sinput" type="text" inputmode="decimal" id="si-'+i+'" placeholder="0.00" autocomplete="off" oninput="onSample('+i+',this.value)">' +
        '<span class="sicon" id="sico-'+i+'"></span>' +
      '</div>';
    }).join('');
  }
}
function onSample(i,v){
  st.samples[i]=v.replace(',','.');
  updateSampleUI(i);
  updateStats();
}
function updateSampleUI(i){
  var row=document.getElementById('sr-'+i);
  var ico=document.getElementById('sico-'+i);
  if(!row||!ico) return;
  row.className='sample-row';
  ico.textContent='';
  if(st.pkg!==null && st.samples[i]!==''){
    var num=parseFloat(st.samples[i]);
    var p=PKGS[st.pkg];
    if(!isNaN(num)){
      if(num>=p.min&&num<=p.max){row.classList.add('pass');ico.textContent='‚úì';}
      else{row.classList.add('fail');ico.textContent='‚úó';}
    }
  }
}
function updateStats(){
  if(st.pkg===null) return;
  var p=PKGS[st.pkg];
  var vals=st.samples.map(function(v){return parseFloat(v)}).filter(function(v){return !isNaN(v)});
  if(!vals.length){
    document.getElementById('avg-val').textContent='‚Äî';
    document.getElementById('comp-val').textContent='‚Äî';
    return;
  }
  var avg=vals.reduce(function(a,b){return a+b},0)/vals.length;
  var pass=vals.filter(function(v){return v>=p.min&&v<=p.max}).length;
  var comp=Math.round((pass/vals.length)*100);
  document.getElementById('avg-val').textContent=avg.toFixed(3);
  var cv=document.getElementById('comp-val');
  cv.textContent=comp+'%';
  cv.style.color=comp>=80?'var(--pass)':comp>=60?'var(--warn)':'var(--fail)';
}
function setNow(){
  var now=new Date();
  var t=String(now.getHours()).padStart(2,'0')+':'+String(now.getMinutes()).padStart(2,'0');
  document.getElementById('check-time').value=t;
  document.getElementById('time-val').textContent=t;
}
function saveWeight(){
  if(!st.line||!st.shift){toast('Select line & shift first');return}
  if(st.pkg===null){toast('Select package size');return}
  var vals=st.samples.map(function(v){return parseFloat(v)}).filter(function(v){return !isNaN(v)});
  if(!vals.length){toast('Enter at least one sample');return}
  var p=PKGS[st.pkg];
  var pass=vals.filter(function(v){return v>=p.min&&v<=p.max}).length;
  var db=getDB();
  db.weights.push({
    id:Date.now(), date:localISOStr(),
    line:st.line, shift:st.shift,
    pkg:st.pkg, pkgLabel:p.label,
    vals:vals, avg:vals.reduce(function(a,b){return a+b},0)/vals.length,
    pass:pass, total:vals.length,
    compliance:Math.round((pass/vals.length)*100),
    time:document.getElementById('check-time').value,
    lot:document.getElementById('w-lot').value,
    product:document.getElementById('w-product').value,
    comments:document.getElementById('w-comments').value,
    initials:document.getElementById('w-initials').value,
    target:{min:p.min,max:p.max}
  });
  saveDB(db);
  if(window.saveToFirebase) window.saveToFirebase('weights', db.weights[db.weights.length-1]);
  st.samples=['','','','',''];
  document.getElementById('samples-wrap').innerHTML='';
  buildSamples();
  updateStats();
  document.getElementById('w-lot').value='';
  document.getElementById('w-product').value='';
  document.getElementById('w-comments').value='';
  document.getElementById('w-initials').value='';
  toast('Record saved!');
}

// ===== SEAL =====
function initSeal(){
  document.getElementById('sm-line').textContent=st.line||'‚Äî';
  document.getElementById('sm-shift').textContent=st.shift?(st.shift===1?'1st':'2nd'):'‚Äî';
  setSealNow();
  renderSealList();
  if(currentUser) document.getElementById('s-initials').value = getInitials();
}
function setSealNow(){
  var now=new Date();
  document.getElementById('seal-time').value=String(now.getHours()).padStart(2,'0')+':'+String(now.getMinutes()).padStart(2,'0');
}
function renderSealList(){
  document.getElementById('seal-list').innerHTML=SEAL_CHECKS.map(function(chk,i){
    var v=st.sealChecks[chk];
    return '<div class="check-item'+(v==='pass'?' pass':v==='fail'?' fail':'')+'" id="seal-row-'+i+'">' +
      '<span class="check-label">'+chk+'</span>' +
      '<div class="toggle-wrap">' +
        '<button class="tog'+(v==='pass'?' pass-active':'')+'" data-chk="'+chk+'" data-val="pass" onclick="setSeal(this)">PASS</button>' +
        '<button class="tog'+(v==='fail'?' fail-active':'')+'" data-chk="'+chk+'" data-val="fail" onclick="setSeal(this)">FAIL</button>' +
      '</div>' +
    '</div>';
  }).join('');
}
function setSeal(btn){
  var chk=btn.getAttribute('data-chk');
  var val=btn.getAttribute('data-val');
  st.sealChecks[chk]=val;
  renderSealList();
}
function saveSeal(){
  if(!st.line||!st.shift){toast('Select line & shift first');return}
  var db=getDB();
  db.seals.push({
    id:Date.now(), date:localISOStr(),
    line:st.line, shift:st.shift,
    checks:Object.assign({},st.sealChecks),
    time:document.getElementById('seal-time').value,
    lot:document.getElementById('s-lot').value,
    product:document.getElementById('s-product').value,
    comments:document.getElementById('s-comments').value,
    initials:document.getElementById('s-initials').value
  });
  saveDB(db);
  if(window.saveToFirebase) window.saveToFirebase('seals', db.seals[db.seals.length-1]);
  st.sealChecks={};
  renderSealList();
  document.getElementById('s-lot').value='';
  document.getElementById('s-product').value='';
  document.getElementById('s-comments').value='';
  document.getElementById('s-initials').value='';
  toast('Seal record saved!');
}

// ===== DASHBOARD =====

var dashDays = 7;

function setDashFilter(days, btn) {
  dashDays = days;
  document.querySelectorAll('[id^="dash-f-"]').forEach(function(b){ b.classList.remove('selected'); });
  btn.classList.add('selected');
  initDash();
}

function filterByDays(records) {
  if(!dashDays) return records;
  var cutoff = new Date();
  cutoff.setDate(cutoff.getDate() - dashDays);
  var cutStr = cutoff.getFullYear()+'-'+String(cutoff.getMonth()+1).padStart(2,'0')+'-'+String(cutoff.getDate()).padStart(2,'0');
  return records.filter(function(r){ return r.date >= cutStr; });
}

function mkBar(pct, color, bg) {
  return '<div style="flex:1;background:'+(bg||'#ebebef')+';border-radius:50px;height:8px;overflow:hidden">' +
    '<div style="width:'+Math.min(pct,100)+'%;height:100%;background:'+(color||'var(--accent)')+';border-radius:50px;transition:width 0.4s"></div>' +
  '</div>';
}

function initDash(){
  var db  = getDB();
  var w   = filterByDays(db.weights);
  var gmps = filterByDays(db.gmps);

  // ---- MAIN WEIGHT STATS ----
  var tBags = w.reduce(function(a,r){return a+r.total},0);
  var tPass = w.reduce(function(a,r){return a+r.pass},0);
  var tFail = tBags - tPass;
  var comp  = tBags ? Math.round((tPass/tBags)*100) : 0;

  document.getElementById('dash-stats').innerHTML =
    '<div class="big-stat green"><div class="blbl">IN TARGET</div><div class="bval">'+tPass+'</div><div class="bsub">bags passed</div></div>' +
    '<div class="big-stat red"><div class="blbl">OUT OF TARGET</div><div class="bval">'+tFail+'</div><div class="bsub">bags failed</div></div>' +
    '<div class="big-stat yellow"><div class="blbl">COMPLIANCE</div><div class="bval">'+comp+'%</div><div class="bsub">overall rate</div></div>' +
    '<div class="big-stat"><div class="blbl">RECORDS</div><div class="bval">'+w.length+'</div><div class="bsub">total entries</div></div>';

  // ---- SECONDARY STATS ----
  var allVals = [];
  w.forEach(function(r){ r.vals.forEach(function(v){ var n=parseFloat(v); if(!isNaN(n)) allVals.push({val:n,min:PKGS[r.pkg].min,max:PKGS[r.pkg].max}); }); });
  var avgWeight   = allVals.length ? (allVals.reduce(function(a,b){return a+b.val},0)/allVals.length).toFixed(3) : '‚Äî';
  var minWeight   = allVals.length ? Math.min.apply(null,allVals.map(function(v){return v.val})).toFixed(3) : '‚Äî';
  var maxWeight   = allVals.length ? Math.max.apply(null,allVals.map(function(v){return v.val})).toFixed(3) : '‚Äî';
  var avgDeviation = allVals.length ? (allVals.reduce(function(a,b){
    var mid = (b.min+b.max)/2; return a+Math.abs(b.val-mid);
  },0)/allVals.length).toFixed(4) : '‚Äî';

  // Hour with most failures
  var hourFails = {};
  w.forEach(function(r){
    if(!r.time) return;
    var h = r.time.split(':')[0]+'h';
    if(!hourFails[h]) hourFails[h] = 0;
    hourFails[h] += (r.total - r.pass);
  });
  var worstHour = Object.keys(hourFails).sort(function(a,b){return hourFails[b]-hourFails[a]})[0] || '‚Äî';

  document.getElementById('dash-secondary').innerHTML =
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">' +
      '<div class="stat-card"><div class="slabel">AVG WEIGHT</div><div class="svalue" style="font-size:18px">'+avgWeight+'<span style="font-size:11px;color:var(--muted)"> lbs</span></div></div>' +
      '<div class="stat-card"><div class="slabel">AVG DEVIATION</div><div class="svalue" style="font-size:18px">'+avgDeviation+'<span style="font-size:11px;color:var(--muted)"> lbs</span></div></div>' +
      '<div class="stat-card"><div class="slabel">MIN WEIGHT</div><div class="svalue" style="font-size:18px;color:var(--fail)">'+minWeight+'<span style="font-size:11px;color:var(--muted)"> lbs</span></div></div>' +
      '<div class="stat-card"><div class="slabel">MAX WEIGHT</div><div class="svalue" style="font-size:18px;color:var(--pass)">'+maxWeight+'<span style="font-size:11px;color:var(--muted)"> lbs</span></div></div>' +
      '<div class="stat-card"><div class="slabel">WORST HOUR</div><div class="svalue" style="font-size:18px">'+worstHour+'</div></div>' +
      '<div class="stat-card"><div class="slabel">TOTAL SAMPLES</div><div class="svalue" style="font-size:18px">'+allVals.length+'</div></div>' +
    '</div>';

  // ---- BY LINE ----
  var lineData = {};
  w.forEach(function(r){
    var k = 'Line '+r.line;
    if(!lineData[k]) lineData[k]={pass:0,total:0};
    lineData[k].pass+=r.pass; lineData[k].total+=r.total;
  });
  var lineHTML = Object.keys(lineData).sort().map(function(k){
    var d = lineData[k];
    var pct = d.total ? Math.round((d.pass/d.total)*100) : 0;
    var col = pct>=80?'var(--pass)':pct>=60?'var(--warn)':'var(--fail)';
    return '<div style="margin-bottom:10px">'+
      '<div style="display:flex;justify-content:space-between;margin-bottom:4px">'+
        '<span style="font-size:12px;font-weight:700">'+k+'</span>'+
        '<span style="font-size:12px;font-weight:700;color:'+col+'">'+pct+'% <span style="font-size:10px;color:var(--muted)">('+d.pass+'/'+d.total+')</span></span>'+
      '</div>'+
      '<div style="display:flex;align-items:center;gap:8px">'+mkBar(pct,col)+'</div>'+
    '</div>';
  }).join('');
  document.getElementById('dash-by-line').innerHTML = lineHTML || '<div style="color:var(--muted);font-size:12px;text-align:center;padding:10px">No data</div>';

  // ---- BY PACKAGE ----
  var pkgFails = {};
  w.forEach(function(r){
    var k = r.pkgLabel;
    if(!pkgFails[k]) pkgFails[k]={fail:0,total:0};
    pkgFails[k].fail += (r.total-r.pass);
    pkgFails[k].total += r.total;
  });
  var pkgHTML = Object.keys(pkgFails).sort(function(a,b){return pkgFails[b].fail-pkgFails[a].fail}).map(function(k){
    var d = pkgFails[k];
    var failPct = d.total ? Math.round((d.fail/d.total)*100) : 0;
    var col = failPct>20?'var(--fail)':failPct>10?'var(--warn)':'var(--pass)';
    return '<div style="margin-bottom:10px">'+
      '<div style="display:flex;justify-content:space-between;margin-bottom:4px">'+
        '<span style="font-size:12px;font-weight:700">'+k+'</span>'+
        '<span style="font-size:12px;font-weight:700;color:'+col+'">'+d.fail+' fails <span style="font-size:10px;color:var(--muted)">('+failPct+'%)</span></span>'+
      '</div>'+
      '<div style="display:flex;align-items:center;gap:8px">'+mkBar(failPct,col,'#ebebef')+'</div>'+
    '</div>';
  }).join('');
  document.getElementById('dash-by-pkg').innerHTML = pkgHTML || '<div style="color:var(--muted);font-size:12px;text-align:center;padding:10px">No data</div>';

  // ---- BY SHIFT ----
  var shiftData = {1:{pass:0,total:0,label:'1st Shift'},2:{pass:0,total:0,label:'2nd Shift'}};
  w.forEach(function(r){ if(shiftData[r.shift]){ shiftData[r.shift].pass+=r.pass; shiftData[r.shift].total+=r.total; } });
  var shiftHTML = [1,2].map(function(s){
    var d = shiftData[s];
    var pct = d.total ? Math.round((d.pass/d.total)*100) : 0;
    var col = pct>=80?'var(--pass)':pct>=60?'var(--warn)':'var(--fail)';
    return '<div style="margin-bottom:10px">'+
      '<div style="display:flex;justify-content:space-between;margin-bottom:4px">'+
        '<span style="font-size:12px;font-weight:700">'+d.label+'</span>'+
        '<span style="font-size:12px;font-weight:700;color:'+col+'">'+pct+'% <span style="font-size:10px;color:var(--muted)">('+d.pass+'/'+d.total+')</span></span>'+
      '</div>'+
      '<div style="display:flex;align-items:center;gap:8px">'+mkBar(pct,col)+'</div>'+
    '</div>';
  }).join('');
  document.getElementById('dash-by-shift').innerHTML = shiftHTML;

  // ---- TREND CHART ----
  var numDays = dashDays || 30;
  var now = new Date();
  var days = {};
  for(var i=numDays-1;i>=0;i--){
    var d=new Date(now); d.setDate(d.getDate()-i);
    var dk=d.getFullYear()+'-'+String(d.getMonth()+1).padStart(2,'0')+'-'+String(d.getDate()).padStart(2,'0');
    days[dk]={pass:0,total:0};
  }
  w.forEach(function(r){var k=r.date.split('T')[0];if(days[k]){days[k].pass+=r.pass;days[k].total+=r.total;}});
  var tLabels=Object.keys(days).map(function(k){var d=new Date(k+'T12:00:00');return d.toLocaleDateString('en-US',{month:'short',day:'numeric'})});
  var tData=Object.values(days).map(function(d){return d.total?Math.round((d.pass/d.total)*100):null});

  if(trendChart) trendChart.destroy();
  trendChart=new Chart(document.getElementById('chart-trend').getContext('2d'),{
    type:'line',
    data:{labels:tLabels,datasets:[{label:'Compliance %',data:tData,borderColor:'#c8102e',backgroundColor:'rgba(200,16,46,0.06)',tension:0.4,fill:true,pointBackgroundColor:'#c8102e',pointRadius:4,spanGaps:true}]},
    options:{responsive:true,plugins:{legend:{display:false}},scales:{x:{grid:{color:'#ebebef'},ticks:{color:'#6b6b85',font:{family:'Raleway',size:9},maxTicksLimit:7}},y:{min:0,max:100,grid:{color:'#ebebef'},ticks:{color:'#6b6b85',font:{family:'Raleway',size:9},callback:function(v){return v+'%'}}}}}
  });

  // ---- DONUT ----
  if(donutChart) donutChart.destroy();
  donutChart=new Chart(document.getElementById('chart-donut').getContext('2d'),{
    type:'doughnut',
    data:{labels:['In Target','Out of Target'],datasets:[{data:[tPass||0,tFail||0],backgroundColor:['#16a34a','#dc2626'],borderWidth:0,borderRadius:4}]},
    options:{responsive:true,cutout:'72%',plugins:{legend:{labels:{color:'#6b6b85',font:{family:'Raleway',size:11}}}}}
  });

  // ---- GMP STATS ----
  var totalAudits = gmps.length;
  var totalItems  = totalAudits * 21;
  var totalPassed = 0, totalFailed = 0;
  var itemFails   = {};
  var operators   = {};

  gmps.forEach(function(r){
    Object.keys(r.answers).forEach(function(i){
      var v = r.answers[i];
      if(v==='yes') totalPassed++;
      if(v==='no'){
        totalFailed++;
        var label = GMP_ITEMS[parseInt(i)] || ('Item '+i);
        itemFails[label] = (itemFails[label]||0)+1;
      }
    });
    if(r.completedBy){ operators[r.completedBy]=(operators[r.completedBy]||0)+1; }
  });

  var gmpComp = totalItems ? Math.round(((totalItems-totalFailed)/totalItems)*100) : 0;
  var topOperator = Object.keys(operators).sort(function(a,b){return operators[b]-operators[a]})[0] || '‚Äî';

  // Temp averages
  var temps={begin:[],mid:[],end:[]};
  gmps.forEach(function(r){
    if(!r.temp) return;
    var b=parseFloat(r.temp.begin&&r.temp.begin.temp); if(!isNaN(b)) temps.begin.push(b);
    var m=parseFloat(r.temp.mid&&r.temp.mid.temp);     if(!isNaN(m)) temps.mid.push(m);
    var e=parseFloat(r.temp.end&&r.temp.end.temp);     if(!isNaN(e)) temps.end.push(e);
  });
  var avgTemp = function(arr){ return arr.length?(arr.reduce(function(a,b){return a+b},0)/arr.length).toFixed(1):'‚Äî'; };

  document.getElementById('dash-gmp-stats').innerHTML =
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px">' +
      '<div class="big-stat" style="border-color:#1a5276"><div class="blbl">TOTAL AUDITS</div><div class="bval" style="color:#1a5276">'+totalAudits+'</div><div class="bsub">completed</div></div>' +
      '<div class="big-stat green"><div class="blbl">GMP COMPLIANCE</div><div class="bval">'+gmpComp+'%</div><div class="bsub">items passed</div></div>' +
      '<div class="big-stat green"><div class="blbl">ITEMS PASSED</div><div class="bval">'+totalPassed+'</div><div class="bsub">‚úì acceptable</div></div>' +
      '<div class="big-stat red"><div class="blbl">ITEMS FAILED</div><div class="bval">'+totalFailed+'</div><div class="bsub">‚úó not acceptable</div></div>' +
    '</div>' +
    '<div class="stat-card" style="margin-bottom:10px"><div class="slabel">TOP OPERATOR</div><div class="svalue" style="font-size:16px">'+topOperator+'</div></div>';

  // ---- GMP TOP FAILURES ----
  var sortedFails = Object.keys(itemFails).sort(function(a,b){return itemFails[b]-itemFails[a]}).slice(0,5);
  var maxFail = sortedFails.length ? itemFails[sortedFails[0]] : 1;
  document.getElementById('dash-gmp-failures').innerHTML = sortedFails.length ?
    sortedFails.map(function(item){
      var count = itemFails[item];
      var pct   = Math.round((count/maxFail)*100);
      return '<div style="margin-bottom:10px">'+
        '<div style="display:flex;justify-content:space-between;margin-bottom:4px">'+
          '<span style="font-size:11px;font-weight:600;color:var(--text)">'+item+'</span>'+
          '<span style="font-size:11px;font-weight:700;color:var(--fail)">'+count+'x</span>'+
        '</div>'+
        '<div style="display:flex;align-items:center;gap:8px">'+mkBar(pct,'var(--fail)','#ffe0e0')+'</div>'+
      '</div>';
    }).join('') :
    '<div style="color:var(--muted);font-size:12px;text-align:center;padding:10px">No GMP failures recorded üéâ</div>';

  // ---- TEMP AVERAGES ----
  document.getElementById('dash-temp-avg').innerHTML =
    '<div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px">' +
      '<div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px;text-align:center"><div style="font-size:9px;color:var(--muted);font-weight:700;letter-spacing:0.1em;margin-bottom:4px">BEGINNING</div><div style="font-size:22px;font-weight:800">'+avgTemp(temps.begin)+'</div><div style="font-size:9px;color:var(--muted)">¬∞F avg</div></div>' +
      '<div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px;text-align:center"><div style="font-size:9px;color:var(--muted);font-weight:700;letter-spacing:0.1em;margin-bottom:4px">MIDDLE</div><div style="font-size:22px;font-weight:800">'+avgTemp(temps.mid)+'</div><div style="font-size:9px;color:var(--muted)">¬∞F avg</div></div>' +
      '<div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px;text-align:center"><div style="font-size:9px;color:var(--muted);font-weight:700;letter-spacing:0.1em;margin-bottom:4px">END</div><div style="font-size:22px;font-weight:800">'+avgTemp(temps.end)+'</div><div style="font-size:9px;color:var(--muted)">¬∞F avg</div></div>' +
    '</div>';

  // ---- RECENT RECORDS ----
  var list=document.getElementById('records-list');
  if(!w.length){list.innerHTML='<div class="empty">No records yet</div>';return;}
  list.innerHTML=w.slice().reverse().slice(0,10).map(function(r){
    var cls=r.compliance>=80?'hi':r.compliance>=60?'mi':'lo';
    var dt=new Date(r.date).toLocaleDateString('en-US',{month:'short',day:'numeric'});
    return '<div class="rec-item"><div><div class="rec-line">Line '+r.line+' ¬∑ '+r.pkgLabel+'</div><div class="rec-meta">'+dt+' ¬∑ '+(r.shift===1?'1st':'2nd')+' Shift ¬∑ '+r.time+(r.lot?' ¬∑ LOT:'+r.lot:'')+'</div></div><div class="rec-comp '+cls+'">'+r.compliance+'%</div></div>';
  }).join('');
}

function exportDashPDF() {
  var db   = getDB();
  var w    = filterByDays(db.weights);
  var gmps = filterByDays(db.gmps);
  var periodLabel = dashDays ? 'Last '+dashDays+' days' : 'All Time';
  var dateStr = new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});

  var tBags = w.reduce(function(a,r){return a+r.total},0);
  var tPass = w.reduce(function(a,r){return a+r.pass},0);
  var tFail = tBags - tPass;
  var comp  = tBags ? Math.round((tPass/tBags)*100) : 0;
  var compColor = comp>=80?'#2d6a4f':'#c1121f';
  var compBg    = comp>=80?'#d8f3dc':'#ffe0e0';

  // Line stats
  var lineData = {};
  w.forEach(function(r){
    var k='Line '+r.line;
    if(!lineData[k]) lineData[k]={pass:0,total:0};
    lineData[k].pass+=r.pass; lineData[k].total+=r.total;
  });
  var lineRows = Object.keys(lineData).sort().map(function(k){
    var d=lineData[k];
    var pct=d.total?Math.round((d.pass/d.total)*100):0;
    var col=pct>=80?'#2d6a4f':pct>=60?'#b45309':'#c1121f';
    var bg=pct>=80?'#d8f3dc':pct>=60?'#fff9e6':'#ffe0e0';
    return '<tr style="background:'+bg+'"><td style="border:1px solid #ddd;padding:6px 10px;font-weight:700">'+k+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px;text-align:center">'+d.pass+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px;text-align:center">'+(d.total-d.pass)+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px;text-align:center;font-weight:800;color:'+col+'">'+pct+'%</td></tr>';
  }).join('');

  // Package fails
  var pkgFails={};
  w.forEach(function(r){
    var k=r.pkgLabel;
    if(!pkgFails[k]) pkgFails[k]={fail:0,total:0};
    pkgFails[k].fail+=(r.total-r.pass); pkgFails[k].total+=r.total;
  });
  var pkgRows = Object.keys(pkgFails).sort(function(a,b){return pkgFails[b].fail-pkgFails[a].fail}).map(function(k){
    var d=pkgFails[k];
    var pct=d.total?Math.round((d.fail/d.total)*100):0;
    var col=pct>20?'#c1121f':pct>10?'#b45309':'#2d6a4f';
    return '<tr><td style="border:1px solid #ddd;padding:6px 10px;font-weight:700">'+k+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px;text-align:center;color:#c1121f;font-weight:700">'+d.fail+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px;text-align:center;font-weight:700;color:'+col+'">'+pct+'%</td></tr>';
  }).join('');

  // GMP stats
  var totalAudits=gmps.length, totalFailed=0;
  var itemFails={};
  gmps.forEach(function(r){
    Object.keys(r.answers).forEach(function(i){
      if(r.answers[i]==='no'){
        totalFailed++;
        var label=GMP_ITEMS[parseInt(i)]||('Item '+i);
        itemFails[label]=(itemFails[label]||0)+1;
      }
    });
  });
  var totalChecked = totalAudits*21;
  var gmpComp = totalChecked?Math.round(((totalChecked-totalFailed)/totalChecked)*100):0;
  var gmpColor = gmpComp>=80?'#2d6a4f':'#c1121f';
  var gmpBg    = gmpComp>=80?'#d8f3dc':'#ffe0e0';

  var top5fails = Object.keys(itemFails).sort(function(a,b){return itemFails[b]-itemFails[a]}).slice(0,5);
  var failRows  = top5fails.map(function(item){
    return '<tr><td style="border:1px solid #ddd;padding:6px 10px;font-size:9px">'+item+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px;text-align:center;font-weight:700;color:#c1121f">'+itemFails[item]+'x</td></tr>';
  }).join('');

  var allVals=[];
  w.forEach(function(r){ r.vals.forEach(function(v){ var n=parseFloat(v); if(!isNaN(n)) allVals.push({val:n,min:PKGS[r.pkg].min,max:PKGS[r.pkg].max}); }); });
  var avgW = allVals.length?(allVals.reduce(function(a,b){return a+b.val},0)/allVals.length).toFixed(3):'‚Äî';
  var minW = allVals.length?Math.min.apply(null,allVals.map(function(v){return v.val})).toFixed(3):'‚Äî';
  var maxW = allVals.length?Math.max.apply(null,allVals.map(function(v){return v.val})).toFixed(3):'‚Äî';

  var h = '<!DOCTYPE html><html><head><meta charset="UTF-8"><style>'+
    'body{font-family:Arial,sans-serif;font-size:10px;color:#111;padding:20px;background:#fafafa;margin:0}'+
    '@page{size:portrait;margin:12mm}'+
    '@media print{body{background:white}}'+
    'table{width:100%;border-collapse:collapse;margin-bottom:14px}'+
    'th{border:1px solid #ddd;padding:6px 10px;background:#2b2d42;color:white;font-size:9px;text-align:center}'+
  '</style></head><body>'+

  // Header
  '<div style="background:#2b2d42;color:white;border-radius:12px;padding:16px 20px;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center">'+
    '<div style="display:flex;align-items:center;gap:14px">'+
      '<img src="data:image/png;base64,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" style="height:44px;object-fit:contain;background:white;border-radius:6px;padding:3px">'+
      '<div><div style="font-size:16px;font-weight:900">Dashboard Report</div><div style="font-size:9px;opacity:0.7;margin-top:2px">Caputo Quality Control ¬∑ Building 1945</div></div>'+
    '</div>'+
    '<div style="text-align:right;font-size:9px;opacity:0.8;line-height:1.8"><div>'+dateStr+'</div><div>Period: '+periodLabel+'</div></div>'+
  '</div>'+

  // Weight summary cards
  '<div style="font-size:13px;font-weight:800;color:#2b2d42;margin-bottom:10px;display:flex;align-items:center;gap:8px">'+
    '<div style="width:4px;height:16px;background:#c8102e;border-radius:2px"></div>‚öñÔ∏è Weight Monitoring Summary'+
  '</div>'+
  '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:14px">'+
    '<div style="background:#f5f5f7;border:1px solid #dcdce4;border-radius:10px;padding:10px;text-align:center"><div style="font-size:22px;font-weight:900;color:#2b2d42">'+tBags+'</div><div style="font-size:8px;color:#888;text-transform:uppercase">Total Bags</div></div>'+
    '<div style="background:#d8f3dc;border:1px solid #95d5b2;border-radius:10px;padding:10px;text-align:center"><div style="font-size:22px;font-weight:900;color:#2d6a4f">'+tPass+'</div><div style="font-size:8px;color:#888;text-transform:uppercase">In Target</div></div>'+
    '<div style="background:#ffe0e0;border:1px solid #ffb3b3;border-radius:10px;padding:10px;text-align:center"><div style="font-size:22px;font-weight:900;color:#c1121f">'+tFail+'</div><div style="font-size:8px;color:#888;text-transform:uppercase">Out of Target</div></div>'+
    '<div style="background:'+compBg+';border-radius:10px;padding:10px;text-align:center"><div style="font-size:22px;font-weight:900;color:'+compColor+'">'+comp+'%</div><div style="font-size:8px;color:#888;text-transform:uppercase">Compliance</div></div>'+
  '</div>'+

  // Weight secondary stats
  '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:14px">'+
    '<div style="background:#f5f5f7;border:1px solid #dcdce4;border-radius:8px;padding:8px;text-align:center"><div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700">Avg Weight</div><div style="font-size:16px;font-weight:800">'+avgW+'</div><div style="font-size:8px;color:#aaa">lbs</div></div>'+
    '<div style="background:#f5f5f7;border:1px solid #dcdce4;border-radius:8px;padding:8px;text-align:center"><div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700">Min Weight</div><div style="font-size:16px;font-weight:800;color:#c1121f">'+minW+'</div><div style="font-size:8px;color:#aaa">lbs</div></div>'+
    '<div style="background:#f5f5f7;border:1px solid #dcdce4;border-radius:8px;padding:8px;text-align:center"><div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700">Max Weight</div><div style="font-size:16px;font-weight:800;color:#2d6a4f">'+maxW+'</div><div style="font-size:8px;color:#aaa">lbs</div></div>'+
  '</div>'+

  // By line
  '<div style="font-size:11px;font-weight:800;color:#2b2d42;margin-bottom:6px">Compliance by Line</div>'+
  '<table><thead><tr><th style="text-align:left">Line</th><th>In Target</th><th>Out of Target</th><th>Compliance</th></tr></thead>'+
  '<tbody>'+(lineRows||'<tr><td colspan="4" style="text-align:center;color:#aaa;padding:10px">No data</td></tr>')+'</tbody></table>'+

  // By package
  '<div style="font-size:11px;font-weight:800;color:#2b2d42;margin-bottom:6px">Failures by Package Size</div>'+
  '<table><thead><tr><th style="text-align:left">Package</th><th>Failures</th><th>Fail Rate</th></tr></thead>'+
  '<tbody>'+(pkgRows||'<tr><td colspan="3" style="text-align:center;color:#aaa;padding:10px">No data</td></tr>')+'</tbody></table>'+

  // GMP header
  '<div style="font-size:13px;font-weight:800;color:#2b2d42;margin-bottom:10px;margin-top:4px;display:flex;align-items:center;gap:8px">'+
    '<div style="width:4px;height:16px;background:#1a5276;border-radius:2px"></div>üè≠ GMP Audit Summary'+
  '</div>'+
  '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:14px">'+
    '<div style="background:#e8f0fe;border:1px solid #b3c9f7;border-radius:10px;padding:10px;text-align:center"><div style="font-size:22px;font-weight:900;color:#1a5276">'+totalAudits+'</div><div style="font-size:8px;color:#888;text-transform:uppercase">Total Audits</div></div>'+
    '<div style="background:'+gmpBg+';border-radius:10px;padding:10px;text-align:center"><div style="font-size:22px;font-weight:900;color:'+gmpColor+'">'+gmpComp+'%</div><div style="font-size:8px;color:#888;text-transform:uppercase">GMP Compliance</div></div>'+
    '<div style="background:#ffe0e0;border:1px solid #ffb3b3;border-radius:10px;padding:10px;text-align:center"><div style="font-size:22px;font-weight:900;color:#c1121f">'+totalFailed+'</div><div style="font-size:8px;color:#888;text-transform:uppercase">Items Failed</div></div>'+
  '</div>'+

  // Top GMP failures
  (failRows ? '<div style="font-size:11px;font-weight:800;color:#2b2d42;margin-bottom:6px">Top GMP Failures</div>'+
    '<table><thead><tr><th style="text-align:left">GMP Item</th><th>Times Failed</th></tr></thead>'+
    '<tbody>'+failRows+'</tbody></table>' : '') +

  // Footer
  '<div style="margin-top:14px;border-top:1px solid #dcdce4;padding-top:8px;display:flex;justify-content:space-between;font-size:8px;color:#aaa">'+
    '<span>Caputo Quality Control System ¬∑ Building 1945</span>'+
    '<span>Generated: '+dateStr+' ¬∑ Period: '+periodLabel+'</span>'+
  '</div>'+

  '</body></html>';

  var blob=new Blob([h],{type:'text/html'});
  var url=URL.createObjectURL(blob);
  var a=document.createElement('a');
  a.href=url; a.target='_blank'; a.click();
  setTimeout(function(){URL.revokeObjectURL(url);},3000);
}

function clearData(){
  if(confirm('Delete all records?')){localStorage.removeItem('caputo_db');if(window.clearFirebase)window.clearFirebase();initDash();toast('Data cleared')}
}

// ===== GMP =====
function initGmp(){
  document.getElementById('gmp-date').value=localDateStr();
  renderGmpList();
}
function renderGmpList(){
  document.getElementById('gmp-list').innerHTML=GMP_ITEMS.map(function(item,i){
    var v=gmpAnswers[i];
    return '<div class="gmp-row">' +
      '<div class="gmp-item-lbl">'+item+'</div>' +
      '<div class="gmp-btns">' +
        '<button class="gmp-tog'+(v==='yes'?' yes-on':'')+'" data-i="'+i+'" data-v="yes" onclick="setGmpItem(this)">YES</button>' +
        '<button class="gmp-tog'+(v==='no'?' no-on':'')+'" data-i="'+i+'" data-v="no" onclick="setGmpItem(this)">NO</button>' +
      '</div>' +
    '</div>';
  }).join('');
}
function setGmpItem(btn){
  gmpAnswers[parseInt(btn.getAttribute('data-i'))]=btn.getAttribute('data-v');
  renderGmpList();
}
function setGmpShift(n){
  gmpShift=n;
  document.getElementById('gmp-s1').className='gmp-tog'+(n===1?' yes-on':'');
  document.getElementById('gmp-s2').className='gmp-tog'+(n===2?' yes-on':'');
}
function gv(id){var e=document.getElementById(id);return e?e.value:'';}
function saveGmp(){
  var db=getDB();
  db.gmps.push({
    id:Date.now(), date:gv('gmp-date'), location:gv('gmp-loc'),
    shift:gmpShift, answers:Object.assign({},gmpAnswers),
    temp:{begin:{time:gv('t-begin-time'),temp:gv('t-begin-temp'),chop:gv('t-begin-chop'),plat:gv('t-begin-plat'),line6:gv('t-begin-line6'),init:gv('t-begin-init')},
          mid:{time:gv('t-mid-time'),temp:gv('t-mid-temp'),chop:gv('t-mid-chop'),plat:gv('t-mid-plat'),line6:gv('t-mid-line6'),init:gv('t-mid-init')},
          end:{time:gv('t-end-time'),temp:gv('t-end-temp'),chop:gv('t-end-chop'),plat:gv('t-end-plat'),line6:gv('t-end-line6'),init:gv('t-end-init')}},
    comments:gv('gmp-comments'), completedBy:gv('gmp-completed'), verifiedBy:gv('gmp-verified')
  });
  saveDB(db);
  if(window.saveToFirebase) window.saveToFirebase('gmps', db.gmps[db.gmps.length-1]);
  gmpAnswers={}; gmpShift=null;
  ['gmp-loc','gmp-comments','gmp-completed','gmp-verified'].forEach(function(id){document.getElementById(id).value='';});
  ['t-begin-time','t-mid-time','t-end-time','t-begin-temp','t-mid-temp','t-end-temp',
   't-begin-chop','t-mid-chop','t-end-chop','t-begin-plat','t-mid-plat','t-end-plat',
   't-begin-line6','t-mid-line6','t-end-line6','t-begin-init','t-mid-init','t-end-init'].forEach(function(id){document.getElementById(id).value='';});
  setGmpShift(0);
  renderGmpList();
  toast('GMP record saved!');
}

// ===== PDF WEIGHT =====
function exportWeightPDF(){
  var db=getDB();
  if(!db.weights.length){toast('No records to export');return}
  var now=new Date();
  var dateStr=now.toLocaleDateString('en-US',{year:'numeric',month:'2-digit',day:'2-digit'});
  var records=db.weights.slice().reverse();
  var lineVal=st.line?'Line '+st.line:'___';
  var shiftVal=st.shift?(st.shift===1?'1st':'2nd'):'___';
  var tBags=db.weights.reduce(function(a,r){return a+r.total},0);
  var tPass=db.weights.reduce(function(a,r){return a+r.pass},0);
  var tFail=tBags-tPass;
  var comp=tBags?Math.round((tPass/tBags)*100):0;
  var compColor=comp>=80?'#16a34a':'#dc2626';
  var th='style="border:1px solid #999;padding:4px 6px;background:#333;color:white;font-size:9px;text-align:center"';
  var thr='style="border:1px solid #999;padding:4px 6px;background:#c8102e;color:white;font-size:9px;text-align:center"';
  function sRow(label,idx){
    return '<tr><td style="border:1px solid #ccc;font-weight:700;background:#f5f5f5;padding:4px 8px;white-space:nowrap">'+label+'</td>'+
      records.map(function(r){var v=r.vals[idx];if(v===undefined||v===null||v==='')return '<td style="border:1px solid #ccc"></td>';var num=parseFloat(v);var p=PKGS[r.pkg];var col=(p&&!isNaN(num)&&num>=p.min&&num<=p.max)?'#16a34a':'#dc2626';return '<td style="border:1px solid #ccc;text-align:center;font-weight:600;color:'+col+'">'+num.toFixed(3)+'</td>'}).join('')+'</tr>';
  }
  var compCells=records.map(function(r){var col=r.compliance>=80?'#16a34a':'#dc2626';return '<td style="border:1px solid #ccc;text-align:center;font-weight:700;color:'+col+';padding:4px">'+r.compliance+'%</td>'}).join('');
  var h='<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{font-family:Arial,sans-serif;font-size:10px;color:#111;padding:16px}table{font-size:9px}</style></head><body>'+
  '<div style="display:flex;justify-content:space-between;align-items:flex-start;border-bottom:3px solid #c8102e;padding-bottom:10px;margin-bottom:12px">'+
    '<div><img src="'+LOGO+'" style="height:48px;object-fit:contain"><br><span style="font-size:8px;color:#777">1931/1935/1945 N 15th Ave, Melrose Park, IL 60160</span></div>'+
    '<div style="text-align:right;font-size:9px;color:#555">SQF # 2.4.D.1.1 LeakPointer H2O Quality Check Log<br>Revision: 01/20/25 | Supersedes: 08/21/24</div>'+
  '</div>'+
  '<div style="font-weight:900;font-size:12px;text-align:center;border:2px solid #111;padding:5px;background:#f0f0f0;margin-bottom:10px">SQF # 2.4.D.1.1: 1945 Weight Monitoring &amp; Leak Pointer H2O Quality Check Log</div>'+
  '<div style="display:flex;gap:20px;margin-bottom:8px;font-size:10px"><span><b>LOT:</b> ___________</span><span><b>DATE:</b> '+dateStr+'</span><span><b>SHIFT:</b> '+shiftVal+'</span><span><b>LINE:</b> '+lineVal+'</span></div>'+
  '<div style="font-size:9px;color:#555;margin-bottom:8px;font-style:italic">FREQUENCY: Beginning and Every hour (+/-5 minutes)</div>'+
  '<div style="font-weight:900;font-size:11px;background:#c8102e;color:white;padding:4px 8px;margin-bottom:4px">WEIGHT LOG</div>'+
  '<table style="width:100%;border-collapse:collapse;margin-bottom:10px"><thead>'+
  '<tr><th '+thr+'>PACKAGE WEIGHT</th>'+records.map(function(r){return '<th '+th+'>'+r.pkgLabel+'</th>'}).join('')+'</tr>'+
  '<tr><th '+thr+'>TIME</th>'+records.map(function(r){return '<th '+th+'>'+(r.time||'‚Äî')+'</th>'}).join('')+'</tr>'+
  '</thead><tbody>'+
  sRow('Sample 1',0)+sRow('Sample 2',1)+sRow('Sample 3',2)+sRow('Sample 4',3)+sRow('Sample 5',4)+
  '<tr><td style="border:1px solid #ccc;font-weight:700;background:#f5f5f5;padding:4px 8px">TOTAL</td>'+records.map(function(r){return '<td style="border:1px solid #ccc;text-align:center;font-weight:600;background:#fafff8">'+r.total+'</td>'}).join('')+'</tr>'+
  '<tr><td style="border:1px solid #ccc;font-weight:700;background:#f5f5f5;padding:4px 8px">AVERAGE</td>'+records.map(function(r){return '<td style="border:1px solid #ccc;text-align:center;font-weight:600;background:#fafff8">'+parseFloat(r.avg).toFixed(3)+'</td>'}).join('')+'</tr>'+
  '<tr><td style="border:1px solid #ccc;font-weight:700;background:#f5f5f5;padding:4px 8px">COMPLIANCE</td>'+compCells+'</tr>'+
  '<tr><td style="border:1px solid #ccc;font-weight:700;background:#f5f5f5;padding:4px 8px">LOT</td>'+records.map(function(r){return '<td style="border:1px solid #ccc;text-align:center">'+(r.lot||'')+'</td>'}).join('')+'</tr>'+
  '<tr><td style="border:1px solid #ccc;font-weight:700;background:#f5f5f5;padding:4px 8px">INITIALS</td>'+records.map(function(r){return '<td style="border:1px solid #ccc;text-align:center">'+(r.initials||'')+'</td>'}).join('')+'</tr>'+
  '</tbody></table>'+
  '<div style="display:flex;gap:10px;margin-bottom:12px">'+
    '<div style="flex:1;border:2px solid #ddd;border-radius:6px;padding:8px;text-align:center"><div style="font-size:22px;font-weight:900">'+tBags+'</div><div style="font-size:8px;color:#888;text-transform:uppercase">Total Bags</div></div>'+
    '<div style="flex:1;border:2px solid #16a34a;border-radius:6px;padding:8px;text-align:center"><div style="font-size:22px;font-weight:900;color:#16a34a">'+tPass+'</div><div style="font-size:8px;color:#888;text-transform:uppercase">In Target</div></div>'+
    '<div style="flex:1;border:2px solid #dc2626;border-radius:6px;padding:8px;text-align:center"><div style="font-size:22px;font-weight:900;color:#dc2626">'+tFail+'</div><div style="font-size:8px;color:#888;text-transform:uppercase">Out of Target</div></div>'+
    '<div style="flex:1;border:2px solid '+compColor+';border-radius:6px;padding:8px;text-align:center"><div style="font-size:22px;font-weight:900;color:'+compColor+'">'+comp+'%</div><div style="font-size:8px;color:#888;text-transform:uppercase">Compliance</div></div>'+
  '</div>'+
  '<div style="font-size:8px;color:#999;border-top:1px solid #ddd;padding-top:8px;display:flex;justify-content:space-between"><span>Caputo Quality Control System</span><span>SQF # 2.4.D.1.1 | Building 1945 | '+dateStr+'</span></div>'+
  '</body></html>';
  var blob=new Blob([h],{type:'text/html'});
  var url=URL.createObjectURL(blob);
  var a=document.createElement('a');
  a.href=url; a.target='_blank'; a.click();
  setTimeout(function(){URL.revokeObjectURL(url);},3000);
}

// ===== PDF GMP =====
function exportGmpPDF(){
  var dateVal=gv('gmp-date');
  var location=gv('gmp-loc')||'___';
  var shiftLabel=gmpShift?(gmpShift===1?'1st':'2nd'):'___';
  var dateStr=dateVal?new Date(dateVal+'T12:00:00').toLocaleDateString('en-US',{year:'numeric',month:'2-digit',day:'2-digit'}):new Date().toLocaleDateString('en-US',{year:'numeric',month:'2-digit',day:'2-digit'});
  var checkRows=GMP_ITEMS.map(function(item,i){
    var val=gmpAnswers[i];
    var yBox=val==='yes'?'&#9745;':'&#9744;';
    var nBox=val==='no'?'&#9745;':'&#9744;';
    var bg=val==='no'?'#fff5f5':val==='yes'?'#f0fff4':'white';
    return '<tr style="background:'+bg+'"><td style="border:1px solid #ccc;padding:5px 8px;font-size:10px">'+item+'</td>'+
      '<td style="border:1px solid #ccc;padding:5px;text-align:center;font-size:14px;width:60px">'+yBox+' Yes</td>'+
      '<td style="border:1px solid #ccc;padding:5px;text-align:center;font-size:14px;width:60px">'+nBox+' No</td></tr>';
  }).join('');
  var h='<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{font-family:Arial,sans-serif;font-size:10px;color:#111;padding:20px}table{width:100%;border-collapse:collapse}th{border:1px solid #999;padding:5px 8px;background:#f0f0f0;font-size:10px;text-align:center}td{border:1px solid #ccc;padding:4px 8px;font-size:10px}</style></head><body>'+
  '<div style="display:flex;justify-content:space-between;font-size:9px;color:#555;margin-bottom:10px"><span>SQF # 2.5.D Internal Audits and Inspections</span><span style="text-decoration:underline">Document: 2.5.D.A Daily GMP Facility Audit</span></div>'+
  '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">'+
    '<div style="display:flex;align-items:center;gap:14px"><img src="'+LOGO+'" style="height:52px;object-fit:contain"><div style="font-size:9px;color:#555;line-height:1.7">1931 N 15th Ave<br>1935 N 15th Ave<br>1945 N 15th Ave<br>Melrose Park, IL.</div></div>'+
    '<div style="font-size:22px;font-weight:900">SQF # 2.5.D.A Daily GMP Facility Audit</div>'+
  '</div>'+
  '<p style="font-size:10px;margin-bottom:10px"><strong><u>Instructions:</u></strong> Evaluate while auditing whether or not the following are acceptable (check yes or no).</p>'+
  '<div style="display:flex;gap:30px;margin:10px 0;font-size:10px;border-bottom:1px solid #ddd;padding-bottom:8px">'+
    '<span><b>Location:</b> <span style="border-bottom:1px solid #aaa;display:inline-block;min-width:100px">&nbsp;'+location+'&nbsp;</span></span>'+
    '<span><b>Date:</b> <span style="border-bottom:1px solid #aaa">&nbsp;'+dateStr+'&nbsp;</span></span>'+
    '<span><b>Shift:</b> <span style="border-bottom:1px solid #aaa">&nbsp;'+shiftLabel+'&nbsp;</span></span>'+
  '</div>'+
  '<table style="margin-bottom:12px"><thead><tr>'+
    '<th style="text-align:left;background:#222;color:white"><i>Check/Inspect</i></th>'+
    '<th style="background:#222;color:white;width:120px" colspan="2"><i>Acceptable</i></th>'+
  '</tr></thead><tbody>'+checkRows+'</tbody></table>'+
  '<div style="background:#222;color:white;font-weight:700;font-size:10px;text-align:center;padding:5px;letter-spacing:1px">1945 TEMPERATURE &amp; % RELATIVE HUMIDITY MONITORING (FREQUENCY: BEGINNING-MIDDLE-END OF THE SHIFT)</div>'+
  '<table style="margin-bottom:12px"><thead><tr>'+
    '<th style="text-align:left;width:35%"></th><th>BEGINNING</th><th>MIDDLE</th><th>END</th>'+
  '</tr></thead><tbody>'+
    '<tr><td style="font-weight:700">TIME</td><td style="text-align:center">'+gv('t-begin-time')+'</td><td style="text-align:center">'+gv('t-mid-time')+'</td><td style="text-align:center">'+gv('t-end-time')+'</td></tr>'+
    '<tr><td style="font-weight:700">TEMPERATURE</td><td style="text-align:center">'+gv('t-begin-temp')+'</td><td style="text-align:center">'+gv('t-mid-temp')+'</td><td style="text-align:center">'+gv('t-end-temp')+'</td></tr>'+
    '<tr><td style="font-weight:700">CHOPPING AREA HUMIDITY</td><td style="text-align:center">'+gv('t-begin-chop')+'</td><td style="text-align:center">'+gv('t-mid-chop')+'</td><td style="text-align:center">'+gv('t-end-chop')+'</td></tr>'+
    '<tr><td style="font-weight:700">UNDER PLATFORM HUMIDITY</td><td style="text-align:center">'+gv('t-begin-plat')+'</td><td style="text-align:center">'+gv('t-mid-plat')+'</td><td style="text-align:center">'+gv('t-end-plat')+'</td></tr>'+
    '<tr><td style="font-weight:700">LINE 6 &amp; GRILLING C. HUMIDITY</td><td style="text-align:center">'+gv('t-begin-line6')+'</td><td style="text-align:center">'+gv('t-mid-line6')+'</td><td style="text-align:center">'+gv('t-end-line6')+'</td></tr>'+
    '<tr><td style="font-weight:700">INITIALS</td><td style="text-align:center">'+gv('t-begin-init')+'</td><td style="text-align:center">'+gv('t-mid-init')+'</td><td style="text-align:center">'+gv('t-end-init')+'</td></tr>'+
  '</tbody></table>'+
  '<div style="border:1px solid #222;padding:5px;text-align:center;font-weight:700;background:#f5f5f5;margin-bottom:4px">Additional Comments/ Notes on Corrections and Corrective Actions</div>'+
  '<div style="border:1px solid #ccc;min-height:50px;padding:8px;margin-bottom:16px">'+gv('gmp-comments')+'</div>'+
  '<div style="margin-top:10px"><div style="border-bottom:1px solid #aaa;padding-bottom:4px;font-size:10px">'+gv('gmp-completed')+'</div>'+
  '<div style="font-style:italic;font-size:10px;color:#555">Completed By: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (print name)</div></div>'+
  '<div style="margin-top:10px"><div style="border-bottom:1px solid #aaa;padding-bottom:4px;font-size:10px">'+gv('gmp-verified')+'</div>'+
  '<div style="font-style:italic;font-size:10px;color:#555">Verified By: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (signature)</div></div>'+
  '<div style="margin-top:14px;display:flex;justify-content:space-between;font-size:9px;color:#555;border-top:1px solid #ddd;padding-top:8px">'+
    '<span><b>Document Approved By:</b> _____________ &nbsp;&nbsp; <b>Date:</b> _____________</span>'+
    '<span>Revision: 10/02/25 &nbsp;&nbsp; Supersedes: 01/03/25</span>'+
  '</div>'+
  '</body></html>';
  var blob=new Blob([h],{type:'text/html'});
  var url=URL.createObjectURL(blob);
  var a=document.createElement('a');
  a.href=url; a.target='_blank'; a.click();
  setTimeout(function(){URL.revokeObjectURL(url);},3000);
}



// ===== LOGIN =====
var currentUser = null;
var selectedOperator = null;
var pinEntered = '';
var adminRole = 'operator';

function getOperators() {
  var db = getDB();
  return db.operators || [];
}
function saveOperators(ops) {
  var db = getDB();
  db.operators = ops;
  saveDB(db);
  // Sync each operator to Firebase
  if(window.saveOperatorsToFirebase) window.saveOperatorsToFirebase(ops);
}

function initLogin() {
  var ops = getOperators();
  var list = document.getElementById('operator-list');
  var noOps = document.getElementById('no-operators');
  var pinSec = document.getElementById('pin-section');

  pinSec.style.display = 'none';
  pinEntered = '';
  selectedOperator = null;

  if(!ops.length) {
    list.style.display = 'none';
    noOps.style.display = 'block';
    // Auto-create default admin on first run
    var defaultAdmin = [{name:'Admin',pin:'0000',role:'admin',id:Date.now()}];
    saveOperators(defaultAdmin);
    setTimeout(initLogin, 100);
    return;
  }

  noOps.style.display = 'none';
  list.style.display = 'block';
  list.innerHTML = ops.map(function(op){
    var roleColor = op.role==='admin'?'var(--accent)':op.role==='supervisor'?'#1a5276':'var(--muted)';
    return '<div onclick="selectOperator('+op.id+')" style="background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:14px 16px;margin-bottom:10px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:all 0.2s" class="operator-item">' +
      '<div>' +
        '<div style="font-size:15px;font-weight:700">'+op.name+'</div>' +
        '<div style="font-size:10px;color:'+roleColor+';font-weight:700;text-transform:uppercase;letter-spacing:0.1em;margin-top:2px">'+op.role+'</div>' +
      '</div>' +
      '<div style="font-size:20px">‚Üí</div>' +
    '</div>';
  }).join('');
}

function selectOperator(id) {
  var ops = getOperators();
  selectedOperator = ops.find(function(o){return o.id===id});
  if(!selectedOperator) return;

  document.getElementById('operator-list').style.display = 'none';
  document.getElementById('pin-section').style.display = 'block';
  document.getElementById('pin-operator-name').textContent = selectedOperator.name;
  pinEntered = '';
  renderPinPad();
}

function renderPinPad() {
  // Dots
  document.getElementById('pin-dots').innerHTML = [0,1,2,3].map(function(i){
    var filled = i < pinEntered.length;
    return '<div style="width:16px;height:16px;border-radius:50%;border:2px solid var(--accent);background:'+(filled?'var(--accent)':'transparent')+';transition:all 0.15s"></div>';
  }).join('');

  // Pad - use data-pinkey to avoid quote conflicts
  var keys = ['1','2','3','4','5','6','7','8','9','','0','‚å´'];
  document.getElementById('pin-pad').innerHTML = keys.map(function(k){
    if(k==='') return '<div></div>';
    var fs = (k==='‚å´') ? '20px' : '22px';
    return '<button data-pinkey="'+k+'" style="padding:18px;border-radius:14px;border:1px solid var(--border);background:var(--surface);font-family:Raleway,sans-serif;font-size:'+fs+';font-weight:700;cursor:pointer;color:var(--text);transition:all 0.1s">'+k+'</button>';
  }).join('');
  document.getElementById('pin-pad').onclick = function(e){
    var btn = e.target.closest('[data-pinkey]');
    if(btn) pinPress(btn.getAttribute('data-pinkey'));
  };
}
function pinPress(key) {
  if(key === '‚å´') {
    pinEntered = pinEntered.slice(0,-1);
  } else {
    if(pinEntered.length >= 4) return;
    pinEntered += key;
  }
  renderPinPad();

  if(pinEntered.length === 4) {
    setTimeout(verifyPin, 200);
  }
}

function verifyPin() {
  if(pinEntered === selectedOperator.pin) {
    currentUser = selectedOperator;
    loginSuccess();
  } else {
    // Wrong PIN - shake and reset
    pinEntered = '';
    renderPinPad();
    document.getElementById('pin-dots').style.animation = 'none';
    document.getElementById('pin-label').textContent = '‚úó Wrong PIN ‚Äî try again';
    document.getElementById('pin-label').style.color = 'var(--fail)';
    setTimeout(function(){
      document.getElementById('pin-label').textContent = '';
      document.getElementById('pin-label').innerHTML = 'Enter PIN for <span id="pin-operator-name" style="color:var(--accent)">'+selectedOperator.name+'</span>';
      document.getElementById('pin-label').style.color = '';
    }, 1500);
  }
}

function cancelPin() {
  document.getElementById('pin-section').style.display = 'none';
  document.getElementById('operator-list').style.display = 'block';
  pinEntered = '';
  selectedOperator = null;
}

function loginSuccess() {
  // Update user badge
  document.getElementById('user-badge').textContent = 'üë§ ' + currentUser.name;

  // Show admin card only for admins
  var adminCard = document.getElementById('admin-card');
  if(adminCard) adminCard.style.display = currentUser.role==='admin' ? 'flex' : 'none';

  goTo('screen-home');
}

function logoutUser() {
  if(!confirm('Log out of the app?')) return;
  currentUser = null;
  selectedOperator = null;
  pinEntered = '';
  goTo('screen-login');
  initLogin();
}

// ===== ADMIN =====
function setRole(btn) {
  adminRole = btn.getAttribute('data-role');
  document.querySelectorAll('[data-role]').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
}

function addOperator() {
  var name = document.getElementById('admin-name').value.trim();
  var pin  = document.getElementById('admin-pin').value.trim();

  if(!name) { toast('Enter operator name'); return; }
  if(pin.length !== 4 || !/^\d{4}$/.test(pin)) { toast('PIN must be 4 digits'); return; }

  var ops = getOperators();
  // Check duplicate name
  if(ops.find(function(o){return o.name.toLowerCase()===name.toLowerCase()})) {
    toast('Operator already exists'); return;
  }

  ops.push({id:Date.now(), name:name, pin:pin, role:adminRole, createdAt:localDateStr()});
  saveOperators(ops);

  document.getElementById('admin-name').value = '';
  document.getElementById('admin-pin').value = '';
  adminRole = 'operator';
  document.querySelectorAll('[data-role]').forEach(function(b){ b.classList.remove('active'); });
  document.getElementById('role-operator').classList.add('active');

  initAdmin();
  toast('Operator added! ‚úì');
}

function deleteOperator(id) {
  if(!confirm('Delete this operator?')) return;
  var ops = getOperators().filter(function(o){return o.id!==id});
  saveOperators(ops);
  initAdmin();
  toast('Operator deleted');
}

function initAdmin() {
  // Only admins can access this
  if(!currentUser || currentUser.role !== 'admin') {
    toast('Admin access only');
    goTo('screen-home');
    return;
  }
  var ops = getOperators();
  var roleColor = function(r){ return r==='admin'?'var(--accent)':r==='supervisor'?'#1a5276':'var(--muted)'; };
  document.getElementById('operators-list').innerHTML = ops.length ?
    ops.map(function(op){
      return '<div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 14px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center">' +
        '<div>' +
          '<div style="font-size:14px;font-weight:700">'+op.name+'</div>' +
          '<div style="font-size:10px;color:'+roleColor(op.role)+';font-weight:700;text-transform:uppercase;letter-spacing:0.1em">'+op.role+' ¬∑ PIN: '+op.pin.replace(/./g,'‚Ä¢')+'</div>' +
        '</div>' +
        '<button onclick="deleteOperator('+op.id+')" style="background:rgba(220,38,38,0.08);border:1px solid rgba(220,38,38,0.3);color:var(--fail);border-radius:8px;padding:6px 12px;font-family:Raleway,sans-serif;font-size:11px;font-weight:700;cursor:pointer">Delete</button>' +
      '</div>';
    }).join('') :
    '<div class="empty">No operators yet</div>';
}

// Auto-fill operator initials in forms when user is logged in
function getInitials() {
  if(!currentUser) return '';
  return currentUser.name.split(' ').map(function(n){return n[0]}).join('').toUpperCase();
}

// ===== REPORTS =====
var rptFilters = {date: '', line: 'all', shift: 'all'};
var rptWeightResults = [];
var rptSealResults = [];
var rptGmpResults = [];

function initReports() {
  // Set today as default date
  var today = localDateStr();
  document.getElementById('rpt-date').value = today;
  rptFilters.date = today;
  rptFilters.line = 'all';
  rptFilters.shift = 'all';
  rptFilters.product = '';
  document.getElementById('rpt-product').value = '';

  // Set all filter buttons to default
  document.querySelectorAll('.rpt-filter-btn').forEach(function(b) {
    b.classList.remove('active');
    if(b.getAttribute('data-val') === 'all') b.classList.add('active');
  });

  applyRptFilters();
}

function setRptFilter(btn) {
  var group = btn.getAttribute('data-group');
  var val   = btn.getAttribute('data-val');
  rptFilters[group] = val;
  // Update active state for group
  document.querySelectorAll('[data-group="'+group+'"]').forEach(function(b) {
    b.classList.toggle('active', b === btn);
  });
}

function applyRptFilters() {
  rptFilters.date    = document.getElementById('rpt-date').value;
  rptFilters.product = (document.getElementById('rpt-product').value || '').trim().toLowerCase();
  var db = getDB();

  // Filter weights
  rptWeightResults = db.weights.filter(function(r) {
    var matchDate    = !rptFilters.date    || r.date.startsWith(rptFilters.date);
    var matchLine    = rptFilters.line    === 'all' || String(r.line) === rptFilters.line;
    var matchShift   = rptFilters.shift   === 'all' || String(r.shift) === rptFilters.shift;
    var matchProduct = !rptFilters.product || (r.product||'').toLowerCase().includes(rptFilters.product);
    return matchDate && matchLine && matchShift && matchProduct;
  });

  // Filter seals by same criteria
  rptSealResults = db.seals.filter(function(r) {
    var matchDate    = !rptFilters.date    || r.date.startsWith(rptFilters.date);
    var matchLine    = rptFilters.line    === 'all' || String(r.line) === rptFilters.line;
    var matchShift   = rptFilters.shift   === 'all' || String(r.shift) === rptFilters.shift;
    var matchProduct = !rptFilters.product || (r.product||'').toLowerCase().includes(rptFilters.product);
    return matchDate && matchLine && matchShift && matchProduct;
  });

  // Filter gmps
  rptGmpResults = db.gmps.filter(function(r) {
    var matchDate  = !rptFilters.date  || r.date === rptFilters.date;
    var matchShift = rptFilters.shift === 'all' || String(r.shift) === rptFilters.shift;
    return matchDate && matchShift;
  });

  renderRptWeights();
  renderRptSeals();
  renderRptGmps();
}

function renderRptWeights() {
  var el = document.getElementById('rpt-weight-list');
  if(!rptWeightResults.length) {
    el.innerHTML = '<div class="empty">No weight records for this filter</div>';
    return;
  }
  el.innerHTML = rptWeightResults.map(function(r) {
    var cls = r.compliance >= 80 ? 'hi' : r.compliance >= 60 ? 'mi' : 'lo';
    var dt  = new Date(r.date).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'});
    var samples = r.vals.map(function(v){return parseFloat(v).toFixed(3)}).join(' ¬∑ ');
    return '<div class="rpt-record-card">' +
      '<span class="rc-comp '+cls+'">'+r.compliance+'%</span>' +
      '<div class="rc-title">Line '+r.line+' ¬∑ '+r.pkgLabel+'</div>' +
      '<div class="rc-meta">'+dt+' ¬∑ '+(r.shift===1?'1st':'2nd')+' Shift ¬∑ '+r.time+(r.lot?' ¬∑ LOT: '+r.lot:'')+(r.product?' ¬∑ Prod: '+r.product:'')+(r.initials?' ¬∑ '+r.initials:'')+'</div>' +
      '<div class="rc-samples">'+samples+'</div>' +
      (r.comments ? '<div style="font-size:10px;color:var(--muted);margin-top:4px">üìù '+r.comments+'</div>' : '') +
    '</div>';
  }).join('');
}

function renderRptSeals() {
  var el = document.getElementById('rpt-seal-list');
  if(!el) return;
  if(!rptSealResults.length) {
    el.innerHTML = '<div class="empty">No bag seal records for this filter</div>';
    return;
  }
  el.innerHTML = rptSealResults.map(function(r) {
    var vis   = r.checks['Visual']    || '‚Äî';
    var dunk  = r.checks['Dunk Tank'] || '‚Äî';
    var print = r.checks['Printing']  || '‚Äî';
    var dt = new Date(r.date).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'});
    return '<div class="rpt-record-card">' +
      '<div class="rc-title">Bag Seal ¬∑ Line '+r.line+'</div>' +
      '<div class="rc-meta">'+dt+' ¬∑ '+(r.shift===1?'1st':'2nd')+' Shift ¬∑ '+r.time+(r.lot?' ¬∑ LOT: '+r.lot:'')+(r.product?' ¬∑ Prod: '+r.product:'')+'</div>' +
      '<div class="rc-samples">' +
        '<span style="color:'+(vis==='pass'?'var(--pass)':'var(--fail)')+'">Visual: '+vis.toUpperCase()+'</span> &nbsp;¬∑&nbsp; ' +
        '<span style="color:'+(dunk==='pass'?'var(--pass)':'var(--fail)')+'">Dunk Tank: '+dunk.toUpperCase()+'</span> &nbsp;¬∑&nbsp; ' +
        '<span style="color:'+(print==='pass'?'var(--pass)':'var(--fail)')+'">Printing: '+print.toUpperCase()+'</span>' +
      '</div>' +
    '</div>';
  }).join('');
}

function renderRptGmps() {
  var el = document.getElementById('rpt-gmp-list');
  if(!rptGmpResults.length) {
    el.innerHTML = '<div class="empty">No GMP records for this filter</div>';
    return;
  }
  el.innerHTML = rptGmpResults.map(function(r) {
    var total = Object.keys(r.answers).length;
    var passed = Object.values(r.answers).filter(function(v){return v==='yes'}).length;
    var failed = Object.values(r.answers).filter(function(v){return v==='no'}).length;
    var dt = r.date ? new Date(r.date+'T12:00:00').toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}) : '‚Äî';
    return '<div class="rpt-record-card">' +
      '<div class="rc-title">GMP Audit ¬∑ '+(r.location||'‚Äî')+'</div>' +
      '<div class="rc-meta">'+dt+' ¬∑ '+(r.shift?(r.shift===1?'1st':'2nd')+' Shift':'‚Äî')+(r.completedBy?' ¬∑ '+r.completedBy:'')+'</div>' +
      '<div class="rc-samples" style="color:var(--pass)">‚úì '+passed+' passed &nbsp;&nbsp;<span style="color:var(--fail)">‚úó '+failed+' failed</span> &nbsp;&nbsp;<span style="color:var(--muted)">'+total+' checked</span></div>' +
      (r.comments ? '<div style="font-size:10px;color:var(--muted);margin-top:4px">üìù '+r.comments+'</div>' : '') +
    '</div>';
  }).join('');
}

function exportRptWeightPDF() {
  if(!rptWeightResults.length && !rptSealResults.length){ toast('No records to export'); return; }

  var dateVal    = rptFilters.date;
  var dateStr    = dateVal ? new Date(dateVal+'T12:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : localDateStr();
  var lineLabel  = rptFilters.line  === 'all' ? 'All Lines' : 'Line '+rptFilters.line;
  var shiftLabel = rptFilters.shift === 'all' ? 'All Shifts' : (rptFilters.shift==='1'?'1st':'2nd')+' Shift';
  var productLabel = rptFilters.product || (rptWeightResults[0] && rptWeightResults[0].product) || '‚Äî';

  // Summary stats
  var tBags = rptWeightResults.reduce(function(a,r){return a+r.total},0);
  var tPass = rptWeightResults.reduce(function(a,r){return a+r.pass},0);
  var tFail = tBags - tPass;
  var comp  = tBags ? Math.round((tPass/tBags)*100) : 0;
  var compColor = comp >= 80 ? '#2d6a4f' : '#c1121f';
  var compBg    = comp >= 80 ? '#d8f3dc' : '#ffe0e0';

  // ---- PASTEL COLORS ----
  var C = {
    red:    '#c8102e',
    redPastel:  '#fde8ec',
    bluePastel: '#e8f0fe',
    greenPastel:'#d8f3dc',
    yellowPastel:'#fff9e6',
    grayPastel: '#f5f5f7',
    border:     '#dcdce4',
    headerBg:   '#2b2d42',
    passGreen:  '#2d6a4f',
    failRed:    '#c1121f',
    passBg:     '#d8f3dc',
    failBg:     '#ffe0e0',
  };

  // ---- SUMMARY CARDS ----
  var summaryCards =
    '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:20px">' +
      '<div style="background:'+C.grayPastel+';border:1px solid '+C.border+';border-radius:10px;padding:12px;text-align:center"><div style="font-size:26px;font-weight:900;color:'+C.headerBg+'">'+tBags+'</div><div style="font-size:9px;color:#666;text-transform:uppercase;letter-spacing:1px;margin-top:2px">Total Bags</div></div>' +
      '<div style="background:'+C.greenPastel+';border:1px solid #95d5b2;border-radius:10px;padding:12px;text-align:center"><div style="font-size:26px;font-weight:900;color:'+C.passGreen+'">'+tPass+'</div><div style="font-size:9px;color:#666;text-transform:uppercase;letter-spacing:1px;margin-top:2px">In Target</div></div>' +
      '<div style="background:'+C.failBg+';border:1px solid #ffb3b3;border-radius:10px;padding:12px;text-align:center"><div style="font-size:26px;font-weight:900;color:'+C.failRed+'">'+tFail+'</div><div style="font-size:9px;color:#666;text-transform:uppercase;letter-spacing:1px;margin-top:2px">Out of Target</div></div>' +
      '<div style="background:'+compBg+';border:1px solid '+(comp>=80?'#95d5b2':'#ffb3b3')+';border-radius:10px;padding:12px;text-align:center"><div style="font-size:26px;font-weight:900;color:'+compColor+'">'+comp+'%</div><div style="font-size:9px;color:#666;text-transform:uppercase;letter-spacing:1px;margin-top:2px">Compliance</div></div>' +
    '</div>';

  // ---- WEIGHT RECORDS (vertical cards) ----
  var weightCards = rptWeightResults.map(function(r) {
    var p = PKGS[r.pkg];
    var sampleRows = r.vals.map(function(v,i){
      if(v===undefined||v===null||v==='') return '';
      var num = parseFloat(v);
      var inRange = p && !isNaN(num) && num>=p.min && num<=p.max;
      var col = inRange ? C.passGreen : C.failRed;
      var bg  = inRange ? C.passBg   : C.failBg;
      return '<div style="display:flex;justify-content:space-between;align-items:center;padding:5px 10px;background:'+bg+';border-radius:6px;margin-bottom:4px">' +
        '<span style="font-size:10px;color:#555;font-weight:600">Sample '+(i+1)+'</span>' +
        '<span style="font-size:12px;font-weight:800;color:'+col+'">'+num.toFixed(3)+' lbs</span>' +
        '<span style="font-size:10px;font-weight:700;color:'+col+'">'+(inRange?'‚úì IN':'‚úó OUT')+'</span>' +
      '</div>';
    }).filter(Boolean).join('');

    var rc    = r.compliance>=80 ? C.passGreen : C.failRed;
    var rcBg  = r.compliance>=80 ? C.passBg   : C.failBg;

    return '<div style="background:white;border:1px solid '+C.border+';border-radius:12px;padding:14px;margin-bottom:12px;page-break-inside:avoid">' +
      '<div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px">' +
        '<div>' +
          '<div style="font-size:13px;font-weight:800;color:'+C.headerBg+'">'+r.pkgLabel+' ¬∑ Line '+r.line+'</div>' +
          '<div style="font-size:10px;color:#888;margin-top:2px">'+r.time+' ¬∑ '+(r.shift===1?'1st':'2nd')+' Shift'+(r.lot?' ¬∑ LOT: '+r.lot:'')+(r.product?' ¬∑ #'+r.product:'')+'</div>' +
          '<div style="font-size:9px;color:#aaa;margin-top:1px">Target: '+p.min+' ‚Äì '+p.max+' lbs ¬∑ Avg: '+parseFloat(r.avg).toFixed(3)+' lbs'+(r.initials?' ¬∑ '+r.initials:'')+'</div>' +
        '</div>' +
        '<div style="background:'+rcBg+';border:1px solid '+(r.compliance>=80?'#95d5b2':'#ffb3b3')+';border-radius:8px;padding:6px 12px;text-align:center">' +
          '<div style="font-size:18px;font-weight:900;color:'+rc+'">'+r.compliance+'%</div>' +
          '<div style="font-size:8px;color:#888">compliance</div>' +
        '</div>' +
      '</div>' +
      sampleRows +
      (r.comments ? '<div style="margin-top:8px;font-size:9px;color:#888;background:'+C.yellowPastel+';border-radius:6px;padding:5px 8px">üìù '+r.comments+'</div>' : '') +
    '</div>';
  }).join('');

  // ---- BAG SEAL RECORDS ----
  var sealCards = rptSealResults.length ? rptSealResults.map(function(r){
    var checks = [
      {label:'Visual',    val:r.checks['Visual']},
      {label:'Dunk Tank', val:r.checks['Dunk Tank']},
      {label:'Printing',  val:r.checks['Printing']}
    ];
    return '<div style="background:white;border:1px solid '+C.border+';border-radius:12px;padding:14px;margin-bottom:12px;page-break-inside:avoid">' +
      '<div style="margin-bottom:10px">' +
        '<div style="font-size:13px;font-weight:800;color:'+C.headerBg+'">Bag Seal ¬∑ Line '+r.line+'</div>' +
        '<div style="font-size:10px;color:#888;margin-top:2px">'+r.time+' ¬∑ '+(r.shift===1?'1st':'2nd')+' Shift'+(r.lot?' ¬∑ LOT: '+r.lot:'')+(r.product?' ¬∑ #'+r.product:'')+(r.initials?' ¬∑ '+r.initials:'')+'</div>' +
      '</div>' +
      '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">' +
        checks.map(function(c){
          var pass = c.val === 'pass';
          var fail = c.val === 'fail';
          var bg   = pass ? C.passBg : fail ? C.failBg : C.grayPastel;
          var col  = pass ? C.passGreen : fail ? C.failRed : '#888';
          var icon = pass ? '‚úì' : fail ? '‚úó' : '‚Äî';
          return '<div style="background:'+bg+';border-radius:8px;padding:10px;text-align:center">' +
            '<div style="font-size:16px;font-weight:900;color:'+col+'">'+icon+'</div>' +
            '<div style="font-size:10px;font-weight:700;color:'+col+'">'+((c.val||'‚Äî').toUpperCase())+'</div>' +
            '<div style="font-size:9px;color:#888;margin-top:2px">'+c.label+'</div>' +
          '</div>';
        }).join('') +
      '</div>' +
      (r.comments ? '<div style="margin-top:8px;font-size:9px;color:#888;background:'+C.yellowPastel+';border-radius:6px;padding:5px 8px">üìù '+r.comments+'</div>' : '') +
    '</div>';
  }).join('') : '<div style="background:'+C.grayPastel+';border-radius:10px;padding:14px;text-align:center;color:#aaa;font-size:10px;margin-bottom:12px">No bag seal records for this filter</div>';

  // ---- FULL HTML ----
  var h = '<!DOCTYPE html><html><head><meta charset="UTF-8">' +
  '<style>' +
    'body{font-family:-apple-system,Arial,sans-serif;font-size:10px;color:#111;padding:20px;margin:0;background:#fafafa}' +
    '@page{size:portrait;margin:12mm}' +
    '@media print{body{background:white}}' +
  '</style></head><body>' +

  // Header
  '<div style="display:flex;justify-content:space-between;align-items:center;background:'+C.headerBg+';color:white;border-radius:12px;padding:14px 18px;margin-bottom:16px">' +
    '<div style="display:flex;align-items:center;gap:14px">' +
      '<img src="data:image/png;base64,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" style="height:44px;object-fit:contain;border-radius:6px;background:white;padding:3px">' +
      '<div>' +
        '<div style="font-size:15px;font-weight:900;letter-spacing:0.02em">Quality Control Report</div>' +
        '<div style="font-size:9px;opacity:0.7;margin-top:2px">SQF # 2.4.D.1.1 ¬∑ Building 1945</div>' +
      '</div>' +
    '</div>' +
    '<div style="text-align:right;font-size:9px;opacity:0.8;line-height:1.8">' +
      '<div>'+dateStr+'</div>' +
      '<div>'+lineLabel+' ¬∑ '+shiftLabel+'</div>' +
      (productLabel !== '‚Äî' ? '<div>Product #'+productLabel+'</div>' : '') +
    '</div>' +
  '</div>' +

  // Meta info row
  '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px">' +
    '<div style="background:'+C.bluePastel+';border-radius:10px;padding:10px 14px">' +
      '<div style="font-size:8px;color:#666;text-transform:uppercase;letter-spacing:1px;font-weight:700">Line & Shift</div>' +
      '<div style="font-size:13px;font-weight:800;color:'+C.headerBg+';margin-top:3px">'+lineLabel+' ¬∑ '+shiftLabel+'</div>' +
    '</div>' +
    '<div style="background:'+C.redPastel+';border-radius:10px;padding:10px 14px">' +
      '<div style="font-size:8px;color:#666;text-transform:uppercase;letter-spacing:1px;font-weight:700">Date</div>' +
      '<div style="font-size:13px;font-weight:800;color:'+C.headerBg+';margin-top:3px">'+dateStr+'</div>' +
    '</div>' +
    '<div style="background:'+C.yellowPastel+';border-radius:10px;padding:10px 14px">' +
      '<div style="font-size:8px;color:#666;text-transform:uppercase;letter-spacing:1px;font-weight:700">Product #</div>' +
      '<div style="font-size:13px;font-weight:800;color:'+C.headerBg+';margin-top:3px">'+productLabel+'</div>' +
    '</div>' +
  '</div>' +

  // Summary cards
  summaryCards +

  // Weight section title
  '<div style="display:flex;align-items:center;gap:8px;margin-bottom:10px">' +
    '<div style="width:4px;height:20px;background:'+C.red+';border-radius:2px"></div>' +
    '<div style="font-size:13px;font-weight:800;color:'+C.headerBg+'">‚öñÔ∏è Weight Monitoring</div>' +
    '<div style="flex:1;height:1px;background:'+C.border+'"></div>' +
    '<div style="font-size:9px;color:#888">'+rptWeightResults.length+' records</div>' +
  '</div>' +
  (weightCards || '<div style="background:'+C.grayPastel+';border-radius:10px;padding:14px;text-align:center;color:#aaa;font-size:10px;margin-bottom:12px">No weight records for this filter</div>') +

  // Bag seal section title
  '<div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;margin-top:6px">' +
    '<div style="width:4px;height:20px;background:#0070C0;border-radius:2px"></div>' +
    '<div style="font-size:13px;font-weight:800;color:'+C.headerBg+'">üîç Bag Seal Monitoring</div>' +
    '<div style="flex:1;height:1px;background:'+C.border+'"></div>' +
    '<div style="font-size:9px;color:#888">'+rptSealResults.length+' records</div>' +
  '</div>' +
  sealCards +

  // Corrective actions
  '<div style="margin-top:10px">' +
    '<div style="font-size:11px;font-weight:800;color:'+C.headerBg+';margin-bottom:6px">üìã Corrective Actions / Notes</div>' +
    '<div style="border:1px solid '+C.border+';border-radius:10px;min-height:60px;padding:10px;background:white;font-size:9px;color:#aaa">Write corrective actions here...</div>' +
  '</div>' +

  // Footer
  '<div style="margin-top:16px;padding-top:10px;border-top:1px solid '+C.border+';display:flex;justify-content:space-between;font-size:8px;color:#aaa">' +
    '<span>Caputo Quality Control System ¬∑ Building 1945</span>' +
    '<span>SQF # 2.4.D.1.1 ¬∑ '+dateStr+'</span>' +
  '</div>' +

  '</body></html>';

  var blob = new Blob([h], {type:'text/html'});
  var url  = URL.createObjectURL(blob);
  var a    = document.createElement('a');
  a.href   = url;
  a.target = '_blank';
  a.click();
  setTimeout(function(){ URL.revokeObjectURL(url); }, 3000);
}

function exportRptGmpPDF() {
  if(!rptGmpResults.length){ toast('No GMP records to export'); return; }

  var dateStr = rptFilters.date ? new Date(rptFilters.date+'T12:00:00').toLocaleDateString('en-US',{year:'numeric',month:'2-digit',day:'2-digit'}) : new Date().toLocaleDateString('en-US',{year:'numeric',month:'2-digit',day:'2-digit'});
  var shiftLabel = rptFilters.shift === 'all' ? 'All Shifts' : (rptFilters.shift==='1'?'1st':'2nd')+' Shift';

  var sections = rptGmpResults.map(function(r) {
    var dt = r.date ? new Date(r.date+'T12:00:00').toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}) : '‚Äî';
    var checkRows = GMP_ITEMS.map(function(item,i){
      var val = r.answers[i];
      var yBox = val==='yes' ? '&#9745;' : '&#9744;';
      var nBox = val==='no'  ? '&#9745;' : '&#9744;';
      var bg   = val==='no' ? '#fff5f5' : val==='yes' ? '#f0fff4' : 'white';
      return '<tr style="background:'+bg+'"><td style="border:1px solid #ccc;padding:4px 8px;font-size:9px">'+item+'</td>'+
        '<td style="border:1px solid #ccc;padding:4px;text-align:center;font-size:13px;width:55px">'+yBox+' Yes</td>'+
        '<td style="border:1px solid #ccc;padding:4px;text-align:center;font-size:13px;width:55px">'+nBox+' No</td></tr>';
    }).join('');

    var tempSection = '';
    if(r.temp) {
      var t = r.temp;
      tempSection = '<div style="margin-top:10px;font-weight:900;font-size:10px;background:#1a5276;color:white;padding:4px 8px;letter-spacing:1px">1945 TEMPERATURE & % RELATIVE HUMIDITY (BEGINNING ¬∑ MIDDLE ¬∑ END)</div>' +
      '<table style="width:100%;border-collapse:collapse;margin-bottom:8px"><thead><tr>' +
        '<th style="border:1px solid #999;padding:4px;background:#333;color:white;font-size:9px;text-align:left;width:35%"></th>' +
        '<th style="border:1px solid #999;padding:4px;background:#333;color:white;font-size:9px">BEGINNING</th>' +
        '<th style="border:1px solid #999;padding:4px;background:#333;color:white;font-size:9px">MIDDLE</th>' +
        '<th style="border:1px solid #999;padding:4px;background:#333;color:white;font-size:9px">END</th>' +
      '</tr></thead><tbody>' +
        '<tr><td style="border:1px solid #ccc;padding:4px 8px;font-weight:700;font-size:9px">TIME</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.begin.time||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.mid.time||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.end.time||'')+'</td></tr>' +
        '<tr><td style="border:1px solid #ccc;padding:4px 8px;font-weight:700;font-size:9px">TEMPERATURE</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.begin.temp||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.mid.temp||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.end.temp||'')+'</td></tr>' +
        '<tr><td style="border:1px solid #ccc;padding:4px 8px;font-weight:700;font-size:9px">CHOPPING AREA HUM.</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.begin.chop||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.mid.chop||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.end.chop||'')+'</td></tr>' +
        '<tr><td style="border:1px solid #ccc;padding:4px 8px;font-weight:700;font-size:9px">UNDER PLATFORM HUM.</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.begin.plat||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.mid.plat||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.end.plat||'')+'</td></tr>' +
        '<tr><td style="border:1px solid #ccc;padding:4px 8px;font-weight:700;font-size:9px">LINE 6 & GRILLING HUM.</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.begin.line6||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.mid.line6||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.end.line6||'')+'</td></tr>' +
        '<tr><td style="border:1px solid #ccc;padding:4px 8px;font-weight:700;font-size:9px">INITIALS</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.begin.init||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.mid.init||'')+'</td><td style="border:1px solid #ccc;text-align:center;font-size:9px">'+(t.end.init||'')+'</td></tr>' +
      '</tbody></table>';
    }

    return '<div style="page-break-inside:avoid;margin-bottom:20px;border:1px solid #ddd;border-radius:6px;padding:12px">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">' +
        '<div><strong>GMP Audit</strong> ¬∑ '+(r.location||'‚Äî')+'</div>' +
        '<div style="font-size:9px;color:#555">'+dt+' ¬∑ '+(r.shift?(r.shift===1?'1st':'2nd')+' Shift':'‚Äî')+'</div>' +
      '</div>' +
      '<table style="width:100%;border-collapse:collapse;margin-bottom:8px"><thead><tr>' +
        '<th style="text-align:left;background:#222;color:white;padding:4px 8px;font-size:9px"><i>Check/Inspect</i></th>' +
        '<th style="background:#222;color:white;padding:4px;font-size:9px;width:120px" colspan="2"><i>Acceptable</i></th>' +
      '</tr></thead><tbody>'+checkRows+'</tbody></table>' +
      tempSection +
      (r.comments ? '<div style="border:1px solid #ccc;padding:6px;font-size:9px"><b>Comments:</b> '+r.comments+'</div>' : '') +
      '<div style="display:flex;gap:30px;margin-top:8px;font-size:9px">' +
        '<span><b>Completed By:</b> '+(r.completedBy||'_______________')+'</span>' +
        '<span><b>Verified By:</b> '+(r.verifiedBy||'_______________')+'</span>' +
      '</div>' +
    '</div>';
  }).join('');

  var h = '<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{font-family:Arial,sans-serif;font-size:10px;color:#111;padding:16px}</style></head><body>' +
  '<div style="display:flex;justify-content:space-between;align-items:flex-start;border-bottom:3px solid #c8102e;padding-bottom:10px;margin-bottom:12px">' +
    '<div><img src="data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCACeARgDASIAAhEBAxEB/8QAHQAAAgMBAQEBAQAAAAAAAAAAAAgFBgcEAQMCCf/EAFAQAAEDAwEEBQUJCwsEAwEAAAECAwQABREGBxIhMRNBUWFxCBQiMoEVIzM0QlJigpEWU3JzdHWhorGztBc2RFZjdpKTssHRJENkgzdGVeH/xAAcAQABBAMBAAAAAAAAAAAAAAAAAgMGBwEEBQj/xABCEQABAgQDBQUFBQYEBwAAAAABAAIDBAUREiExBkFRYYEHEyJxkRQyQqGxUnOSssEVU2JygtEjJTfCMzQ1Q2Oi4f/aAAwDAQACEQMRAD8AcuiiihCKKKKEIoornmzoUFrpZsuPFR855wIH2k0LBIaLldFFVd7aJoZlzcXqm173c+D+kV1W7WmkrisIhajtbyzySJKQT7Cc0JgTku42EQX8wp6ivEqSpIUkgg8iDwNe0LYRRRXLcLlbrc30lwnRoiOe886lA/SaFhzg0XJXVRVWd2i6GbXuK1Va89z4I+0V3W7V2l7id2DqG1vq4eimUjP2ZzRdMNm4DjYPBPmFN0V4khQBSQQeRFe0LYRRUHfNYaYscwQ7tfIMOQU73ROOAKA7SOquD+UjQn9abb/m0LWdOS7DhdEAPmFa6KrULX2jJstqJF1JbnX3lBDaA7xUT1CrIpQSkqUQAOJJ6qE5DjQ4ovDcD5G69oqqubRtCtuKbVqm2hSSQQHc8RX5/lJ0J/Wm2/5lCa9ulv3jfUK2UVD2DVOnb8t1FmvEOatkbziWnASkdpHZ31HPbRNDtPLac1RbQtCilQ6XOCOdCUZuAGhxeLHfcK00VVP5SNCf1ptv+bR/KRoT+tNt/wA2hJ9ulf3jfUK10VVBtH0KSANU23j/AGtWhh1p9lDzLiHGlpCkLSchQPIg9YoTkKYhRf8AhuB8jdfuiiojUOp7Bp9KTeLrGiKX6jalZcX4JGVH2ChLiRGQ24nmw5qXoqk/yl2MnebtuoXWet5FpeKP2Z/RUtYNaaZvcjzWBdWvO+uM8C08PqLANF0wyelnuwteL+asFFFFC2kUUUUIRRRRQhFQ+p9SWnTsZDtxkEOOndYjtJK3n1fNQgcVGobaFrRnT7aoUIx3bmWi6rpl7rMRoc3nldSR1Dmo8BSt612izZ06UmzzJClvgtybs4N2RJT81sf9hrsSniRzPVSXOAW7SqVO1mOYMmMm+88+63lzdyHUha1tC2wPxSuO5P8Acc8jBghEif8A+xZ97Z8PSUKxu7bQ5Ul9bsSzwg4o5Em4lU6QfrOegPYkVScUUyXkq06ZsDSZQB0wzvn8X5jo33R6dVaBtC1qPUv7zSfmNsNJSPABOBXqdfanWrM2XEuKSclE2Cy6D+rn7DVXQlS1htCVLWrklIyT4AVYI2idXSEJcRp2ehCvVU8gNA8M/LIpNyu1NUyiwodpiFDDebWgfMK7aJ2p+50hCQ49p5efhIqlvwlfjI6ySkd7asjsph9J7QrbcIDpvLsW3So8bzpaw8Fx32fvzK/lJ7uYPAjNJdeLTdLPJTHutvkwXVJ3kpebKd4doPIjwqd0fq/3DtciDKt7VyQ2rzm2pe4oiyeW+R8pBHEo5EpSaW15GqhNc2DgvhiZolmk/BfwOB3jXCRrlkdLLeNo+1xUZG6mVIs8N1O8w0y2FXGUnqXhXox0HqUrKiOIFYjdNoUx+Qp2BaLewsnPnExJmyT3lbuRnwSKrcZm66ivqWmy9Puc971lrypxZ4kknkOZJPAAVbk6QsjFivDnnE66TIUNx1UuMnchMuJxhAJGXOvid0HqBoLi5DKFs7QHwYdUcIseIQBiF7km3hZo1oO89SolO0LWic7moHmwTndbZaSkeACa9Rr3UaiPPV265J60zLey5nr5hIV+mqtWr6Y0RbNQaatLUbT8uTNctipsmTDlYf8Ah1tjDa/QXgJT6I3T30kXOike0H7BpEs2JOyzSxzg3KGDmQToBe2W5fjSm1b3OeRuifYVda4DxkRfrRnSeH4Kge6totm19pGnXrhcIzM1CUlMabbiVx33cei24k+kwsnqXw7DSx6r0tMsiPO23ROtpc6ISUNlBbc+9uoPFtfceB6ia4tN3yfYbgZcJSVIcT0ciO6N5mS31ocT1g/aOY40oPIyKjc5sRTanKe10GIGFwysbwzysfd6WtvC0Hape9XWe6hpPujb1OrU7Nn9CUJmyVAbwQoji2gYQkDhwJ66pX3aau/rDP8A8Y/4q4arYhvbKJF9tc5xy3zbpGQ3EddKnIbiUOlbas88ZGFdaSDWYVhxN129jJGC+lMZMSjYb2FzSDZxuDqSRnfXqr1orUuqLnfEQphut+t7qS3MjNNF1aW1cOkSEjIUg4UD2jHXW7XPV1wuGk29IvKkKuwdeh3F+Okla2GEhS1NgcS44gpATzBUc8qpXk/6YiXWJbbdMStUaUy/dJqUOKQXQF9CwkqSQcDDisZ5mt1f0LpR6xs2ZVmZENhwutJSpSVJWeat8Heyes5404wGyq/bCPDn6nEZJwmsbDuwkG2OxBIsBlbMB2Z1ySf6j1drKPepDa3p9iTve9W/c6IR2+SEBJHIADj18TUd92mrv6xT/wDGP+K0Hb7YG7YZUZreLdonobjlSipSY0hsrSgqPEhLiF4z841j9NOuCrb2YfIVamw5hsuxpzaW2BsWmxF7Z6ZLVtnl4vN2tsx6+TLnFixkLWL6llRSlnGH4ylgY9JOCnJ4KGOuqldNdahfuDzttuEi2wd7djRGVAIYaHBKRw54Ayes5NdF51e2/s5s2loDbrLjSCm4uE4S4EurW2hPd6W8e0gdlSezfZ+5egxKlw3ZrslCnYkBLvRJU0kkF95zmhrIwAPSUeWBWdcguW+TpNFdMVefgtYXnCG2xXANhhbb3n2uQBoASdVWvu11b/WGf/mD/ij7tdWj/wCxT/8AMH/FffaKiKm6wHYkCJBQ9bWXVMxkFLYUSsEgEk9Q4k1JbKG2VN6hcchQZbiIbCWkzGA6hJXIQgnB7ieI41jO9rrpxp6lw6L+2PZwWYA+2Ft7G3S/VRcXXWrY8lp/3clP9GsKLTxCkOAH1VDHEHkaZ3YZqmJLhtWdlRTCktGXaQo5KEZ99jk9rS8gfRKTWA7U9CuWF6VKjQvMlxFpTPhJUVobCzhD7KjxLKjwweKFcDzFfDZJfnos8WX3RbtynXhIt0x1WERZYGMqJ+QtOUq+qeqlNJBsVGK/IydepLarSWeOHc2AAJHxsI+0NRzHApjtqe0NqzNy4NvnNxPNcC4XFSN8Rioei02n/uPK6k8kjiaWm+bQbo9MeXYVO2tDhO/KUvpZz/0nHjxB7kboFcG0C/C8XXzSE6tdqhLWmOV+s+sn3yQvtWs8e4YHVVbSFKUEpSVKUcJSBkknkBWHPJOS6Wy2xcGXhNnKiwPjHOxzDBwA0vxdx0yXa5eLw4907l3uK3c531SnCrPjmpu2a7vrAbZujqb5CQc9BPJWpPeh34Rs9hB9hq0M7MGE2JxyUuel9l1MeRcUlHmkaSocGlIxvKSCQlTgIAJ5ECs0nRZEGa/CltKZkR3FNOtq5pUk4IrBuF25Seoe0jYstDDYgZkQW/MXGYyNiOCarZJtMYlRmGZc5+Va3XEsNyJJBfgun1WZBHrJPyHeR5HBrZaQLSN7VYbwJK2vOITyCxOjZ4PsK9ZPiPWB6iAacjZNfFXCyrtcmWJcm3BARIz8ZjLTvMve1PA96TTzHXVVbR0B1BnGw2EmDEvgJzII1YTvyzadbXG5XWiiilrjIqva81GNPWhK2GkyLjLX0EGOTgOOEcyepKRlSj1AVYScDJpXtvWs1ynJUiK+d6d0kC34PwcRCsPujsLqxuA/NSrtrDjYJcvKRp+ZhyUA2fENr/ZAzc7oPnZZ/tK1Yu7zH7ZDmLkxOn6WZM5KuMj74f7NPJCeoceZql0UVrEkr0JS6ZL0uVZKyzbNb6niTxJ1JRyGTV20boGZdlxnriiW2iUN6JBjICpctPzgDwbb/tF8OwGpLZPoh+6y4U12EiVJlKKrbEeHvRSk4VJe/skngE/LVw5A0ztuh6b2fWdyddLg2mTIOZU+SffpTnYAOPghPACltZfMqvtrdtny8R8lT3AOb78Q6N5NvkXcScm8zkqNZtmzWmtPybtcn2rHEix1POxbV8OpKRnDkpWVqJ+jujsrI7pqRrSupocREdDr6nGn7vIfQJDqELIWYze/nASggKVzUSeIArYtpe0WNN0/NtJiM2qHOYU151dn+gWpKh6yGEhTiu7IFLntFkWq46qXOs08zkymmi+QytsB8JCVBIVxKSRkeOKU82GSiux1GhVeqmZnYbojAw2e8OILieLsjYaWyG5TmrZVtiaRn2pN+g3ZL8xt22sxllzoACSpw5A6PKSE7vMnq4VUbLYrjd4F1mwmi41a4wkyMD5JUBw7+Z8Emu+JofVDx3n7W5bmM4XIuBEdpHiV4J8ACe6tz2YbM337CPMZki3xWiX2Jqmt1c6VjAcLah8XSklKUnioKUTzpIBcVKXVGnbFU1tPp7++iYrhuIEgE3NyMmi2Q5rANI3lNivbdwXGEtktOMPs726VtuIKFBKvkqweBqRv2rXHoLNpsKZlttSGXG3WnHwtckuEFZcwAk+qkAY4Yq6662VrhXBbj0d6wLWolXRxnJMBf0m1oBW2D8xQ4dRqHiaDtEaBcnZ90lzJDVtkyYgZhOMMFTac5K3AFKxkcAPE1jC4ZLbbtHsrOzkKfiOHtFgwAg4hiOltNTrpwKzumd8mv4xZ/wC7av4xylhHKme8mv4xZ/7tq/jHKzD1R2mf8hL/AHrfyuV22taTjzbXLvkOGh6U2wROjY9CfHHFTah88DihXMEClB1baE2S/vwWnC9FIS9EdPNxhYCm1Hv3SAe8Gn3ubrTFtlPvqSlptlalk8gkAk0j+00oEuxs5Bdbs7PSDGCneUtaAfqKTSogyUc2AmokCrvlWe5EYXEbg5pAv1BseNgqwiVITCchJdV5s46l1TfUVpBAV44URXxooplXQABoms8nNlLb7IzvFOm4O6SOQWt1RH21tNYf5N0jefhgqKi/pyPxIx8E+62QO4cK3Ctlui81xgRNzIOvexPzlLn5TiAiZfgUpV0sG3uA44pKX1p/3NLtTCeUu6jzzUhxlQatscEnkStxzh3YTS90zE1Vq9mw/wApiH/yv+o/Va1s90Ha9Q2SztMWA3K5TYj8p5bl0XGQEofLYAASe6mG2faWe09Z58ie3GRPlpALcclSI7LaN1plJPEhIHPrJJrPvJqilD1vKgT0Gn0q4/JL0lxfDxCRzrcZnxR78Wr9lOsAsqyrM3MT1QjujRXOayI8MBOTbEjIeoSK7RPj1p/NDH+pypXZL8DqH8nifxbVRe0T49afzQx/qcqU2S/A6h/J4n8W1TXxKfTP+n4+4b9Amm2m6Nc1Oyy/BVETLbbcjuolJUWpEdwem2vd4jiAoEcQRS4bR9K2bTFqvUaRa7emfGdjxo70SQ+pPSrBWoEOKIO62OPDmoU4Z5UmW2u6LnOxDnPn02bcVd4LnQt/Ylr9NOxLAXUP2WbMGtwIMCK5rXEueASAQ1u8czhHks3qzbM2UnVSLg42HG7XHdnlJGQpTY97HtcKKrNaPsTgCW7NSRkzJsCAO9Kni4sfY0KYbqrc2vnXyNEmYzDZ2EgebvCPmU0Nh0rHTsxa01LTvGTCKZKlDip1wZWo9+8SfZSj7VIriLxCuLqSHpsUJkkjnIZUWXD7dxJ+tTy0pXlCW5MeRPwnBiX93d4ckSGUuj9ZKqeiDJVNsZFEhXJdjfde10P0GIflPqsfrePJz1Gpl209I5xjyTaJGetl7LjBP4LiVp8FVg9XLZVMcYn3WM2TvuQDJaxz6WOtLySPYlY9tNMNirM28kvaqJGeB4odnj+nM+ouOqeOivhbpKJtvjzGyCh9pLqSOsKAP+9FbKpgEEXCgNp9zfteipzkQ4mSAmJF/GuqCEn2b2fZSZbRpzU3V0tuKrMKCEwIv4tobufrKClfWpqduM8xk2RvPoNOSbgsdvm7ClJ/WKaTQKUoBSySo8ST1mmYh3Kd9nEoIs7MzbvgDWDr4nf7UVNaMs7d7v7UWS4WoLKFSZrg5oYbG8vHeeCR3qFQta9sC0+i4rituoB91biEOcP6LFAdWPBTimwfCm2i5U62rqzqTSosxD9/Jrf5nGw9Cb9FsVnblaO0c1eUW+P90F+kMRmGVnDUVChhlrhxCG0DiBzOawXW+0mfJur67TJfemZUhd3koHTd4YRxSwjsx6R6yKaPada7jcLNBetcUSpFvuDM3zcKCS6lGcpSTwzg8M9lLHrfQcKy2S5rctlzt9wiMNTUrlykLLzbjwbKVNoGEcTkcSeFPPBtkqd2RFKhVIQqk0vcS0Q7glpc6+Jzt172zOl8gs3PnM2YCtbsmU+sDeWoqWtROBxPEnNfh1CkLU04lSFoUUqSeBBHAjxrs09x1DbB/wCaz+8TVy20W5hzUEzUlvZS0xJnvRpraOTMpCjx7g4kBQ797spm2V1d8xVoMtPwZF+RiBxb5ttcehv0V72NX20XW52+8X6JFmyElFunuSUhZZd5R5AzyCwNxR+ckHrpmgMDlSDaKvbdjvYdlpW5bpKDGntJ5rZVjJH0kkBSe9Ipytl1+cu1kVAmyEP3G2lLTzqTwkNkZafHctGD45p6G64VM7UUNtFqjjDbaFGu5vJ3xN/3DkTwVvrH/KD+MN/3fun+hutgrGfKMcUiXECTgLslzSrw6NJ/2pZ0XBvaNA+8h/nalQHIVo+gtpCbDHgMr8/t8mFHMZqbC3HQtouFzddZc4KwpR4pUDWcDkKu7WiYErTlonM33zWdNiKkuNSo6iwkBxaBhxAO76vyhjjzrXbfcrz2qbR3yjWVd2GGXCxuRZ1jY3GmV89Fe9VbYWrlZ1RJt7du7CxlUGLbjDD3Yl1xSiQjtCBk8sisZvVxl3i7SbpOWFyZK99ZSMJHUAB1ADAA6gKnPuGvBwW5+n3Ekkb6bsyBw6+JB/RVg0ds2VcJrYec923AQfMbUoqQfxsggIbT27u8eysnE5R6mzeymzcN8aBMBznb8fePNtAALnoB5rk0HpqJL0tdplwBEy5RHmLI3u5K1tDpHHPD0NwHrJPZVCByAR18ab+Zs7dgaMfnpQw/qKN0UmOGU7rTCWTlMZodSMbye1ROTSu65tbVq1E8mICbfLSJcFXay5xA8UnKD3pNDm2CVsftTGqtQmYUyMOKz2DeG+6QeYyJt9pbJ5NdySh7TylLwN+ba3PE7r7Y9vp/ZTKdVJJsfvSoN2ctiXktPSHGpNvUs4SJjRJQkk8gtJWjPaoUzlw2mWp2zON2pEhy/rbKUW1bKkusuYwekyMJSk8SonGBTjDkoDtZAFKrEx3uTYhxt53AuBxIcDlrmFhXlB3RMp6epKgrz6+rCCOtuK0Ggf8AGtX2GsgbbcecQy0kqccUEIA61E4A+2rJtGurFwvTUSHJEmHbmfNm3xyfc3ip10dynFKI7gK6NlttXJ1Abt0PSt2oJebbI+GkqO6w0O0leD4JNNnNys6gNGzuzTY01kWtc9w5uJdbzzt5pn9iNsTFZu8lAHRIeatrB7URmw2SPFe/WhzPij34tX7KitD2Uaf0rAtJVvustZeX891XpLV7VE1KzPij34tX7KfCpWAH9zeJ7xuT5k3PzKRbaJ8etH5oY/1OVKbJPgdQ/k8T+LaqL2ifHrR+aGP9TlSmyX4HUP5PE/i2qY+JWhM/6fj7hv0Cc2/SDEsc+UObMZxz7Ek0kG0twm722PvhXQWeKk4OcFSC4f0rpytpjqWdnmoHFZwLc8OHegik02qdInXc1p0JCmWo7Xo8sJjtilxNFw9gmB9dc4/DCPzc3+yq9bT5OcUOSbNyPS39azjicMxSRkdmXOdYtW9+TOjem6cTubpTJuT29j1x0bSMfppEMZqYdoz7UQt+0+GP/cH9EzVLZ5TEYCXqPA+TbZXPHHLjR4dfMUydYD5TTREm7no+k6WxMqHD1NyWnJ/Wp52iq2nP7uqSb+EVvzuP1S0VZtlqwNoNoaOSmQ6qMoAZyHEKQR+tVaqY0M4hrW1iccUUoTcY5URzx0ic1rt1XoGowhGk4sM6Oa4eoKdTZNJVL2b2F1ZysQ0Nq8Ueif2UVybFVE7PIaD6rb8htA7Eh9YAorZGi81SDi6Vhk/ZH0VP8of03ktq4pTp+5rSOxW62M/YTSmjlTg7fIKpSrR6AUJDE+F9ZyOop/Sik9QcoSe0UzF1Vp9mbh3U4zf3gPqxv9ivaZvyaYbYetJGFeb2JbxI6lvyVE+3dQKWSmo8nBxKno3o7hXpuHujtCXXUk/bRD1T/aW4+xSzdxii/RriPmttrAfKT+H1F+YYv8amt+rAfKT+H1F+Yov8amnXaKt5D/qUp96z6pd9O/zitf5ax+8TW93bTEWZpS6XR5O7CmXaZCuawM9F7+roJP8A61nB+io1gmnf5xWv8tZ/eJphLlq53TumLvY7i3HtcOVcJpckTEdI7IbW6r0WGBgr4fLVhI7aaZa2amHaUyO6oSJlmkxQHluEXOIFhH/2+Vr3S6XODKtlxk26c2WpMZ1TTqexQOPs6x3Gte2F61ct5ZceWpTtobLb6eZftylcfFTKzvD6Kj2Vn2sJy9SvqvNus0xq3wI7UR6U574pe76KFvLA3QsjAwOoDnzqJ0/dpNjvUW6xAlTsde8UK9VxJ4KQr6Kkkg+NJBwlTWr0p+0FH7mM0MjWDhmDgiAX1HoeRX9A2XEPModaWlba0hSVJOQoHiCKyLykEJ6GC5uje9zbknPXjoRwqW2IajjS7amxtPqcjpYEq1OLPpLiqOOjP0mlZQfAVFeUj8Ug/m65fuBT+oVGwnOdFhB4s4RIYI4ERGgjoUpI5Cme8m9IU9aEqAIOmjkEZz/1jlLCOQpkPJ9vNrtzVlm3CfHhxzZHogdecCU9K3KUtSMngDuqScdhpmHqrW7TMqdAcdBFbf8AC5bm5p+wurK3LJbFrPNSoqCT+iu6OwxHaDUdltlsckNpCQPYK/EGZFnxG5cKS1JjujebdaWFJUO0EV962FVbGMHiaBmil7247PGkJc3SiNbnnlPwJah73BfWfTZcPyWXDxCuSVdxNb/LkxojJelSGmGhzW6sJSPaap902g6ReQ9BYU9fipJS4xAiqkJIPUSBuY8TWCAQkmdMjGZMQogZEYbtP1BG8HQj9UlV4ts+0XBdvukR2JJRxKHBjI6lJPJQPURkGuyRqfUki2C1yL/c3YWN3oFSVFJHYesjuPCtg1g9aEuhiM1a7Tbd4kwL9NZkoQP7NpG8434Aiqwufs0jHeei2eQ7gDEK2ynE8+J98dSP0UwW23q1KXtpEqUNpjU6KXDeG3bfi0uw2VA09ZLjfZpiW1kL3BvPPLO60wjrW4vklI7/AGZpmthuhYzDMSf0a1WuC4XYrjqChU+SRgySk8QhI9FsHqyeZrH5us9MOMssNrv6YrToWIkWJGjR8jkrcBIUfws1PxttLiBujUGrGUJA3EqjRHc+JwnhSm4QuHtK7aWuOEP2FzIDTfDiYS4jQu8Wg1AG/MnJNXVK1zrhqx3BVpYt/njwYDsha5TcdtlKyUoBWs4KlEHA7qyS27cXcjOq0KPzbjYykHxUys/s6q4tTT0bQnbml6bbHUz2I7ebTJS64hTK1KB6F0oUQd48BkjFOYgdFEJiQnoURjJqDEhMLgHOwYsLd5yxBZZtGcjm+RokeSzJMKAzGecZWFt9IN5SglQ4KA3sZHDINSeydxCU6gQTgmJGc+qmW0VH2Cvjc9nl0YkFi3TIs10corgVEk+xt3G99UmoqwzJWldTA3S3yEp3Fx50N1JbWtlYwsceRxxB7QKZzDrlWuYEjVNmn0ylxxEtDwDMXuBlcbr23hOhtXIOzPURByDb3f8ATSebXP8A5Gu3iz+4bpgbNq13UOz65WF11u5MPWGS9b5zYUhx5DQ3FJdQfVcBxnBIPVS9bUMq1rKfLnSdOxGe3sYzvR26XEzCh/Z48/tuM17S1wh2IORBDxcHyuqzTDeTZ8NpT8G6/wCpml5refJoeSmbp0hRz53cWFb3qjLTSwB38KRD1Uu7SGk0dp4RIf5rJnKwzykPjF3/ALsq/i263OsD8phxfnF36M7vR2BpK/pBcxHAfZTztFVkoMU/KAfvYf5glmqS0v8AzotH5ex+8TUdUxoVCXNb2JtaN9BuMfeTjOR0ic1rBeipo2gvPI/ROJsPS4nQSC4chU2UUceSemX/AP2ivrsVBGzyGs+q4/IcSe1JfWQaK2hovMdNFpOF/KPov1tgiuOaNcuLDe+9apDVwQnHEhtWVj2oKhSZaytqbRqm429shTLb5UwoclNL9NsjxSpNP3IabfYcYeQFtuJKVpPJQIwRShbbdKPWxa/RUp+zERnSebsNZJju9+6SWj2YTSIguFM9iaiJCsd082bHGH+tty31BI6BZVTB+TXd0NvWIqUAP+qtLpPUSRIZ+3KwPCl8q5bKbx5jel2xyQmOi4KbMd9RwmPLbVvMLJ6gTlB7l00w2KsLbilxKhSHiCLvhkPA44dR1FwnjrAfKU+H1F+Yov8AGitf0xqaJd9MG8PDzVcdK0z2V+tGdQPfEK8MHxGKwjbTenb7ZL5flWuRBhSbbFjRVPLQS6fOUuAkJJ3SU8QDxxxp92ipmlxmxanJYM7xGHpfXl1WCwy+JjBi73nAdT0W6MnfyN3HfnFatprZxdr9f3Xr75zf70V5kxhIPRMK7JMjqI+9t5PVkVmenf5xWv8ALWf3iadLY8B9z1yx/wDtTv3yqaY26svb6szkjEgS0q7AYgddwHiAGHJpOl7623ZKm6l2eSLLo9U12Sqc3HbUibbIjYai+ZqGHEtNj5aRhYWcqJTSxamtD1ivci2urDqWyFMvDk80obyHB3KSQftr+gS0pUkpUkKSRggjgRSm7b9P25lq5iA+04iwykNsOpOR0LyifNietba8kDj6Kj2UqI3JRXYqrGl1QSz3EsmDbMknvNxzz8QyPOyhtiupJUK4s2plwCYzIMq1BSsBbhGHYxPUHUDh9NI7a1LbPqm0ajs6JUB5W7CtM1UxC0lK4y3EpaQ0sHksrOMdxpZM445xjjnOMVcEfd5rC1NplTJb9pZIJkzXQ1GBAwCpxWN8gcB6xpLX5WUr2i2PgxKk2p982FDxNdEB3lhBBB0BNgDfzVPHKrDo24atQ47bdL+cyC8pLjkdEdLyAoclkLBSkj53Crbb9DWG0REXC/zEyWzxDslaocM/gjHTv/USkd9fO8a+tUWCbdZLemYyk+il1rzaEO8R0Hec8XVE91YDbZldGZ2jFWaYFMlfaGnVzhhherh4v6QfNbDs41pGscbUEJqFLuLibo44y1DbSGEJKU7xLpw2hO8FddQ+rdtLiSto3yFb8HjHtDfnsjwLysNJPhvVgN+1HfL4lLdzuLrsdHwcZADbDY7EtpwkfZUVWTEO5R+k9mQhwwKhMF38LPCONr+8ellfr/tJfnSC7GtSH3eqVeHlTXfEJOGk+ASarV41TqO7t9FcL1MdZHJhK+jaHcEJwn9FQxIHE8Kk7LYL3esm02qXMQPWcbb97T4rOEj2mkXJU6kqFR6OwvgwWMtq42v1cc/UqMCUjkAKKuNv0DLecS3MvNtYcJ4sRt+a8O7dZBA9qquNp2NvSN0i0aqm5+UttmC2f8ZUrHsrIYSudN7d0GWJb7QHkbmAv/KCFjtFMPD2HSNzP3JQkndPxu+uqOer4NAHCu9Owx8R+jNh0qSR65mTN4e3ex+is92VyndpdLB8MKKf6LfUhLTQQDzApgbjsPkpbJOk0K4cVW29kK9iXkEH7aoeo9mTtuO6mbJtz5OEx7zG83CvwX0lTZ9pTWCwhbsp2hUSO4NiPMIn7bS0eubfmq3adZX+3x0xFyk3KCP6HcEdOzjuCuKfFJFXO1aisOpordrmNNoWPRbtlzfKmSf/ABpR9NlXYleU95rOL1arlZpvmV0huxH8bwSscFp+ckjgod4JFcRAIwRkUBxC3qlsvTKraZhjBF1bEhmzvO4ycORuCmb2OWVpV2cs0JmaiPa7ZLjSUzmwh1C5DoUlBAPpYAOVDAPDtrEdp7S03G0PrBy7aWW1En5TSlNKH6gqa2Za6mw7nBhzbj5vIY97t1yd49D2MPHmthXLjxQcEcM1+dqSFzbR585CXCfgXeTHfjKOSyHvfUjPZvJcwaUSC3JV1Q5OdoW1rIU+cTo4iWfoH3s7oRhsRzuMis6rYfJ4mdFLt5J+L6gbHPgA+wtHhzQKx6r1sjnGK7d0JPptNMXBHbmO+lSsfUUuksOanu3sAxqBMEass78Lg76BO3S4eU1ICpeoQSDuMW6MMniN5xxw4/wimMZcQ8yh1s7yFpCkntBGaVTyip4fkXUpPxm/BoYPNMeOEn9Zyn36KqKHD7+syTB9u/RrXH+yxirLsuSDtCsyzvBLL5fJBAIDaFLzx/BqtVbdl7DirpdJjYO9GtbyUEffHsMoHjlw/ZWu3VXdtFNCUpMzHPwscfkbfNN9siYVH2aWBCxhSoaXFeKsq/3oqfssRMCzw4KQAI7CGgPwUgf7UVtLz3LQ+6gsZwAHoF11SdqullXu3JuMKKiVPiNrbVGVwTNjrHvjCj380nqUAau1FCXFh94217HUEagjMEcwcwkJ1np5VinIXGU69a5W8qG+tOFcD6TS+x1B4KHt5GoAjIxTj7VtnrN1jy51tgCUmVhVwtyVBHnBHJ5o8kPp6jyUOBpW9W6VlWUKmx1rm2oudGJPRlK2V/e30c23B2Hgeomtd7LK3tk9r2VECTnSGzA9Hji3nxbqN2SvGz7XkqVDkW5cxti9yYqoijJXusXNooKUBauSH0jglZ4KHA8agtp1kukicm8Roj7kVmFGjy20pPSxHWmktqDzfNPFOQrGCDwNUEgEYPEVcNO7QLvbkss3BHuoyyncZcW6pqUwn5qHk+lu/RVvJ7qA64sUmNstGpdSdVaQ1pLgQ6G42BuQSWH4SSL2It5KosOradbeZXuuNrC0KHUoHIP21u+gNqE1TU+RanX4jsdHuhPtzzKHIz6i4hLhacyFtlRXvbuCAc8aqytV6Duaku3SAsulWVmVaGnFY/GMLbKvaM19lah2ex4cpq1OJty5TXQvORbM70i295Kikb75AyUjj3VluW9cnaox61JFjqdGEdoOAjDYOP8AEH5jS4ItyTeoUFNpXyyM0sO0/TEG56gd01Guz6xEluTI3mbKpW828SpxtSEHAcSscFKI9E8TwqD1Jtb8+bLXSX28pxjcmyUxY58WmOKh3FVUW76wv9yjKhmWmDBP9DgIEdn2pTxV4qJpTnghcWj7I7QPmoc020uWXsXWc6xFiMIy9XcFdvMNE6SUFSzGMxHVJKZ8rPaGUEMtH8NSiOyoe97SJbz+/aIYZcTwbmTlCTISPoAjo2vBCfbVCAAGAMUE44k03iO5WFL7HyhiCPPudMRBviG4HkweEenVdFxmTLjMXMuEt+XJX6zr7hWs+01z1M2TTF8vDBlRIRbhj1pklYZjp/8AYrAPgMmtE0XsmVclJcaizL8oHitO9DgDxdUOkc+okeNAaStmq7UUmj/4caIMW5jc3fhGnWwWVW+FMuMtMS3xJEyQr1WmGytR9gq5WTZxPkyksXKWG5BPGDb2/PJfgQg7jf1lDwpjtM7KIsWIGLrMSmOeKrfa0eaxj+GR7479ZVaBZ7TbbPETEtcCNCYTyQy2Ej24504IfFV7Udv6lNXbJQxBbxd4neg8I6lywvR+xeQ2W3k2iBbMY9/uihOk+IbGGkHuO9WkwNmVgASq8uzL44nkJjvvKfwWk4QB7KvFFOBoChc0Ik6/HORHRT/EbjoPdHQLlt1ugW5kMwIUaI2BgIZaCB+iuqiispTWhosAiiiihZRVU1pquy24uWh2Eq8TVNdIuC0lKglHznVK9BtPeo116+vrlg08uREbDtwkOJjQWjyW8s4TnuHM9wNJ5tF1S9cpb9mgzVu21p9SpD44KuMjPpvuHrGchCeSUgdZpLnYVvUijzFbmzKwDha0Xe4i9gdABvcc7bgMyr7qNVsuLMxce32h2wMALm2uLdRIXFKlbodZVjDSskcEkpPLBFZPqqyqsdySwh/zqG+2H4ckJ3emaJwCR1KBBSodRBrU9iDmn4trskq8rbTa2p8p2epaSW0yUpR5v0mOrd3inPDOarO2ORGdatoaTul6XOmMpKd0pjOujozjmArdUoDsOeumnC4uu9sfHjUfaSLRYL3Og55OtcEAHEAAA1rr2todVnZGQQa1ayOHV+hjGe9Oe817mOqJyXJDSelhuE9qkhbWe4VlNXbZoX3LVqOMw50a0tRZDS843HEyEJSod/vhpLdVONu4WGkunWD/ABJciI3zaRcdRcFUniOBBSRwIPMHsqf2ez2LdrGA7LUEw31KiySeQadSW1E+G9n2VMbV9PyYN3evBi9AHny1cGUjhGmc1DuQv10HrBI6qpBAIIPI1jQrtSk1K1+mCIzNkVpBHC4sQeYzBTx7P76lOzlEq5uBL9nacjTiT6q2Mgn2gA+2lS2tz1yJ9shuZDzcdcySk80vSVl0g94QWxUxatpEQaedjXQ3EvuttonRWAks3MtgBtS1k7zZICQvAO8B1Gs8vFwk3W6yrnNWFyZTqnXCOWT1DsA5Adgpb3XCr7YvZWfkam6NOtsILS1puPET8Q5YRv3k8FyVsvk+WJUt637yMi5XNLywR/R4g3ifAurSPq1k1ktku83aNa4CN+TJWEIzyT2qJ6kgZJPUBTd7DNPMw4C7u0lQiBhEC2b6cFUdskqdx2uOFSvDFEMXN10u0apNZJspzD4opBPJjTc+ps3qVpwooop9VgiiiihCKqWstDW++uuXCI57nXRTZbVIQ2FofT8x5s+i4nx49hq20UJuLCZFFnD+4PEHceYSnbQNk6rc6t56MbGsng+ylb9tc78jLjHgoKT3is2u2k9Q2xrzh62uPxD6suIQ+wodu+jIHtxT8qSlSSlQBBGCDyNVS6bPNLzZaprEN22TFc5FueVHUfHd4H2g02YYOik9N2yrFOAY4iOwfayd+IA36i/NIrvJzjeGfGveVOHddkipSlFN+jygc8LlaI8hWD9MBKjUTD2KPtvBxcvTKSnikpsCFcfAqxSO7Kkje0yHbxyb78iwj1xD6JUQoFW6DknkBxNTVs0rqS5I6WHZJqmfvzjfRNjv314T+mmxtuyrzbdDmpZDKQPVt8CPE/WSkq7eupuJs20m26l6bCfuz6eTlxkLkH7FHdH2VkQlqTHaRNvFpaUDeb3/AKNB+qVWxbOX5sgMv3NMh7ODFtDCprngVjDafHeNa1o7Ys+2W3vcmHa8YJkXJQmyvFLYwyg+O8a3qJFjRGQzEjtR2k8kNICUj2CvtSwwBRafr9ZqOUxMFrfss8A6nNx/EFULNs90/CfbmT0P3mc36r9wX0u5+Aj1EDwFW5IAAAGAOQr2ilrjwoEOCLMFv18+KKKKKE6iiiihCKKKKEIooooQsb8oW6SIz6ehUQbdZpU1Hc4spYQr6u+o0pwGAB2U4G32yCZHjTVrDcWVGdtUp08melIU04r6IdSnPjSjT4kqBOfgzmFsSo7hbeaWMFChwIpiLqrH7NIsIMm4X/cxgn+UtAafK4I8197NeLtZn1v2m5SoLixurLLhSFjsUORHjXxnzJdwmOzZ8l2VJdOXHXVlSlHvJrnopu6ssQYYeYgaMR32z9UVpGxO2uTFywEkidOhW9PYffemX44S1n7Kzpltx55tlltbrrightCBlSlE4AA6yTTQ+T7pEw32VuJBas4WHVjil2e6AHcHrDaAlvPbvUtguVBu0SoMg0oyYPjjENA5XBcfID5kK6bUNDI1A07cIEaO9MUz0MqK8d1uc0OIQojilaTxQscUnupXNSbP7jFmPiyMyZqWielguJ3Z0buW38sdi0ZB7qeCofUemLFqFCBd7c1IW3xbdGUutn6K04UPYadcwOVa0msT1FiuiSZBa7NzHe6TxBGbTzFwd4SCutPMuFp5l1tYOClaCkj2GpazaWv92SXYtteRGT68qR7yw2O1Ti8AftpwHdmcMuYZ1NqVpk4BbMwL4A5wFKSVD7a7rds601GlIlzGpd3ktnKHLlIVI3T2hJ9EfZSO6UqjdpE+9mGFKNa7i59x6BoJ9Qsn2L7NI64ylhKnojwxNuRQpHnSOtiODxDR+Us4KuQwKYNhptllDLSEttoSEoSkYCQBgAV+kpSkBKQAAMADqr2nQLKERo0eZjOmZl+OI7U/QAbgNw/VFFFFZSUUUUUIRRRRQhFFFFCEUUUUIRRRRQhFFFFCEUUUUIRRRRQhFFFFCEUUUUIRRRRQhc9yhRbjAfgTWEPxn0Ft1tYyFJPMVgW07ZK6pO+tibcIrKN2PcYqQ5Mjtjk282SOnQOpQIUBw40wtFYIBWYUSNLxmzEs8siN0I4cCDkRyKRaToK79MUW2XbLoBn0WpSWnR+E07uqB7sGvijQmquCpNubgtEAl6XKaaQB25Kv2Zp3Ltp+x3Y5udogTD855hKj9pFcMHRGkYLwei6ctjbgOQrzcEjwzypvugpUzb2uMZhc2G48bOHyuR8wsC2T7MZLr6ZFvdWt5Xou3pTRQzHSeaYqVAKccI4dKQAnq7aZGx2uFZrVHtluYDMWOjcQgftJ6yTxJrsSkJSEpAAAwAOqvacDQFF5mYmJ2YM1NvxxDlfQAcGjcPmd5KKKKKykIooooQiiiihCKKKKEIooooQiiiihCKK8BySOyvaEIooooQiiiihCKKKKEIooooQiiiihCKKKKEIooooQiiiihCKKKKEIooooQiiiihCKKKKEIooooQiijNFCEUUUUIX/2Q==" style="height:48px;object-fit:contain"><br><span style="font-size:8px;color:#777">1931/1935/1945 N 15th Ave, Melrose Park, IL 60160</span></div>' +
    '<div style="text-align:right"><div style="font-size:20px;font-weight:900">GMP Facility Audit Report</div><div style="font-size:9px;color:#555">SQF # 2.5.D.A | Building 1945</div></div>' +
  '</div>' +
  '<div style="display:flex;gap:20px;margin-bottom:14px;font-size:10px;padding-bottom:8px;border-bottom:1px solid #eee">' +
    '<span><b>Date:</b> '+dateStr+'</span>' +
    '<span><b>Filter:</b> '+shiftLabel+'</span>' +
    '<span><b>Records:</b> '+rptGmpResults.length+'</span>' +
  '</div>' +
  sections +
  '<div style="margin-top:14px;border-top:1px solid #ddd;padding-top:8px;font-size:8px;color:#999;display:flex;justify-content:space-between">' +
    '<span>Caputo Quality Control System</span><span>SQF # 2.5.D.A | Building 1945 | '+dateStr+'</span>' +
  '</div>' +
  '</body></html>';

  var blob = new Blob([h], {type:'text/html'});
  var url  = URL.createObjectURL(blob);
  var a    = document.createElement('a');
  a.href   = url;
  a.target = '_blank';
  a.click();
  setTimeout(function(){ URL.revokeObjectURL(url); }, 3000);
}

// ===== DATE HELPERS =====
function localDateStr() {
  var now = new Date();
  var y = now.getFullYear();
  var m = String(now.getMonth()+1).padStart(2,'0');
  var d = String(now.getDate()).padStart(2,'0');
  return y+'-'+m+'-'+d;
}
function localISOStr() {
  // Returns ISO string but using LOCAL date (not UTC)
  var now = new Date();
  var y   = now.getFullYear();
  var mo  = String(now.getMonth()+1).padStart(2,'0');
  var d   = String(now.getDate()).padStart(2,'0');
  var h   = String(now.getHours()).padStart(2,'0');
  var mi  = String(now.getMinutes()).padStart(2,'0');
  var s   = String(now.getSeconds()).padStart(2,'0');
  return y+'-'+mo+'-'+d+'T'+h+':'+mi+':'+s;
}

// ===== SYNC UI =====
function showSyncStatus(msg) {
  var el = document.getElementById('sync-status');
  if(el){ el.textContent = msg; el.style.display = 'block'; }
}
function hideSyncStatus() {
  var el = document.getElementById('sync-status');
  if(el) el.style.display = 'none';
}



// ===== HOLD MANAGEMENT =====
var holdActiveFilter = 'all';
var holdClosedFilter = 'all';
var currentHoldCase  = null;
var newHoldStatus    = null;

function getHolds() {
  var db = getDB();
  if(!db.holds) db.holds = [];
  return db.holds;
}

function saveHoldsDB(holds) {
  var db = getDB();
  db.holds = holds;
  saveDB(db);
  if(window.saveHoldsToFirebase) window.saveHoldsToFirebase(holds);
}

function getNextHoldNumber() {
  var holds = getHolds();
  if(!holds.length) return 'HLD-001';
  var nums = holds.map(function(h){
    var n = parseInt((h.caseNumber||'HLD-000').split('-')[1]);
    return isNaN(n) ? 0 : n;
  });
  return 'HLD-' + String(Math.max.apply(null,nums)+1).padStart(3,'0');
}

var HSC = {
  hold:     {bg:'#ffe0e0',border:'#ffb3b3',text:'#c1121f',icon:'üîí'},
  review:   {bg:'#fff9e6',border:'#fde68a',text:'#b45309',icon:'üîç'},
  released: {bg:'#d8f3dc',border:'#95d5b2',text:'#2d6a4f',icon:'‚úÖ'},
  destroyed:{bg:'#f3f4f6',border:'#d1d5db',text:'#6b7280',icon:'üóëÔ∏è'}
};

function statusBadge(status) {
  var s = HSC[status] || HSC.hold;
  return '<span style="background:'+s.bg+';border:1px solid '+s.border+';color:'+s.text+';border-radius:20px;padding:3px 10px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.05em">'+s.icon+' '+status+'</span>';
}

function initHold() {
  holdActiveFilter = 'all';
  holdClosedFilter = 'all';
  switchHoldTab('active', document.getElementById('hold-tab-active'));
  if(currentUser) document.getElementById('hold-initby').value = currentUser.name;
}

function switchHoldTab(tab, btn) {
  document.querySelectorAll('[id^="hold-tab-"]').forEach(function(b){ b.classList.remove('selected'); });
  if(btn) btn.classList.add('selected');
  document.getElementById('hold-view-active').style.display  = tab==='active'  ? 'block' : 'none';
  document.getElementById('hold-view-closed').style.display  = tab==='closed'  ? 'block' : 'none';
  document.getElementById('hold-view-new').style.display     = tab==='new'     ? 'block' : 'none';
  document.getElementById('hold-view-all').style.display     = tab==='all'     ? 'block' : 'none';
  if(tab==='active')  renderHoldActive();
  if(tab==='closed')  renderHoldClosed();
  if(tab==='all')     renderHoldAll();
}

function selectHoldLine(btn) {
  // Toggle selection
  var isActive = btn.classList.contains('active');
  document.querySelectorAll('[data-group="hline"]').forEach(function(b){ b.classList.remove('active'); });
  if(!isActive) btn.classList.add('active');
}

function setHoldActiveFilter(btn) {
  holdActiveFilter = btn.getAttribute('data-val');
  document.querySelectorAll('[data-group="hactive"]').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
  renderHoldActive();
}

function setHoldClosedFilter(btn) {
  holdClosedFilter = btn.getAttribute('data-val');
  document.querySelectorAll('[data-group="hclosed"]').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
  renderHoldClosed();
}

function holdCard(h, showReleaseCert) {
  var s = HSC[h.status] || HSC.hold;
  var dt = h.createdAt ? new Date(h.createdAt).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}) : '‚Äî';
  var certBtn = (showReleaseCert && h.status==='released') ?
    '<button data-certid="'+h.id+'" style="background:#d8f3dc;border:1px solid #95d5b2;color:#2d6a4f;border-radius:8px;padding:5px 10px;font-family:Raleway,sans-serif;font-size:10px;font-weight:700;cursor:pointer;margin-top:6px">üìú Release Certificate</button>' : '';
  return '<div data-holdid="'+h.id+'" style="background:var(--surface);border:1px solid '+s.border+';border-left:4px solid '+s.text+';border-radius:12px;padding:14px 16px;margin-bottom:10px;cursor:pointer">' +
    '<div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px">' +
      '<div style="font-size:13px;font-weight:800">'+h.caseNumber+'</div>' +
      statusBadge(h.status) +
    '</div>' +
    '<div style="font-size:14px;font-weight:700;margin-bottom:3px">'+h.product+'</div>' +
    '<div style="font-size:11px;color:var(--muted)">LOT: '+(h.lot||'‚Äî')+' ¬∑ Qty: '+h.quantity+(h.line?' ¬∑ Line '+h.line:'')+'</div>' +
    '<div style="font-size:10px;color:var(--muted);margin-top:3px">'+dt+' ¬∑ '+h.initiatedBy+'</div>' +
    certBtn +
  '</div>';
}

function attachHoldEvents(containerId) {
  var el = document.getElementById(containerId);
  if(!el) return;
  el.onclick = function(e) {
    // Release cert button
    var certBtn = e.target.closest('[data-certid]');
    if(certBtn) { e.stopPropagation(); exportReleaseCert(certBtn.getAttribute('data-certid')); return; }
    // Card click
    var card = e.target.closest('[data-holdid]');
    if(card) openHoldModal(card.getAttribute('data-holdid'));
  };
}

function renderHoldActive() {
  var holds = getHolds().filter(function(h){
    var isActive = h.status==='hold' || h.status==='review';
    var matchFilter = holdActiveFilter==='all' || h.status===holdActiveFilter;
    return isActive && matchFilter;
  }).sort(function(a,b){ return (b.createdAt||'').localeCompare(a.createdAt||''); });

  var el = document.getElementById('hold-active-list');
  el.innerHTML = holds.length ? holds.map(function(h){return holdCard(h,false);}).join('') :
    '<div class="empty">No active cases üéâ</div>';
  attachHoldEvents('hold-active-list');
}

function renderHoldClosed() {
  var holds = getHolds().filter(function(h){
    var isClosed = h.status==='released' || h.status==='destroyed';
    var matchFilter = holdClosedFilter==='all' || h.status===holdClosedFilter;
    return isClosed && matchFilter;
  }).sort(function(a,b){ return (b.createdAt||'').localeCompare(a.createdAt||''); });

  var el = document.getElementById('hold-closed-list');
  el.innerHTML = holds.length ? holds.map(function(h){return holdCard(h,true);}).join('') :
    '<div class="empty">No closed cases yet</div>';
  attachHoldEvents('hold-closed-list');
}

function renderHoldAll() {
  var holds = getHolds().sort(function(a,b){ return (b.createdAt||'').localeCompare(a.createdAt||''); });
  var el = document.getElementById('hold-all-list');
  el.innerHTML = holds.length ? holds.map(function(h){return holdCard(h,true);}).join('') :
    '<div class="empty">No cases yet</div>';
  attachHoldEvents('hold-all-list');
}

function saveHoldCase() {
  var product = document.getElementById('hold-product').value.trim();
  var lot     = document.getElementById('hold-lot').value.trim();
  var qty     = document.getElementById('hold-qty').value.trim();
  var reason  = document.getElementById('hold-reason').value.trim();
  var initby  = document.getElementById('hold-initby').value.trim();
  var line    = '';
  var activeLineBtn = document.querySelector('[data-group="hline"].active');
  if(activeLineBtn) line = activeLineBtn.getAttribute('data-val');

  if(!product){ toast('Enter product name'); return; }
  if(!qty)    { toast('Enter quantity'); return; }
  if(!reason) { toast('Enter reason for hold'); return; }

  var now = localISOStr();
  var newCase = {
    id:          Date.now(),
    caseNumber:  getNextHoldNumber(),
    product:     product,
    lot:         lot,
    quantity:    qty,
    line:        line,
    reason:      reason,
    initiatedBy: initby || (currentUser ? currentUser.name : '‚Äî'),
    status:      'hold',
    createdAt:   now,
    history:     [{date:now, status:'hold', comment:'Product placed on hold. Reason: '+reason, by: initby||(currentUser?currentUser.name:'‚Äî')}]
  };

  var holds = getHolds();
  holds.push(newCase);
  saveHoldsDB(holds);
  if(window.saveToFirebase) window.saveToFirebase('holds', newCase);

  document.getElementById('hold-product').value = '';
  document.getElementById('hold-lot').value     = '';
  document.getElementById('hold-qty').value     = '';
  document.getElementById('hold-reason').value  = '';
  document.querySelectorAll('[data-group="hline"]').forEach(function(b){b.classList.remove('active');});

  toast(newCase.caseNumber + ' created! üîí');
  switchHoldTab('active', document.getElementById('hold-tab-active'));
}

function openHoldModal(id) {
  var holds = getHolds();
  currentHoldCase = holds.find(function(h){ return String(h.id)===String(id); });
  if(!currentHoldCase) return;
  newHoldStatus = currentHoldCase.status;
  document.getElementById('hold-modal').style.display = 'block';
  document.body.style.overflow = 'hidden';
  document.getElementById('modal-case-number').textContent = currentHoldCase.caseNumber + ' ‚Äî ' + currentHoldCase.product;
  document.getElementById('modal-comment').value = '';
  document.querySelectorAll('[data-newstatus]').forEach(function(b){
    b.classList.toggle('active', b.getAttribute('data-newstatus')===currentHoldCase.status);
  });
  renderModalDetail();
  renderModalHistory();
}

function renderModalDetail() {
  var h = currentHoldCase;
  var s = HSC[h.status] || HSC.hold;
  var dt = h.createdAt ? new Date(h.createdAt).toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'}) : '‚Äî';
  document.getElementById('modal-case-detail').innerHTML =
    '<div style="background:'+s.bg+';border:1px solid '+s.border+';border-radius:12px;padding:14px;margin-bottom:12px">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">'+
        '<div style="font-size:16px;font-weight:800">'+h.product+'</div>'+
        statusBadge(h.status)+
      '</div>'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;font-size:11px">' +
        '<div><span style="color:var(--muted);font-weight:700">LOT: </span>'+(h.lot||'‚Äî')+'</div>' +
        '<div><span style="color:var(--muted);font-weight:700">QTY: </span>'+h.quantity+'</div>' +
        '<div><span style="color:var(--muted);font-weight:700">LINE: </span>'+(h.line?'Line '+h.line:'‚Äî')+'</div>' +
        '<div><span style="color:var(--muted);font-weight:700">DATE: </span>'+dt+'</div>' +
        '<div style="grid-column:span 2"><span style="color:var(--muted);font-weight:700">BY: </span>'+h.initiatedBy+'</div>' +
        '<div style="grid-column:span 2"><span style="color:var(--muted);font-weight:700">REASON: </span>'+h.reason+'</div>' +
      '</div>' +
    '</div>';
}

function renderModalHistory() {
  var history = (currentHoldCase.history||[]).slice().reverse();
  document.getElementById('modal-history').innerHTML = history.map(function(e){
    var s = HSC[e.status] || HSC.hold;
    var dt = e.date ? new Date(e.date).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric',hour:'2-digit',minute:'2-digit'}) : '‚Äî';
    return '<div style="border-left:3px solid '+s.text+';padding:8px 12px;margin-bottom:8px;background:'+s.bg+';border-radius:0 8px 8px 0">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px">'+
        statusBadge(e.status)+'<span style="font-size:9px;color:var(--muted)">'+dt+'</span>'+
      '</div>'+
      '<div style="font-size:11px;margin-top:4px">'+e.comment+'</div>'+
      '<div style="font-size:10px;color:var(--muted);margin-top:2px">By: '+e.by+'</div>'+
    '</div>';
  }).join('');
}

function setNewStatus(btn) {
  newHoldStatus = btn.getAttribute('data-newstatus');
  document.querySelectorAll('[data-newstatus]').forEach(function(b){ b.classList.remove('active'); });
  btn.classList.add('active');
}

function updateHoldStatus() {
  var comment = document.getElementById('modal-comment').value.trim();
  if(!comment){ toast('Comment is required'); return; }
  if(!newHoldStatus){ toast('Select a status'); return; }

  var holds = getHolds();
  var idx = holds.findIndex(function(h){ return String(h.id)===String(currentHoldCase.id); });
  if(idx<0) return;

  var now = localISOStr();
  holds[idx].status = newHoldStatus;
  holds[idx].history.push({date:now, status:newHoldStatus, comment:comment, by:currentUser?currentUser.name:'‚Äî'});
  saveHoldsDB(holds);
  currentHoldCase = holds[idx];

  document.getElementById('modal-comment').value = '';
  renderModalDetail();
  renderModalHistory();

  // If released or destroyed ‚Üí auto move to closed tab after closing modal
  var wasClosed = (newHoldStatus==='released' || newHoldStatus==='destroyed');
  var savedCase = holds[idx]; // save reference BEFORE closing modal
  toast('Status ‚Üí ' + newHoldStatus.toUpperCase() + ' ‚úì');

  if(wasClosed) {
    setTimeout(function(){
      closeHoldModal();
      if(newHoldStatus==='released') {
        if(confirm(savedCase.caseNumber+' has been RELEASED.\nGenerate Release Certificate?')) {
          exportReleaseCert(savedCase.id);
        }
      }
      switchHoldTab('closed', document.getElementById('hold-tab-closed'));
    }, 500);
  }
}

function closeHoldModal() {
  document.getElementById('hold-modal').style.display = 'none';
  document.body.style.overflow = '';
  currentHoldCase = null;
}

// ===== RELEASE CERTIFICATE =====
function exportReleaseCert(id) {
  var holds = getHolds();
  var h = holds.find(function(x){ return String(x.id)===String(id); });
  if(!h){ toast('Case not found'); return; }
  if(h.status !== 'released'){ toast('Product not released yet'); return; }

  var certDate = new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
  var openDate = h.createdAt ? new Date(h.createdAt).toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : '‚Äî';

  // Find release entry
  var releaseEntry = (h.history||[]).slice().reverse().find(function(e){return e.status==='released';});
  var releaseDate  = releaseEntry ? new Date(releaseEntry.date).toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}) : certDate;
  var releaseBy    = releaseEntry ? releaseEntry.by : '‚Äî';
  var releaseComment = releaseEntry ? releaseEntry.comment : '‚Äî';

  // Build full history table
  var historyRows = (h.history||[]).map(function(e){
    var s = HSC[e.status] || HSC.hold;
    var dt = e.date ? new Date(e.date).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric',hour:'2-digit',minute:'2-digit'}) : '‚Äî';
    return '<tr style="background:'+s.bg+'">'+
      '<td style="border:1px solid #ddd;padding:6px 10px;font-size:9px;font-weight:700;color:'+s.text+'">'+s.icon+' '+e.status.toUpperCase()+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px 10px;font-size:9px">'+dt+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px 10px;font-size:9px">'+e.comment+'</td>'+
      '<td style="border:1px solid #ddd;padding:6px 10px;font-size:9px">'+e.by+'</td>'+
    '</tr>';
  }).join('');

  var doc = '<!DOCTYPE html><html><head><meta charset="UTF-8"><style>'+
    'body{font-family:Arial,sans-serif;font-size:10px;color:#111;padding:30px;margin:0;background:white}'+
    '@page{size:portrait;margin:15mm}'+
    'table{width:100%;border-collapse:collapse}'+
    'th{border:1px solid #ddd;padding:6px 10px;background:#2b2d42;color:white;font-size:9px;text-align:left}'+
  '</style></head><body>'+

  // Header with logo
  '<div style="display:flex;justify-content:space-between;align-items:center;border-bottom:3px solid #2d6a4f;padding-bottom:14px;margin-bottom:20px">'+
    '<div style="display:flex;align-items:center;gap:14px">'+
      '<img src="data:image/png;base64,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" style="height:50px;object-fit:contain">'+
      '<div>'+
        '<div style="font-size:9px;color:#888">1931/1935/1945 N 15th Ave, Melrose Park, IL 60160</div>'+
        '<div style="font-size:9px;color:#888">Building 1945</div>'+
      '</div>'+
    '</div>'+
    '<div style="text-align:right">'+
      '<div style="font-size:10px;color:#888">Certificate #: '+h.caseNumber+'-REL</div>'+
      '<div style="font-size:10px;color:#888">Date: '+certDate+'</div>'+
    '</div>'+
  '</div>'+

  // Certificate Title
  '<div style="text-align:center;margin-bottom:24px">'+
    '<div style="background:#d8f3dc;border:2px solid #2d6a4f;border-radius:12px;padding:16px;display:inline-block;min-width:300px">'+
      '<div style="font-size:22px;font-weight:900;color:#2d6a4f;letter-spacing:0.05em">‚úÖ PRODUCT RELEASE CERTIFICATE</div>'+
      '<div style="font-size:11px;color:#2d6a4f;margin-top:4px;font-weight:700">CAPUTO CHEESE ¬∑ QUALITY CONTROL DEPARTMENT</div>'+
    '</div>'+
  '</div>'+

  // Product details
  '<div style="background:#f8f9fa;border:1px solid #e0e0e0;border-radius:10px;padding:16px;margin-bottom:18px">'+
    '<div style="font-size:12px;font-weight:900;color:#2b2d42;margin-bottom:12px;text-transform:uppercase;letter-spacing:0.05em">Product Information</div>'+
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;font-size:10px">'+
      '<div style="background:white;border:1px solid #e0e0e0;border-radius:8px;padding:10px">'+
        '<div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700;margin-bottom:3px">Product</div>'+
        '<div style="font-size:14px;font-weight:800;color:#2b2d42">'+h.product+'</div>'+
      '</div>'+
      '<div style="background:white;border:1px solid #e0e0e0;border-radius:8px;padding:10px">'+
        '<div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700;margin-bottom:3px">Case Number</div>'+
        '<div style="font-size:14px;font-weight:800;color:#c8102e">'+h.caseNumber+'</div>'+
      '</div>'+
      '<div style="background:white;border:1px solid #e0e0e0;border-radius:8px;padding:10px">'+
        '<div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700;margin-bottom:3px">LOT Number</div>'+
        '<div style="font-size:13px;font-weight:700">'+( h.lot||'‚Äî')+'</div>'+
      '</div>'+
      '<div style="background:white;border:1px solid #e0e0e0;border-radius:8px;padding:10px">'+
        '<div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700;margin-bottom:3px">Quantity</div>'+
        '<div style="font-size:13px;font-weight:700">'+h.quantity+'</div>'+
      '</div>'+
      '<div style="background:white;border:1px solid #e0e0e0;border-radius:8px;padding:10px">'+
        '<div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700;margin-bottom:3px">Line</div>'+
        '<div style="font-size:13px;font-weight:700">'+(h.line?'Line '+h.line:'‚Äî')+'</div>'+
      '</div>'+
      '<div style="background:white;border:1px solid #e0e0e0;border-radius:8px;padding:10px">'+
        '<div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700;margin-bottom:3px">Hold Initiated By</div>'+
        '<div style="font-size:13px;font-weight:700">'+h.initiatedBy+'</div>'+
      '</div>'+
    '</div>'+
    '<div style="background:white;border:1px solid #ffe0e0;border-radius:8px;padding:10px;margin-top:10px">'+
      '<div style="font-size:8px;color:#888;text-transform:uppercase;font-weight:700;margin-bottom:3px">Original Reason for Hold</div>'+
      '<div style="font-size:11px;color:#c1121f;font-weight:600">'+h.reason+'</div>'+
    '</div>'+
  '</div>'+

  // Release info
  '<div style="background:#d8f3dc;border:1px solid #95d5b2;border-radius:10px;padding:16px;margin-bottom:18px">'+
    '<div style="font-size:12px;font-weight:900;color:#2d6a4f;margin-bottom:12px;text-transform:uppercase;letter-spacing:0.05em">‚úÖ Release Information</div>'+
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;font-size:10px">'+
      '<div><div style="font-size:8px;color:#2d6a4f;text-transform:uppercase;font-weight:700;margin-bottom:2px">Hold Date</div><div style="font-weight:700">'+openDate+'</div></div>'+
      '<div><div style="font-size:8px;color:#2d6a4f;text-transform:uppercase;font-weight:700;margin-bottom:2px">Release Date</div><div style="font-weight:700">'+releaseDate+'</div></div>'+
      '<div><div style="font-size:8px;color:#2d6a4f;text-transform:uppercase;font-weight:700;margin-bottom:2px">Released By</div><div style="font-weight:700">'+releaseBy+'</div></div>'+
      '<div><div style="font-size:8px;color:#2d6a4f;text-transform:uppercase;font-weight:700;margin-bottom:2px">Certificate Date</div><div style="font-weight:700">'+certDate+'</div></div>'+
    '</div>'+
    '<div style="margin-top:10px"><div style="font-size:8px;color:#2d6a4f;text-transform:uppercase;font-weight:700;margin-bottom:2px">Release Comments</div><div style="font-size:11px;font-weight:600">'+releaseComment+'</div></div>'+
  '</div>'+

  // Full history
  '<div style="margin-bottom:18px">'+
    '<div style="font-size:12px;font-weight:900;color:#2b2d42;margin-bottom:10px;text-transform:uppercase;letter-spacing:0.05em">Complete Case History</div>'+
    '<table><thead><tr>'+
      '<th>Status</th><th>Date & Time</th><th>Comment</th><th>By</th>'+
    '</tr></thead><tbody>'+historyRows+'</tbody></table>'+
  '</div>'+

  // Signature area
  '<div style="border:1px solid #e0e0e0;border-radius:10px;padding:16px;margin-bottom:18px">'+
    '<div style="font-size:11px;font-weight:900;color:#2b2d42;margin-bottom:16px">Authorization Signatures</div>'+
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">'+
      '<div style="border-top:1px solid #2b2d42;padding-top:6px">'+
        '<div style="font-size:9px;color:#888">Quality Control Supervisor</div>'+
        '<div style="height:30px"></div>'+
        '<div style="font-size:9px;color:#888">Name &amp; Date</div>'+
      '</div>'+
      '<div style="border-top:1px solid #2b2d42;padding-top:6px">'+
        '<div style="font-size:9px;color:#888">Production Manager</div>'+
        '<div style="height:30px"></div>'+
        '<div style="font-size:9px;color:#888">Name &amp; Date</div>'+
      '</div>'+
    '</div>'+
  '</div>'+

  // Footer
  '<div style="border-top:2px solid #2d6a4f;padding-top:10px;display:flex;justify-content:space-between;font-size:8px;color:#888">'+
    '<span>Caputo Quality Control System ¬∑ Building 1945 ¬∑ SQF Certified</span>'+
    '<span>'+h.caseNumber+'-REL ¬∑ Generated: '+certDate+'</span>'+
  '</div>'+

  '</body></html>';

  var blob = new Blob([doc], {type:'text/html'});
  var url  = URL.createObjectURL(blob);
  var a    = document.createElement('a');
  a.href   = url;
  a.target = '_blank';
  a.click();
  setTimeout(function(){ URL.revokeObjectURL(url); }, 3000);
}

// ===== HOLD EXPORTS (Excel & PDF list) =====
function exportHoldExcel() {
  var holds = getHolds();
  if(!holds.length){ toast('No hold cases to export'); return; }
  var wb = XLSX.utils.book_new();
  var headers = ['Case #','Product','LOT','Quantity','Line','Reason','Status','Initiated By','Created Date'];
  var rows = holds.map(function(h){
    return [h.caseNumber,h.product,h.lot||'',h.quantity,h.line?'Line '+h.line:'',h.reason,h.status.toUpperCase(),h.initiatedBy,
      h.createdAt?new Date(h.createdAt).toLocaleDateString('en-US'):''];
  });
  var ws1 = XLSX.utils.aoa_to_sheet([headers].concat(rows));
  ws1['!cols'] = [{wch:10},{wch:20},{wch:12},{wch:15},{wch:8},{wch:30},{wch:12},{wch:15},{wch:14}];
  XLSX.utils.book_append_sheet(wb, ws1, 'Hold Cases');

  var hHeaders = ['Case #','Product','Date','Status','Comment','By'];
  var hRows = [];
  holds.forEach(function(h){
    (h.history||[]).forEach(function(e){
      hRows.push([h.caseNumber,h.product,e.date?new Date(e.date).toLocaleDateString('en-US'):'',e.status.toUpperCase(),e.comment,e.by]);
    });
  });
  var ws2 = XLSX.utils.aoa_to_sheet([hHeaders].concat(hRows));
  ws2['!cols'] = [{wch:10},{wch:20},{wch:14},{wch:12},{wch:40},{wch:15}];
  XLSX.utils.book_append_sheet(wb, ws2, 'Status History');

  XLSX.writeFile(wb, 'Caputo_HoldLog_'+new Date().toISOString().split('T')[0]+'.xlsx');
  toast('Excel exported! ‚úì');
}

function exportHoldPDF() {
  var holds = getHolds();
  if(!holds.length){ toast('No hold cases to export'); return; }
  holds.sort(function(a,b){ return (b.createdAt||'').localeCompare(a.createdAt||''); });

  var dateStr = new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
  var counts = {hold:0,review:0,released:0,destroyed:0};
  holds.forEach(function(h){ if(counts[h.status]!==undefined) counts[h.status]++; });

  var cards = holds.map(function(h){
    var s = HSC[h.status]||HSC.hold;
    var dt = h.createdAt?new Date(h.createdAt).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}):'‚Äî';
    var lastEntry = (h.history||[]).slice(-1)[0]||{};
    return '<div style="border:1px solid '+s.border+';border-left:5px solid '+s.text+';border-radius:8px;padding:12px;margin-bottom:10px;page-break-inside:avoid">'+
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">'+
        '<div style="font-size:13px;font-weight:900;color:#2b2d42">'+h.caseNumber+' ‚Äî '+h.product+'</div>'+
        '<div style="background:'+s.bg+';color:'+s.text+';border:1px solid '+s.border+';border-radius:16px;padding:3px 10px;font-size:9px;font-weight:700">'+s.icon+' '+h.status.toUpperCase()+'</div>'+
      '</div>'+
      '<div style="font-size:9px;color:#666">LOT: '+(h.lot||'‚Äî')+' ¬∑ Qty: '+h.quantity+(h.line?' ¬∑ Line '+h.line:'')+' ¬∑ '+dt+' ¬∑ By: '+h.initiatedBy+'</div>'+
      '<div style="font-size:9px;color:#444;margin-top:4px;font-style:italic">'+h.reason+'</div>'+
      (lastEntry.status&&lastEntry.status!=='hold'?'<div style="font-size:9px;color:'+s.text+';margin-top:4px;font-weight:600">Latest: '+lastEntry.comment+' ('+lastEntry.by+')</div>':'')+
    '</div>';
  }).join('');

  var doc = '<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{font-family:Arial,sans-serif;font-size:10px;padding:20px;background:white}@page{size:portrait;margin:12mm}</style></head><body>'+
  '<div style="background:#2b2d42;color:white;border-radius:10px;padding:14px 18px;margin-bottom:14px;display:flex;justify-content:space-between;align-items:center">'+
    '<div style="display:flex;align-items:center;gap:12px">'+
      '<img src="data:image/png;base64,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" style="height:42px;object-fit:contain;background:white;border-radius:5px;padding:3px">'+
      '<div><div style="font-size:14px;font-weight:900">Products on Hold Report</div><div style="font-size:9px;opacity:0.7">Caputo Quality Control ¬∑ Building 1945</div></div>'+
    '</div>'+
    '<div style="font-size:9px;opacity:0.8">'+dateStr+'</div>'+
  '</div>'+
  '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:14px">'+
    '<div style="background:#ffe0e0;border-radius:8px;padding:10px;text-align:center"><div style="font-size:20px;font-weight:900;color:#c1121f">'+counts.hold+'</div><div style="font-size:8px;color:#888">ON HOLD</div></div>'+
    '<div style="background:#fff9e6;border-radius:8px;padding:10px;text-align:center"><div style="font-size:20px;font-weight:900;color:#b45309">'+counts.review+'</div><div style="font-size:8px;color:#888">UNDER REVIEW</div></div>'+
    '<div style="background:#d8f3dc;border-radius:8px;padding:10px;text-align:center"><div style="font-size:20px;font-weight:900;color:#2d6a4f">'+counts.released+'</div><div style="font-size:8px;color:#888">RELEASED</div></div>'+
    '<div style="background:#f3f4f6;border-radius:8px;padding:10px;text-align:center"><div style="font-size:20px;font-weight:900;color:#6b7280">'+counts.destroyed+'</div><div style="font-size:8px;color:#888">DESTROYED</div></div>'+
  '</div>'+
  cards+
  '<div style="margin-top:12px;border-top:1px solid #ddd;padding-top:8px;font-size:8px;color:#aaa;display:flex;justify-content:space-between">'+
    '<span>Caputo Quality Control System ¬∑ Building 1945</span><span>Generated: '+dateStr+'</span>'+
  '</div></body></html>';

  var blob=new Blob([doc],{type:'text/html'});
  var url=URL.createObjectURL(blob);
  var a=document.createElement('a');
  a.href=url; a.target='_blank'; a.click();
  setTimeout(function(){URL.revokeObjectURL(url);},3000);
}

// ===== EXCEL EXPORTS =====

function exportRptExcel() {
  if(!rptWeightResults.length && !rptSealResults.length){ toast('No records to export'); return; }

  var wb = XLSX.utils.book_new();

  // ---- SHEET 1: Weight Records ----
  var wHeaders = ['Date','Time','Line','Shift','Package','Product #','LOT',
                  'Sample 1','Sample 2','Sample 3','Sample 4','Sample 5',
                  'Average','Total Samples','In Target','Compliance %','Initials','Comments'];
  var wRows = rptWeightResults.map(function(r){
    var dt = r.date ? new Date(r.date).toLocaleDateString('en-US') : '';
    return [
      dt, r.time||'', 'Line '+r.line, (r.shift===1?'1st':'2nd')+' Shift',
      r.pkgLabel, r.product||'', r.lot||'',
      r.vals[0]||'', r.vals[1]||'', r.vals[2]||'', r.vals[3]||'', r.vals[4]||'',
      parseFloat(r.avg).toFixed(3), r.total, r.pass, r.compliance+'%',
      r.initials||'', r.comments||''
    ];
  });
  var wsW = XLSX.utils.aoa_to_sheet([wHeaders].concat(wRows));

  // Style header row width
  wsW['!cols'] = [
    {wch:12},{wch:8},{wch:8},{wch:10},{wch:10},{wch:12},{wch:12},
    {wch:10},{wch:10},{wch:10},{wch:10},{wch:10},
    {wch:10},{wch:12},{wch:10},{wch:12},{wch:10},{wch:20}
  ];
  XLSX.utils.book_append_sheet(wb, wsW, 'Weight Records');

  // ---- SHEET 2: Bag Seal Records ----
  var sHeaders = ['Date','Time','Line','Shift','Product #','LOT','Visual','Dunk Tank','Printing','Initials','Comments'];
  var sRows = rptSealResults.map(function(r){
    var dt = r.date ? new Date(r.date).toLocaleDateString('en-US') : '';
    return [
      dt, r.time||'', 'Line '+r.line, (r.shift===1?'1st':'2nd')+' Shift',
      r.product||'', r.lot||'',
      (r.checks['Visual']||'‚Äî').toUpperCase(),
      (r.checks['Dunk Tank']||'‚Äî').toUpperCase(),
      (r.checks['Printing']||'‚Äî').toUpperCase(),
      r.initials||'', r.comments||''
    ];
  });
  var wsS = XLSX.utils.aoa_to_sheet([sHeaders].concat(sRows));
  wsS['!cols'] = [{wch:12},{wch:8},{wch:8},{wch:10},{wch:12},{wch:12},{wch:10},{wch:10},{wch:10},{wch:10},{wch:20}];
  XLSX.utils.book_append_sheet(wb, wsS, 'Bag Seal Records');

  // ---- SHEET 3: Summary ----
  var tBags = rptWeightResults.reduce(function(a,r){return a+r.total},0);
  var tPass = rptWeightResults.reduce(function(a,r){return a+r.pass},0);
  var tFail = tBags - tPass;
  var comp  = tBags ? Math.round((tPass/tBags)*100) : 0;

  var summaryData = [
    ['CAPUTO QUALITY CONTROL - REPORT SUMMARY'],
    ['Generated:', new Date().toLocaleDateString('en-US')],
    ['Filter Date:', rptFilters.date || 'All'],
    ['Line:', rptFilters.line === 'all' ? 'All Lines' : 'Line '+rptFilters.line],
    ['Shift:', rptFilters.shift === 'all' ? 'All Shifts' : (rptFilters.shift==='1'?'1st':'2nd')+' Shift'],
    [],
    ['WEIGHT MONITORING'],
    ['Total Bags Checked:', tBags],
    ['Bags In Target:', tPass],
    ['Bags Out of Target:', tFail],
    ['Overall Compliance:', comp+'%'],
    [],
    ['BAG SEAL MONITORING'],
    ['Total Seal Checks:', rptSealResults.length],
    ['Visual Pass:', rptSealResults.filter(function(r){return r.checks['Visual']==='pass'}).length],
    ['Dunk Tank Pass:', rptSealResults.filter(function(r){return r.checks['Dunk Tank']==='pass'}).length],
    ['Printing Pass:', rptSealResults.filter(function(r){return r.checks['Printing']==='pass'}).length],
  ];
  var wsSummary = XLSX.utils.aoa_to_sheet(summaryData);
  wsSummary['!cols'] = [{wch:25},{wch:20}];
  XLSX.utils.book_append_sheet(wb, wsSummary, 'Summary');

  // Download
  var dateLabel = rptFilters.date || new Date().toISOString().split('T')[0];
  XLSX.writeFile(wb, 'Caputo_Weight_Seal_'+dateLabel+'.xlsx');
  toast('Excel exported! ‚úì');
}

function exportGmpExcel() {
  if(!rptGmpResults.length){ toast('No GMP records to export'); return; }

  var wb = XLSX.utils.book_new();

  // ---- SHEET 1: GMP Checklist ----
  var gmpHeaders = ['Date','Location','Shift','Completed By','Verified By'].concat(GMP_ITEMS).concat(['Comments']);
  var gmpRows = rptGmpResults.map(function(r){
    var dt = r.date ? new Date(r.date+'T12:00:00').toLocaleDateString('en-US') : '';
    var base = [dt, r.location||'', (r.shift?(r.shift===1?'1st':'2nd')+' Shift':''), r.completedBy||'', r.verifiedBy||''];
    var items = GMP_ITEMS.map(function(item,i){ return (r.answers[i]||'‚Äî').toUpperCase(); });
    return base.concat(items).concat([r.comments||'']);
  });
  var wsG = XLSX.utils.aoa_to_sheet([gmpHeaders].concat(gmpRows));
  wsG['!cols'] = [{wch:12},{wch:15},{wch:10},{wch:15},{wch:15}].concat(GMP_ITEMS.map(function(){return {wch:8}})).concat([{wch:20}]);
  XLSX.utils.book_append_sheet(wb, wsG, 'GMP Checklist');

  // ---- SHEET 2: Temperature & Humidity ----
  var tHeaders = ['Date','Location','Shift',
    'Begin Time','Begin Temp (¬∞F)','Begin Chop Hum','Begin Platform Hum','Begin Line6 Hum','Begin Initials',
    'Mid Time','Mid Temp (¬∞F)','Mid Chop Hum','Mid Platform Hum','Mid Line6 Hum','Mid Initials',
    'End Time','End Temp (¬∞F)','End Chop Hum','End Platform Hum','End Line6 Hum','End Initials'];
  var tRows = rptGmpResults.map(function(r){
    var dt = r.date ? new Date(r.date+'T12:00:00').toLocaleDateString('en-US') : '';
    var t = r.temp || {begin:{},mid:{},end:{}};
    return [
      dt, r.location||'', (r.shift?(r.shift===1?'1st':'2nd')+' Shift':''),
      t.begin.time||'', t.begin.temp||'', t.begin.chop||'', t.begin.plat||'', t.begin.line6||'', t.begin.init||'',
      t.mid.time||'',   t.mid.temp||'',   t.mid.chop||'',   t.mid.plat||'',   t.mid.line6||'',   t.mid.init||'',
      t.end.time||'',   t.end.temp||'',   t.end.chop||'',   t.end.plat||'',   t.end.line6||'',   t.end.init||''
    ];
  });
  var wsT = XLSX.utils.aoa_to_sheet([tHeaders].concat(tRows));
  wsT['!cols'] = tHeaders.map(function(){return {wch:14}});
  XLSX.utils.book_append_sheet(wb, wsT, 'Temperature & Humidity');

  var dateLabel = rptFilters.date || new Date().toISOString().split('T')[0];
  XLSX.writeFile(wb, 'Caputo_GMP_'+dateLabel+'.xlsx');
  toast('GMP Excel exported! ‚úì');
}

function exportDashExcel() {
  var db   = getDB();
  var w    = filterByDays(db.weights);
  var gmps = filterByDays(db.gmps);
  var seals = filterByDays(db.seals);
  var periodLabel = dashDays ? 'Last '+dashDays+' days' : 'All Time';

  var wb = XLSX.utils.book_new();

  // ---- SHEET 1: All Weight Records ----
  var wHeaders = ['Date','Time','Line','Shift','Package','Product #','LOT',
                  'Sample 1','Sample 2','Sample 3','Sample 4','Sample 5',
                  'Average','Total','In Target','Compliance %','Initials','Comments'];
  var wRows = w.map(function(r){
    var dt = r.date ? new Date(r.date).toLocaleDateString('en-US') : '';
    return [
      dt, r.time||'', 'Line '+r.line, (r.shift===1?'1st':'2nd')+' Shift',
      r.pkgLabel, r.product||'', r.lot||'',
      r.vals[0]||'', r.vals[1]||'', r.vals[2]||'', r.vals[3]||'', r.vals[4]||'',
      parseFloat(r.avg).toFixed(3), r.total, r.pass, r.compliance+'%',
      r.initials||'', r.comments||''
    ];
  });
  var wsW = XLSX.utils.aoa_to_sheet([wHeaders].concat(wRows));
  wsW['!cols'] = wHeaders.map(function(h,i){ return {wch: i<7?12:i<13?10:14}; });
  XLSX.utils.book_append_sheet(wb, wsW, 'Weight Records');

  // ---- SHEET 2: All Bag Seal Records ----
  var sHeaders = ['Date','Time','Line','Shift','Product #','LOT','Visual','Dunk Tank','Printing','Initials','Comments'];
  var sRows = seals.map(function(r){
    var dt = r.date ? new Date(r.date).toLocaleDateString('en-US') : '';
    return [
      dt, r.time||'', 'Line '+r.line, (r.shift===1?'1st':'2nd')+' Shift',
      r.product||'', r.lot||'',
      (r.checks['Visual']||'‚Äî').toUpperCase(),
      (r.checks['Dunk Tank']||'‚Äî').toUpperCase(),
      (r.checks['Printing']||'‚Äî').toUpperCase(),
      r.initials||'', r.comments||''
    ];
  });
  var wsS = XLSX.utils.aoa_to_sheet([sHeaders].concat(sRows));
  wsS['!cols'] = sHeaders.map(function(){return {wch:12}});
  XLSX.utils.book_append_sheet(wb, wsS, 'Bag Seal Records');

  // ---- SHEET 3: All GMP Records ----
  var gHeaders = ['Date','Location','Shift','GMP Compliance %','Items Failed','Completed By','Comments'];
  var gRows = gmps.map(function(r){
    var dt = r.date ? new Date(r.date+'T12:00:00').toLocaleDateString('en-US') : '';
    var failed = Object.values(r.answers).filter(function(v){return v==='no'}).length;
    var total  = Object.keys(r.answers).length;
    var gcomp  = total ? Math.round(((total-failed)/total)*100) : 0;
    return [dt, r.location||'', (r.shift?(r.shift===1?'1st':'2nd')+' Shift':''), gcomp+'%', failed, r.completedBy||'', r.comments||''];
  });
  var wsG = XLSX.utils.aoa_to_sheet([gHeaders].concat(gRows));
  wsG['!cols'] = [{wch:12},{wch:15},{wch:10},{wch:16},{wch:12},{wch:15},{wch:25}];
  XLSX.utils.book_append_sheet(wb, wsG, 'GMP Records');

  // ---- SHEET 4: Dashboard Summary ----
  var tBags = w.reduce(function(a,r){return a+r.total},0);
  var tPass = w.reduce(function(a,r){return a+r.pass},0);
  var tFail = tBags - tPass;
  var comp  = tBags ? Math.round((tPass/tBags)*100) : 0;

  // Line breakdown
  var lineData = {};
  w.forEach(function(r){
    var k='Line '+r.line;
    if(!lineData[k]) lineData[k]={pass:0,total:0};
    lineData[k].pass+=r.pass; lineData[k].total+=r.total;
  });

  // Package breakdown
  var pkgData = {};
  w.forEach(function(r){
    var k=r.pkgLabel;
    if(!pkgData[k]) pkgData[k]={fail:0,total:0};
    pkgData[k].fail+=(r.total-r.pass); pkgData[k].total+=r.total;
  });

  // GMP failures
  var itemFails={};
  gmps.forEach(function(r){
    Object.keys(r.answers).forEach(function(i){
      if(r.answers[i]==='no'){
        var label=GMP_ITEMS[parseInt(i)]||('Item '+i);
        itemFails[label]=(itemFails[label]||0)+1;
      }
    });
  });

  var summaryData = [
    ['CAPUTO QUALITY CONTROL - DASHBOARD SUMMARY'],
    ['Generated:', new Date().toLocaleDateString('en-US')],
    ['Period:', periodLabel],
    [],
    ['=== WEIGHT MONITORING ==='],
    ['Total Bags Checked', tBags],
    ['Bags In Target', tPass],
    ['Bags Out of Target', tFail],
    ['Overall Compliance', comp+'%'],
    ['Total Weight Records', w.length],
    [],
    ['=== COMPLIANCE BY LINE ==='],
    ['Line','In Target','Out of Target','Compliance %']
  ];

  Object.keys(lineData).sort().forEach(function(k){
    var d = lineData[k];
    var pct = d.total ? Math.round((d.pass/d.total)*100) : 0;
    summaryData.push([k, d.pass, d.total-d.pass, pct+'%']);
  });

  summaryData.push([]);
  summaryData.push(['=== FAILURES BY PACKAGE ===']);
  summaryData.push(['Package','Failures','Fail Rate %']);
  Object.keys(pkgData).sort(function(a,b){return pkgData[b].fail-pkgData[a].fail}).forEach(function(k){
    var d = pkgData[k];
    var pct = d.total ? Math.round((d.fail/d.total)*100) : 0;
    summaryData.push([k, d.fail, pct+'%']);
  });

  summaryData.push([]);
  summaryData.push(['=== GMP SUMMARY ===']);
  summaryData.push(['Total Audits', gmps.length]);
  summaryData.push(['Items Failed', Object.values(itemFails).reduce(function(a,b){return a+b},0)]);

  summaryData.push([]);
  summaryData.push(['=== TOP GMP FAILURES ===']);
  summaryData.push(['GMP Item','Times Failed']);
  Object.keys(itemFails).sort(function(a,b){return itemFails[b]-itemFails[a]}).slice(0,10).forEach(function(item){
    summaryData.push([item, itemFails[item]]);
  });

  var wsSummary = XLSX.utils.aoa_to_sheet(summaryData);
  wsSummary['!cols'] = [{wch:35},{wch:20},{wch:20},{wch:15}];
  XLSX.utils.book_append_sheet(wb, wsSummary, 'Dashboard Summary');

  var dateLabel = new Date().toISOString().split('T')[0];
  XLSX.writeFile(wb, 'Caputo_Dashboard_'+periodLabel.replace(' ','_')+'_'+dateLabel+'.xlsx');
  toast('Dashboard Excel exported! ‚úì');
}

// ===== INIT =====
updateDate();
setInterval(updateDate,60000);
// Set login logo
var loginLogo = document.getElementById('login-logo');
if(loginLogo) loginLogo.src = LOGO;
// Start with login
initLogin();
</script>
</body>
</html>
